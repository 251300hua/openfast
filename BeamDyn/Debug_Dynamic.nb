(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    389202,      11899]
NotebookOptionsPosition[    379679,      11595]
NotebookOutlinePosition[    380040,      11611]
CellTagsIndexPosition[    379997,      11608]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Input", "Section",
 CellChangeTimes->{{3.570986342635504*^9, 3.57098634324965*^9}, {
  3.57098890613442*^9, 3.570988908523507*^9}, {3.570989162590061*^9, 
  3.570989163892308*^9}}],

Cell[CellGroupData[{

Cell["Derivatives of Shape Function", "Subsection",
 CellChangeTimes->{{3.57098635123835*^9, 3.5709863561705513`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"hhp", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {
       RowBox[{"-", "1.5"}], 
       RowBox[{"-", "0.5"}], "0.5"},
      {"2", "0", 
       RowBox[{"-", "2"}]},
      {
       RowBox[{"-", "0.5"}], "0.5", "1.5"}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"hhp", "=", 
     RowBox[{"Transpose", "[", "hhp", "]"}]}], ";"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.571493616554989*^9, 3.571493628524674*^9}, {
  3.571494263773286*^9, 3.571494268131514*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Weight Function", "Subsection",
 CellChangeTimes->{{3.570986402128985*^9, 3.57098640509048*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"wj", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {
       RowBox[{"1.0", "/", "3"}]},
      {
       RowBox[{"4.0", "/", "3"}]},
      {
       RowBox[{"1.0", "/", "3"}]}
     }], "\[NoBreak]", ")"}]}], ";"}]], "Input"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Beam Length and Cross-Section Constants", "Subsection",
 CellChangeTimes->{{3.570986418459955*^9, 3.570986432868462*^9}, {
  3.587920349079309*^9, 3.587920352524014*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"L", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EA", "=", 
   SuperscriptBox["10", "4"]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GA", "=", 
   SuperscriptBox["10", "4"]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EI", "=", 
    SuperscriptBox["10", "2"]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"EA", "=", 
     RowBox[{"70", "*", 
      SuperscriptBox["10", "9"]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"GA", "=", 
     RowBox[{"5.", "*", "27", "*", 
      RowBox[{
       SuperscriptBox["10", "9"], "/", "6."}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"EI", "=", 
     RowBox[{"70", "*", 
      RowBox[{
       SuperscriptBox["10", "9"], "/", "12."}]}]}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Stif0", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "6"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Stif0", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1"}], "]"}], "]"}], "=", 
   RowBox[{"3.50000", "*", 
    SuperscriptBox["10", "8"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Stif0", "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "2"}], "]"}], "]"}], "=", 
   RowBox[{"1.09162", "*", 
    SuperscriptBox["10", "8"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Stif0", "[", 
    RowBox[{"[", 
     RowBox[{"3", ",", "3"}], "]"}], "]"}], "=", 
   RowBox[{"1.09162", "*", 
    SuperscriptBox["10", "8"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Stif0", "[", 
    RowBox[{"[", 
     RowBox[{"4", ",", "4"}], "]"}], "]"}], "=", 
   RowBox[{"7.57037", "*", 
    SuperscriptBox["10", "4"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Stif0", "[", 
    RowBox[{"[", 
     RowBox[{"5", ",", "5"}], "]"}], "]"}], "=", 
   RowBox[{"7.28000", "*", 
    SuperscriptBox["10", "4"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Stif0", "[", 
    RowBox[{"[", 
     RowBox[{"6", ",", "6"}], "]"}], "]"}], "=", 
   RowBox[{"2.91900", "*", 
    SuperscriptBox["10", "4"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"m00", "=", 
   RowBox[{"1.35", "*", 
    SuperscriptBox["10", "1"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mEta0", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"0"},
      {"0"},
      {"0"}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rho0", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {
       RowBox[{"1.40625", "*", 
        SuperscriptBox["10", 
         RowBox[{"-", "2"}]]}], "0", "0"},
      {"0", 
       RowBox[{"2.81250", "*", 
        SuperscriptBox["10", 
         RowBox[{"-", "3"}]]}], "0"},
      {"0", "0", 
       RowBox[{"1.12500", "*", 
        SuperscriptBox["10", 
         RowBox[{"-", "2"}]]}]}
     }], "\[NoBreak]", ")"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.5709864370809526`*^9, 3.57098645193762*^9}, {
  3.571507138962542*^9, 3.5715072174245567`*^9}, {3.571507937747056*^9, 
  3.571507945837635*^9}, {3.5879076593774157`*^9, 3.587907686843546*^9}, {
  3.587907717684083*^9, 3.587907767080021*^9}, {3.58790799999804*^9, 
  3.587908003587185*^9}, {3.590851546376672*^9, 3.590851795077474*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Jacobian and Initial Value", "Subsection",
 CellChangeTimes->{{3.570986460622705*^9, 3.570986464788774*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Jaco", "=", 
   RowBox[{"L", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uuNf", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "0.", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0.", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0.", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uuN0", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "0.", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0.5", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "1.0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uuNi", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "0.", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0.", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0.", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vvNi", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "0.", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0.", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0.", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"aaNi", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "0.", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0.", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0.", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xxNi", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "0.", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0.", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0.", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vvNf", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "0.", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0.", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0.", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"aaNf", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "0.", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0.", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0.", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xxNf", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "0.", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0.", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0.", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ai", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tolx", "=", 
   RowBox[{"1.0", "*", 
    SuperscriptBox["10", 
     RowBox[{"-", "6"}]]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.570986469653469*^9, 3.570986479558962*^9}, {
   3.570988876581189*^9, 3.570988885191596*^9}, {3.570989120946187*^9, 
   3.570989130501487*^9}, {3.5715086590649567`*^9, 3.571508668498845*^9}, {
   3.571509369149693*^9, 3.5715093694034777`*^9}, {3.571509513244142*^9, 
   3.5715095137698383`*^9}, {3.5877522752495823`*^9, 3.587752285494895*^9}, {
   3.587753464222562*^9, 3.58775349451834*^9}, {3.58775367132889*^9, 
   3.5877537152111673`*^9}, {3.5877551901830397`*^9, 3.58775519051884*^9}, {
   3.5878172840332403`*^9, 3.587817289914188*^9}, {3.588030719014078*^9, 
   3.5880307537309847`*^9}, 3.588172102111285*^9, {3.588212105452786*^9, 
   3.588212111475802*^9}, {3.59085180960458*^9, 3.5908519063167048`*^9}, {
   3.590857242311861*^9, 3.5908572713273783`*^9}, {3.5908575322837477`*^9, 
   3.590857537059573*^9}}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Utilities", "Section",
 CellChangeTimes->{{3.5879232869892473`*^9, 3.5879232917265263`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Tilde", "[", 
   RowBox[{"v1_", ",", "v2_", ",", "v3_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "m12", ",", "m13", ",", "m21", ",", "m23", ",", "m31", ",", "m32"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"m12", "=", 
      RowBox[{"-", "v3"}]}], ";", 
     RowBox[{"m13", "=", "v2"}], ";", "\[IndentingNewLine]", 
     RowBox[{"m21", "=", "v3"}], ";", 
     RowBox[{"m23", "=", 
      RowBox[{"-", "v1"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"m31", "=", 
      RowBox[{"-", "v2"}]}], ";", 
     RowBox[{"m32", "=", "v1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "m12", ",", "m13"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"m21", ",", "0", ",", "m23"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"m31", ",", "m32", ",", "0"}], "}"}]}], "}"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.587923294338416*^9, 3.5879233183406754`*^9}, {
  3.5879233588094683`*^9, 3.587923359735828*^9}, {3.5879234050257883`*^9, 
  3.587923523681759*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["CRV Functions", "Section",
 CellChangeTimes->{{3.587911192925805*^9, 3.5879111962747602`*^9}}],

Cell[CellGroupData[{

Cell["CRV Compose 0", "Subsection",
 CellChangeTimes->{{3.5879112046386213`*^9, 3.587911209044013*^9}, {
  3.587911293540803*^9, 3.587911293882042*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CrvCompose0", "[", 
    RowBox[{
    "cc1_", ",", "cc2_", ",", "cc3_", ",", "c01_", ",", "c02_", ",", "c03_"}],
     "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"pp0", ",", 
       RowBox[{"pp1", "=", "cc1"}], ",", 
       RowBox[{"pp2", "=", "cc2"}], ",", 
       RowBox[{"pp3", "=", "cc3"}], ",", "qq0", ",", 
       RowBox[{"qq1", "=", "c01"}], ",", 
       RowBox[{"qq2", "=", "c02"}], ",", 
       RowBox[{"qq3", "=", "c03"}], ",", "tr1", ",", "tr2", ",", "dd1", ",", 
       "dd2", ",", "c1", ",", "c2", ",", "c3"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"pp0", "=", 
       RowBox[{"2.0", "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"pp1", "*", "pp1"}], "+", 
           RowBox[{"pp2", "*", "pp2"}], "+", 
           RowBox[{"pp3", "*", "pp3"}]}], ")"}], "/", "8"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"qq0", "=", 
       RowBox[{"2.0", "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"qq1", "*", "qq1"}], "+", 
           RowBox[{"qq2", "*", "qq2"}], "+", 
           RowBox[{"qq3", "*", "qq3"}]}], ")"}], "/", "8"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"tr1", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"4", "-", "pp0"}], ")"}], "*", 
        RowBox[{"(", 
         RowBox[{"4", "-", "qq0"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"tr2", "=", 
       RowBox[{
        RowBox[{"pp0", "*", "qq0"}], "-", 
        RowBox[{"pp1", "*", "qq1"}], "-", 
        RowBox[{"pp2", "*", "qq2"}], "-", 
        RowBox[{"pp3", "*", "qq3"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dd1", "=", 
       RowBox[{"tr1", "+", "tr2"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dd2", "=", 
       RowBox[{"tr1", "-", "tr2"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"dd1", ">", "dd2"}], ",", 
        RowBox[{"tr1", "=", 
         RowBox[{"4", "/", "dd1"}]}], ",", 
        RowBox[{"tr1", "=", 
         RowBox[{
          RowBox[{"-", "4"}], "/", "dd2"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c1", "=", 
       RowBox[{"tr1", "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"pp1", "*", "qq0"}], "+", 
          RowBox[{"pp0", "*", "qq1"}], "-", 
          RowBox[{"pp3", "*", "qq2"}], "+", 
          RowBox[{"pp2", "*", "qq3"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c2", "=", 
       RowBox[{"tr1", "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"pp2", "*", "qq0"}], "+", 
          RowBox[{"pp3", "*", "qq1"}], "+", 
          RowBox[{"pp0", "*", "qq2"}], "-", 
          RowBox[{"pp1", "*", "qq3"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c3", "=", 
       RowBox[{"tr1", "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"pp3", "*", "qq0"}], "-", 
          RowBox[{"pp2", "*", "qq1"}], "+", 
          RowBox[{"pp1", "*", "qq2"}], "+", 
          RowBox[{"pp0", "*", "qq3"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "c1", "}"}], ",", 
        RowBox[{"{", "c2", "}"}], ",", 
        RowBox[{"{", "c3", "}"}]}], "}"}]}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5878336491025963`*^9, 3.5878337132574883`*^9}, {
  3.587833899199844*^9, 3.587833906220441*^9}, {3.587833959921761*^9, 
  3.5878342582250834`*^9}, {3.587834309519348*^9, 3.5878344212812643`*^9}, {
  3.587834535240509*^9, 3.5878345376311073`*^9}, {3.587834746708899*^9, 
  3.587834746922448*^9}, {3.587834784012772*^9, 3.587834785332562*^9}, {
  3.587834874136689*^9, 3.587834887833905*^9}, {3.587834961555396*^9, 
  3.5878351341766663`*^9}, {3.587835283895105*^9, 3.5878352973048143`*^9}, {
  3.5879114904148808`*^9, 3.587911500840436*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["CRV Compose 1", "Subsection",
 CellChangeTimes->{{3.5879112848383093`*^9, 3.587911288709599*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CrvCompose1", "[", 
    RowBox[{
    "cc1_", ",", "cc2_", ",", "cc3_", ",", "c01_", ",", "c02_", ",", "c03_"}],
     "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"pp0", ",", 
       RowBox[{"pp1", "=", 
        RowBox[{"-", "cc1"}]}], ",", 
       RowBox[{"pp2", "=", 
        RowBox[{"-", "cc2"}]}], ",", 
       RowBox[{"pp3", "=", 
        RowBox[{"-", "cc3"}]}], ",", "qq0", ",", 
       RowBox[{"qq1", "=", "c01"}], ",", 
       RowBox[{"qq2", "=", "c02"}], ",", 
       RowBox[{"qq3", "=", "c03"}], ",", "tr1", ",", "tr2", ",", "dd1", ",", 
       "dd2", ",", "c1", ",", "c2", ",", "c3"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"pp0", "=", 
       RowBox[{"2.0", "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"pp1", "*", "pp1"}], "+", 
           RowBox[{"pp2", "*", "pp2"}], "+", 
           RowBox[{"pp3", "*", "pp3"}]}], ")"}], "/", "8"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"qq0", "=", 
       RowBox[{"2.0", "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"qq1", "*", "qq1"}], "+", 
           RowBox[{"qq2", "*", "qq2"}], "+", 
           RowBox[{"qq3", "*", "qq3"}]}], ")"}], "/", "8"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"tr1", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"4", "-", "pp0"}], ")"}], "*", 
        RowBox[{"(", 
         RowBox[{"4", "-", "qq0"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"tr2", "=", 
       RowBox[{
        RowBox[{"pp0", "*", "qq0"}], "-", 
        RowBox[{"pp1", "*", "qq1"}], "-", 
        RowBox[{"pp2", "*", "qq2"}], "-", 
        RowBox[{"pp3", "*", "qq3"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dd1", "=", 
       RowBox[{"tr1", "+", "tr2"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dd2", "=", 
       RowBox[{"tr1", "-", "tr2"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"dd1", ">", "dd2"}], ",", 
        RowBox[{"tr1", "=", 
         RowBox[{"4", "/", "dd1"}]}], ",", 
        RowBox[{"tr1", "=", 
         RowBox[{
          RowBox[{"-", "4"}], "/", "dd2"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c1", "=", 
       RowBox[{"tr1", "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"pp1", "*", "qq0"}], "+", 
          RowBox[{"pp0", "*", "qq1"}], "-", 
          RowBox[{"pp3", "*", "qq2"}], "+", 
          RowBox[{"pp2", "*", "qq3"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c2", "=", 
       RowBox[{"tr1", "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"pp2", "*", "qq0"}], "+", 
          RowBox[{"pp3", "*", "qq1"}], "+", 
          RowBox[{"pp0", "*", "qq2"}], "-", 
          RowBox[{"pp1", "*", "qq3"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c3", "=", 
       RowBox[{"tr1", "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"pp3", "*", "qq0"}], "-", 
          RowBox[{"pp2", "*", "qq1"}], "+", 
          RowBox[{"pp1", "*", "qq2"}], "+", 
          RowBox[{"pp0", "*", "qq3"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "c1", "}"}], ",", 
        RowBox[{"{", "c2", "}"}], ",", 
        RowBox[{"{", "c3", "}"}]}], "}"}]}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.587904408656501*^9, 3.5879044087756844`*^9}, {
  3.587904439248905*^9, 3.587904445085195*^9}, {3.5879115103250313`*^9, 
  3.58791151858383*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["CRV Matrix R", "Subsection",
 CellChangeTimes->{{3.587911251577004*^9, 3.587911255229555*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CrvMatrixR", "[", 
    RowBox[{"cc1_", ",", "cc2_", ",", "cc3_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"c0", ",", 
       RowBox[{"c1", "=", 
        RowBox[{"cc1", "/", "4"}]}], ",", 
       RowBox[{"c2", "=", 
        RowBox[{"cc2", "/", "4"}]}], ",", 
       RowBox[{"c3", "=", 
        RowBox[{"cc3", "/", "4"}]}], ",", "tr0", ",", "R0", ",", "R1", ",", 
       "R2", ",", "R3", ",", "R4", ",", "R5", ",", "R6", ",", "R7", ",", 
       "R8"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"c0", "=", 
       RowBox[{"0.5", "*", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"c1", "*", "c1"}], "-", 
          RowBox[{"c2", "*", "c2"}], "-", 
          RowBox[{"c3", "*", "c3"}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"tr0", "=", 
       RowBox[{"1", "-", "c0"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"tr0", "=", 
       RowBox[{"2", "/", 
        RowBox[{"(", 
         RowBox[{"tr0", "*", "tr0"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"R0", "=", 
       RowBox[{
        RowBox[{"tr0", "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"c1", "*", "c1"}], "+", 
           RowBox[{"c0", "*", "c0"}]}], ")"}]}], "-", "1"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"R1", "=", 
       RowBox[{"tr0", "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"c1", "*", "c2"}], "+", 
          RowBox[{"c0", "*", "c3"}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"R2", "=", 
       RowBox[{"tr0", "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"c1", "*", "c3"}], "-", 
          RowBox[{"c0", "*", "c2"}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"R3", "=", 
       RowBox[{"tr0", "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"c1", "*", "c2"}], "-", 
          RowBox[{"c0", "*", "c3"}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"R4", "=", 
       RowBox[{
        RowBox[{"tr0", "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"c2", "*", "c2"}], "+", 
           RowBox[{"c0", "*", "c0"}]}], ")"}]}], "-", "1"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"R5", "=", 
       RowBox[{"tr0", "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"c2", "*", "c3"}], "+", 
          RowBox[{"c0", "*", "c1"}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"R6", "=", 
       RowBox[{"tr0", "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"c1", "*", "c3"}], "+", 
          RowBox[{"c0", "*", "c2"}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"R7", "=", 
       RowBox[{"tr0", "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"c2", "*", "c3"}], "-", 
          RowBox[{"c0", "*", "c1"}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"R8", "=", 
       RowBox[{
        RowBox[{"tr0", "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"c3", "*", "c3"}], "+", 
           RowBox[{"c0", "*", "c0"}]}], ")"}]}], "-", "1"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"R0", ",", "R3", ",", "R6"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"R1", ",", "R4", ",", "R7"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"R2", ",", "R5", ",", "R8"}], "}"}]}], "}"}]}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.5878355847182283`*^9, 3.587835763499675*^9}, {
  3.587835878802307*^9, 3.587836092045874*^9}, {3.587836476053508*^9, 
  3.587836507729391*^9}, {3.587836577865527*^9, 3.5878365821010323`*^9}, {
  3.587911524501296*^9, 3.587911588469393*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["CRV Matrix H", "Subsection",
 CellChangeTimes->{{3.587911315256957*^9, 3.58791131824615*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CrvMatrixH", "[", 
    RowBox[{"cc1_", ",", "cc2_", ",", "cc3_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"cf1", "=", 
        RowBox[{"cc1", "/", "4"}]}], ",", 
       RowBox[{"cf2", "=", 
        RowBox[{"cc2", "/", "4"}]}], ",", 
       RowBox[{"cf3", "=", 
        RowBox[{"cc3", "/", "4"}]}], ",", "cq", ",", "ocq", ",", "aa", ",", 
       "cb0", ",", "cb1", ",", "cb2", ",", "cb3", ",", "H0", ",", "H1", ",", 
       "H2", ",", "H3", ",", "H4", ",", "H5", ",", "H6", ",", "H7", ",", 
       "H8"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"cq", "=", 
       RowBox[{
        RowBox[{"cf1", "*", "cf1"}], "+", 
        RowBox[{"cf2", "*", "cf2"}], "+", 
        RowBox[{"cf3", "*", "cf3"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ocq", "=", 
       RowBox[{"1", "+", "cq"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"aa", "=", 
       RowBox[{"2", "*", "ocq", "*", "ocq"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"cb0", "=", 
       RowBox[{"2", "*", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "cq"}], ")"}], "/", "aa"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"cb1", "=", 
       RowBox[{"cc1", "/", "aa"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"cb2", "=", 
       RowBox[{"cc2", "/", "aa"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"cb3", "=", 
       RowBox[{"cc3", "/", "aa"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"H0", "=", 
       RowBox[{
        RowBox[{"cb1", "*", "cf1"}], "+", "cb0"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"H1", "=", 
       RowBox[{
        RowBox[{"cb2", "*", "cf1"}], "+", "cb3"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"H2", "=", 
       RowBox[{
        RowBox[{"cb3", "*", "cf1"}], "-", "cb2"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"H3", "=", 
       RowBox[{
        RowBox[{"cb1", "*", "cf2"}], "-", "cb3"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"H4", "=", 
       RowBox[{
        RowBox[{"cb2", "*", "cf2"}], "+", "cb0"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"H5", "=", 
       RowBox[{
        RowBox[{"cb3", "*", "cf2"}], "+", "cb1"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"H6", "=", 
       RowBox[{
        RowBox[{"cb1", "*", "cf3"}], "+", "cb2"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"H7", "=", 
       RowBox[{
        RowBox[{"cb2", "*", "cf3"}], "-", "cb1"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"H8", "=", 
       RowBox[{
        RowBox[{"cb3", "*", "cf3"}], "+", "cb0"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"H0", ",", "H3", ",", "H6"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"H1", ",", "H4", ",", "H7"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"H2", ",", "H5", ",", "H8"}], "}"}]}], "}"}]}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.5879071603087587`*^9, 3.587907161392222*^9}, {
   3.5879071979899483`*^9, 3.587907538957402*^9}, 3.587908807983962*^9, {
   3.587911598519912*^9, 3.587911644384034*^9}}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["GLL Shape Function", "Section",
 CellChangeTimes->{{3.588291386170886*^9, 3.588291407208864*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"norder", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GLL1", "=", 
   RowBox[{"-", "1.0"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GLL2", "=", "0.0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GLL3", "=", "1.0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GL1", "=", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"Sqrt", "[", "3", "]"}]}], "/", "3.0"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GL2", "=", 
   RowBox[{
    RowBox[{"Sqrt", "[", "3", "]"}], "/", "3.0"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"hh1", "[", "s_", "]"}], ":=", 
   RowBox[{"Piecewise", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", 
        RowBox[{"s", "\[Equal]", "GLL1"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        FractionBox[
         RowBox[{
          FractionBox["1", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            SuperscriptBox["s", "2"]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"0", "+", 
            RowBox[{"6", " ", "s"}]}], ")"}]}], 
         RowBox[{"norder", "*", 
          RowBox[{"(", 
           RowBox[{"norder", "+", "1"}], ")"}], "*", 
          RowBox[{"LegendreP", "[", 
           RowBox[{"2", ",", "GLL1"}], "]"}], "*", 
          RowBox[{"(", 
           RowBox[{"s", "-", "GLL1"}], ")"}]}]], ",", 
        RowBox[{"GLL1", "<", "s", "\[LessEqual]", "1"}]}], "}"}]}], "}"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"hh2", "[", "s_", "]"}], ":=", 
   RowBox[{"Piecewise", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        FractionBox[
         RowBox[{
          FractionBox["1", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            SuperscriptBox["s", "2"]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"0", "+", 
            RowBox[{"6", " ", "s"}]}], ")"}]}], 
         RowBox[{"norder", "*", 
          RowBox[{"(", 
           RowBox[{"norder", "+", "1"}], ")"}], "*", 
          RowBox[{"LegendreP", "[", 
           RowBox[{"2", ",", "GLL2"}], "]"}], "*", 
          RowBox[{"(", 
           RowBox[{"s", "-", "GLL2"}], ")"}]}]], ",", 
        RowBox[{
         RowBox[{"-", "1"}], "\[LessEqual]", "s", "<", "GLL2"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", 
        RowBox[{"s", "==", "GLL2"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        FractionBox[
         RowBox[{
          FractionBox["1", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            SuperscriptBox["s", "2"]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"0", "+", 
            RowBox[{"6", " ", "s"}]}], ")"}]}], 
         RowBox[{"norder", "*", 
          RowBox[{"(", 
           RowBox[{"norder", "+", "1"}], ")"}], "*", 
          RowBox[{"LegendreP", "[", 
           RowBox[{"2", ",", "GLL2"}], "]"}], "*", 
          RowBox[{"(", 
           RowBox[{"s", "-", "GLL2"}], ")"}]}]], ",", 
        RowBox[{"GLL2", "<", "s", "\[LessEqual]", "1"}]}], "}"}]}], "}"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"hh3", "[", "s_", "]"}], ":=", 
   RowBox[{"Piecewise", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        FractionBox[
         RowBox[{
          FractionBox["1", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            SuperscriptBox["s", "2"]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"0", "+", 
            RowBox[{"6", " ", "s"}]}], ")"}]}], 
         RowBox[{"norder", "*", 
          RowBox[{"(", 
           RowBox[{"norder", "+", "1"}], ")"}], "*", 
          RowBox[{"LegendreP", "[", 
           RowBox[{"2", ",", "GLL3"}], "]"}], "*", 
          RowBox[{"(", 
           RowBox[{"s", "-", "GLL3"}], ")"}]}]], ",", 
        RowBox[{
         RowBox[{"-", "1"}], "\[LessEqual]", "s", "<", "GLL3"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", 
        RowBox[{"s", "\[Equal]", "GLL3"}]}], "}"}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"hh1", "[", "s", "]"}], ",", 
     RowBox[{"hh2", "[", "s", "]"}], ",", 
     RowBox[{"hh3", "[", "s", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"s", ",", 
     RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "0.2"}], ",", "1"}], "}"}]}], "}"}]}]}], "]"}]}], "Input",\

 CellChangeTimes->{{3.588291450416129*^9, 3.58829145096471*^9}}],

Cell[BoxData[
 GraphicsBox[{{{}, {}, 
    {Hue[0.67, 0.6, 0.6], LineBox[CompressedData["
1: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
      "]]}, 
    {Hue[0.9060679774997897, 0.6, 0.6], LineBox[CompressedData["
1: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
j/8LRC/Sog==
      "]], LineBox[CompressedData["
1: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
      "]]}, 
    {Hue[0.1421359549995791, 0.6, 0.6], LineBox[CompressedData["
1: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
nw==
      "]]}, {}}, {{}, {}, {}, {}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  AxesOrigin->{0, 0},
  PlotRange->{{-1, 1}, {-0.2, 1}},
  PlotRangeClipping->True,
  PlotRangePadding->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{3.590852237006544*^9, 3.590857574587178*^9, 
  3.5908660591881933`*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Time Scheme Parameters and Coefficients\
\>", "Section",
 CellChangeTimes->{{3.590852291996902*^9, 3.5908523017569933`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"rhoinf", "=", "0.0"}], ";"}]], "Input",
 CellChangeTimes->{{3.5908523051891127`*^9, 3.590852319573347*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"tr0", "=", 
   RowBox[{"rhoinf", "+", "1.0"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"alfam", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2.0", "*", "rhoinf"}], "-", "1.0"}], ")"}], "/", "tr0"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"alfaf", "=", 
   RowBox[{"rhoinf", "/", "tr0"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gama", "=", 
   RowBox[{"0.5", "-", "alfam", "+", "alfaf"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"beta", "=", 
   RowBox[{"0.25", "*", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1.0", "-", "alfam", "+", "alfaf"}], ")"}], "2"]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.590852394720471*^9, 3.5908524767526083`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"deltat", "=", "0.001"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"deltat2", "=", 
   SuperscriptBox["deltat", "2"]}], ";"}]}], "Input",
 CellChangeTimes->{{3.590852551085226*^9, 3.590852568410055*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"oalfaM", "=", 
   RowBox[{"1.0", "-", "alfam"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tr0", "=", 
   RowBox[{"alfaf", "/", "oalfaM"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tr1", "=", 
   RowBox[{"alfam", "/", "oalfaM"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tr2", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1.0", "-", "alfaf"}], ")"}], "/", "oalfaM"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"coef", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", "0", "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"coef", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1"}], "]"}], "]"}], "=", 
   RowBox[{"beta", "*", "tr0", "*", "deltat2"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"coef", "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "1"}], "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"0.5", "-", 
      RowBox[{"beta", "/", "oalfaM"}]}], ")"}], "*", "deltat2"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"coef", "[", 
    RowBox[{"[", 
     RowBox[{"3", ",", "1"}], "]"}], "]"}], "=", 
   RowBox[{"gama", "*", "tr0", "*", "deltat"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"coef", "[", 
    RowBox[{"[", 
     RowBox[{"4", ",", "1"}], "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1.0", "-", 
      RowBox[{"gama", "/", "oalfaM"}]}], ")"}], "*", "deltat"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"coef", "[", 
    RowBox[{"[", 
     RowBox[{"5", ",", "1"}], "]"}], "]"}], "=", "tr0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"coef", "[", 
    RowBox[{"[", 
     RowBox[{"6", ",", "1"}], "]"}], "]"}], "=", 
   RowBox[{"-", "tr1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"coef", "[", 
    RowBox[{"[", 
     RowBox[{"7", ",", "1"}], "]"}], "]"}], "=", 
   RowBox[{"gama", "*", "tr2", "*", "deltat"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"coef", "[", 
    RowBox[{"[", 
     RowBox[{"8", ",", "1"}], "]"}], "]"}], "=", 
   RowBox[{"beta", "*", "tr2", "*", "deltat2"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"coef", "[", 
    RowBox[{"[", 
     RowBox[{"9", ",", "1"}], "]"}], "]"}], "=", "tr2"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"coef", ";"}]}], "Input",
 CellChangeTimes->{{3.590852507490011*^9, 3.590852541280418*^9}, {
   3.5908525838294487`*^9, 3.590852805628333*^9}, 3.590856222824923*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["First Iteration", "Section",
 CellChangeTimes->{{3.587754189766006*^9, 3.587754202213131*^9}}],

Cell[CellGroupData[{

Cell["(*Predictor Step*)", "Subsection",
 CellChangeTimes->{{3.5908551373628597`*^9, 3.590855143926612*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vvNf", "=", 
   RowBox[{"vvNi", "+", 
    RowBox[{
     RowBox[{"coef", "[", 
      RowBox[{"[", 
       RowBox[{"3", ",", "1"}], "]"}], "]"}], "*", "aaNi"}], "+", 
    RowBox[{
     RowBox[{"coef", "[", 
      RowBox[{"[", 
       RowBox[{"4", ",", "1"}], "]"}], "]"}], "*", "xxNi"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"aaNf", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "18"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xxNf", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"coef", "[", 
      RowBox[{"[", 
       RowBox[{"5", ",", "1"}], "]"}], "]"}], "*", "aaNi"}], "+", 
    RowBox[{
     RowBox[{"coef", "[", 
      RowBox[{"[", 
       RowBox[{"6", ",", "1"}], "]"}], "]"}], "*", "xxNi"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tr", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "18"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tr", "=", 
   RowBox[{
    RowBox[{"deltat", "*", "vvNi"}], "+", 
    RowBox[{
     RowBox[{"coef", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}], "*", "aaNi"}], "+", 
    RowBox[{
     RowBox[{"coef", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "1"}], "]"}], "]"}], "*", "xxNi"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tempN1", "=", 
   RowBox[{"CrvCompose0", "[", 
    RowBox[{
     RowBox[{"tr", "[", 
      RowBox[{"[", 
       RowBox[{"4", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{"tr", "[", 
      RowBox[{"[", 
       RowBox[{"5", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{"tr", "[", 
      RowBox[{"[", 
       RowBox[{"6", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{"uuNi", "[", 
      RowBox[{"[", 
       RowBox[{"4", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{"uuNi", "[", 
      RowBox[{"[", 
       RowBox[{"5", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{"uuNi", "[", 
      RowBox[{"[", 
       RowBox[{"6", ",", "1"}], "]"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tempN2", "=", 
   RowBox[{"CrvCompose0", "[", 
    RowBox[{
     RowBox[{"tr", "[", 
      RowBox[{"[", 
       RowBox[{"10", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{"tr", "[", 
      RowBox[{"[", 
       RowBox[{"11", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{"tr", "[", 
      RowBox[{"[", 
       RowBox[{"12", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{"uuNi", "[", 
      RowBox[{"[", 
       RowBox[{"10", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{"uuNi", "[", 
      RowBox[{"[", 
       RowBox[{"11", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{"uuNi", "[", 
      RowBox[{"[", 
       RowBox[{"12", ",", "1"}], "]"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tempN3", "=", 
   RowBox[{"CrvCompose0", "[", 
    RowBox[{
     RowBox[{"tr", "[", 
      RowBox[{"[", 
       RowBox[{"16", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{"tr", "[", 
      RowBox[{"[", 
       RowBox[{"17", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{"tr", "[", 
      RowBox[{"[", 
       RowBox[{"18", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{"uuNi", "[", 
      RowBox[{"[", 
       RowBox[{"16", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{"uuNi", "[", 
      RowBox[{"[", 
       RowBox[{"17", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{"uuNi", "[", 
      RowBox[{"[", 
       RowBox[{"18", ",", "1"}], "]"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"uuNf", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", "1"}], "]"}], "]"}], "=", 
    RowBox[{
     RowBox[{"uuNi", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "1"}], "]"}], "]"}], "+", 
     RowBox[{"tr", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "1"}], "]"}], "]"}]}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"uuNf", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"i", "+", "3"}], ",", "1"}], "]"}], "]"}], "=", 
     RowBox[{"tempN1", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "3"}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"uuNf", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"i", "+", "6"}], ",", "1"}], "]"}], "]"}], "=", 
     RowBox[{"tr", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"i", "+", "6"}], ",", "1"}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "3"}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"uuNf", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"i", "+", "3", "+", "6"}], ",", "1"}], "]"}], "]"}], "=", 
     RowBox[{"tempN2", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "3"}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"uuNf", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"i", "+", "12"}], ",", "1"}], "]"}], "]"}], "=", 
     RowBox[{"tr", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"i", "+", "12"}], ",", "1"}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "3"}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"uuNf", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"i", "+", "3", "+", "12"}], ",", "1"}], "]"}], "]"}], "=", 
     RowBox[{"tempN3", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "3"}], "}"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.590855842376685*^9, 3.590855963168969*^9}, {
   3.590855994976788*^9, 3.590856090465423*^9}, {3.590856145086377*^9, 
   3.590856156912258*^9}, {3.590856258255789*^9, 3.590856258889543*^9}, {
   3.5908563148169928`*^9, 3.5908563158397083`*^9}, {3.590856352837357*^9, 
   3.59085643403483*^9}, {3.590856503441854*^9, 3.590856695635285*^9}, {
   3.590856726774621*^9, 3.590856726877658*^9}, {3.590856777277192*^9, 
   3.5908567799004717`*^9}, {3.590856820110063*^9, 3.5908568225418377`*^9}, {
   3.590856854717979*^9, 3.590856926147827*^9}, 3.5908569867258863`*^9, {
   3.5908570626788282`*^9, 3.590857079885531*^9}, {3.590857178842956*^9, 
   3.590857196539193*^9}, {3.590857365039937*^9, 3.59085736592024*^9}, {
   3.590857405659164*^9, 3.590857451994923*^9}, {3.590857486722722*^9, 
   3.590857520572929*^9}, {3.590857587272197*^9, 3.5908576079704323`*^9}, {
   3.590866326799967*^9, 3.5908663468782063`*^9}}]
}, Open  ]],

Cell["(*END Predictor Step*)", "Subsection",
 CellChangeTimes->{{3.590857630238414*^9, 3.5908576361450377`*^9}}],

Cell["(*Compute Nodal Values: E1, RR0, Stif, cet, kapa*)", "Subsection",
 CellChangeTimes->{{3.5879204531678267`*^9, 3.5879204713047037`*^9}, {
  3.587922060812168*^9, 3.5879220622813997`*^9}}],

Cell[CellGroupData[{

Cell["Compute E10", "Subsection",
 CellChangeTimes->{{3.587754206339679*^9, 3.587754218302059*^9}, {
  3.587833514565754*^9, 3.58783351566555*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"E10N1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"E10N1", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "1"}], "]"}], "]"}], "=", 
    RowBox[{
     RowBox[{"E10N1", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}], "+", 
     RowBox[{
      RowBox[{"hhp", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "1"}], "]"}], "]"}], "*", 
      RowBox[{"uuN0", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"i", "-", "1"}], ")"}], "*", "6"}], "+", "1"}], ",", 
         "1"}], "]"}], "]"}]}]}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"E10N1", "[", 
     RowBox[{"[", 
      RowBox[{"2", ",", "1"}], "]"}], "]"}], "=", 
    RowBox[{
     RowBox[{"E10N1", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "1"}], "]"}], "]"}], "+", 
     RowBox[{
      RowBox[{"hhp", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "1"}], "]"}], "]"}], "*", 
      RowBox[{"uuN0", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"i", "-", "1"}], ")"}], "*", "6"}], "+", "2"}], ",", 
         "1"}], "]"}], "]"}]}]}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"E10N1", "[", 
     RowBox[{"[", 
      RowBox[{"3", ",", "1"}], "]"}], "]"}], "=", 
    RowBox[{
     RowBox[{"E10N1", "[", 
      RowBox[{"[", 
       RowBox[{"3", ",", "1"}], "]"}], "]"}], "+", 
     RowBox[{
      RowBox[{"hhp", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "1"}], "]"}], "]"}], "*", 
      RowBox[{"uuN0", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"i", "-", "1"}], ")"}], "*", "6"}], "+", "3"}], ",", 
         "1"}], "]"}], "]"}]}]}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"E10N2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"E10N2", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "1"}], "]"}], "]"}], "=", 
    RowBox[{
     RowBox[{"E10N2", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}], "+", 
     RowBox[{
      RowBox[{"hhp", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "2"}], "]"}], "]"}], "*", 
      RowBox[{"uuN0", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"i", "-", "1"}], ")"}], "*", "6"}], "+", "1"}], ",", 
         "1"}], "]"}], "]"}]}]}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"E10N2", "[", 
     RowBox[{"[", 
      RowBox[{"2", ",", "1"}], "]"}], "]"}], "=", 
    RowBox[{
     RowBox[{"E10N2", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "1"}], "]"}], "]"}], "+", 
     RowBox[{
      RowBox[{"hhp", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "2"}], "]"}], "]"}], "*", 
      RowBox[{"uuN0", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"i", "-", "1"}], ")"}], "*", "6"}], "+", "2"}], ",", 
         "1"}], "]"}], "]"}]}]}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"E10N2", "[", 
     RowBox[{"[", 
      RowBox[{"3", ",", "1"}], "]"}], "]"}], "=", 
    RowBox[{
     RowBox[{"E10N2", "[", 
      RowBox[{"[", 
       RowBox[{"3", ",", "1"}], "]"}], "]"}], "+", 
     RowBox[{
      RowBox[{"hhp", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "2"}], "]"}], "]"}], "*", 
      RowBox[{"uuN0", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"i", "-", "1"}], ")"}], "*", "6"}], "+", "3"}], ",", 
         "1"}], "]"}], "]"}]}]}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"E10N3", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"E10N3", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "1"}], "]"}], "]"}], "=", 
    RowBox[{
     RowBox[{"E10N3", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}], "+", 
     RowBox[{
      RowBox[{"hhp", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "3"}], "]"}], "]"}], "*", 
      RowBox[{"uuN0", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"i", "-", "1"}], ")"}], "*", "6"}], "+", "1"}], ",", 
         "1"}], "]"}], "]"}]}]}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"E10N3", "[", 
     RowBox[{"[", 
      RowBox[{"2", ",", "1"}], "]"}], "]"}], "=", 
    RowBox[{
     RowBox[{"E10N3", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "1"}], "]"}], "]"}], "+", 
     RowBox[{
      RowBox[{"hhp", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "3"}], "]"}], "]"}], "*", 
      RowBox[{"uuN0", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"i", "-", "1"}], ")"}], "*", "6"}], "+", "2"}], ",", 
         "1"}], "]"}], "]"}]}]}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"E10N3", "[", 
     RowBox[{"[", 
      RowBox[{"3", ",", "1"}], "]"}], "]"}], "=", 
    RowBox[{
     RowBox[{"E10N3", "[", 
      RowBox[{"[", 
       RowBox[{"3", ",", "1"}], "]"}], "]"}], "+", 
     RowBox[{
      RowBox[{"hhp", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "3"}], "]"}], "]"}], "*", 
      RowBox[{"uuN0", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"i", "-", "1"}], ")"}], "*", "6"}], "+", "3"}], ",", 
         "1"}], "]"}], "]"}]}]}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"E10N1", "=", 
   RowBox[{"E10N1", "/", "Jaco"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"E10N2", "=", 
   RowBox[{"E10N2", "/", "Jaco"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"E10N3", "=", 
   RowBox[{"E10N3", "/", "Jaco"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"E10N1", "//", "MatrixForm"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"E10N2", "//", "MatrixForm"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"E10N3", "//", "MatrixForm"}], ";"}]}], "Input",
 CellChangeTimes->{{3.58775422609374*^9, 3.587754398368726*^9}, {
  3.58775448274543*^9, 3.587754533076005*^9}, {3.587754582059051*^9, 
  3.587754635294845*^9}, {3.587833439517671*^9, 3.587833440703767*^9}, {
  3.587836890752481*^9, 3.587836899879169*^9}, {3.5879117005512943`*^9, 
  3.5879118154179993`*^9}, {3.587918533453866*^9, 3.587918622963627*^9}, {
  3.5880411868086*^9, 3.58804121775948*^9}, {3.5880412910752068`*^9, 
  3.5880412962205772`*^9}, {3.588288776806507*^9, 3.588288777443852*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Compute E1", "Subsection",
 CellChangeTimes->{{3.587817010434211*^9, 3.587817014391336*^9}, {
  3.587833520311347*^9, 3.587833522365748*^9}, {3.587907571964334*^9, 
  3.587907581277869*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"E1N1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"E1N1", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "1"}], "]"}], "]"}], "=", 
    RowBox[{
     RowBox[{"E1N1", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}], "+", 
     RowBox[{
      RowBox[{"hhp", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "1"}], "]"}], "]"}], "*", 
      RowBox[{"uuNf", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"i", "-", "1"}], ")"}], "*", "6"}], "+", "1"}], ",", 
         "1"}], "]"}], "]"}]}]}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"E1N1", "[", 
     RowBox[{"[", 
      RowBox[{"2", ",", "1"}], "]"}], "]"}], "=", 
    RowBox[{
     RowBox[{"E1N1", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "1"}], "]"}], "]"}], "+", 
     RowBox[{
      RowBox[{"hhp", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "1"}], "]"}], "]"}], "*", 
      RowBox[{"uuNf", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"i", "-", "1"}], ")"}], "*", "6"}], "+", "2"}], ",", 
         "1"}], "]"}], "]"}]}]}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"E1N1", "[", 
     RowBox[{"[", 
      RowBox[{"3", ",", "1"}], "]"}], "]"}], "=", 
    RowBox[{
     RowBox[{"E1N1", "[", 
      RowBox[{"[", 
       RowBox[{"3", ",", "1"}], "]"}], "]"}], "+", 
     RowBox[{
      RowBox[{"hhp", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "1"}], "]"}], "]"}], "*", 
      RowBox[{"uuNf", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"i", "-", "1"}], ")"}], "*", "6"}], "+", "3"}], ",", 
         "1"}], "]"}], "]"}]}]}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"E1N1", "=", 
   RowBox[{
    RowBox[{"E1N1", "/", "Jaco"}], "+", "E10N1"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"E1N2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"E1N2", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "1"}], "]"}], "]"}], "=", 
    RowBox[{
     RowBox[{"E1N2", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}], "+", 
     RowBox[{
      RowBox[{"hhp", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "2"}], "]"}], "]"}], "*", 
      RowBox[{"uuNf", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"i", "-", "1"}], ")"}], "*", "6"}], "+", "1"}], ",", 
         "1"}], "]"}], "]"}]}]}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"E1N2", "[", 
     RowBox[{"[", 
      RowBox[{"2", ",", "1"}], "]"}], "]"}], "=", 
    RowBox[{
     RowBox[{"E1N2", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "1"}], "]"}], "]"}], "+", 
     RowBox[{
      RowBox[{"hhp", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "2"}], "]"}], "]"}], "*", 
      RowBox[{"uuNf", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"i", "-", "1"}], ")"}], "*", "6"}], "+", "2"}], ",", 
         "1"}], "]"}], "]"}]}]}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"E1N2", "[", 
     RowBox[{"[", 
      RowBox[{"3", ",", "1"}], "]"}], "]"}], "=", 
    RowBox[{
     RowBox[{"E1N2", "[", 
      RowBox[{"[", 
       RowBox[{"3", ",", "1"}], "]"}], "]"}], "+", 
     RowBox[{
      RowBox[{"hhp", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "2"}], "]"}], "]"}], "*", 
      RowBox[{"uuNf", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"i", "-", "1"}], ")"}], "*", "6"}], "+", "3"}], ",", 
         "1"}], "]"}], "]"}]}]}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"E1N2", "=", 
   RowBox[{
    RowBox[{"E1N2", "/", "Jaco"}], "+", "E10N2"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"E1N3", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"E1N3", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "1"}], "]"}], "]"}], "=", 
    RowBox[{
     RowBox[{"E1N3", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}], "+", 
     RowBox[{
      RowBox[{"hhp", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "3"}], "]"}], "]"}], "*", 
      RowBox[{"uuNf", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"i", "-", "1"}], ")"}], "*", "6"}], "+", "1"}], ",", 
         "1"}], "]"}], "]"}]}]}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"E1N3", "[", 
     RowBox[{"[", 
      RowBox[{"2", ",", "1"}], "]"}], "]"}], "=", 
    RowBox[{
     RowBox[{"E1N3", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "1"}], "]"}], "]"}], "+", 
     RowBox[{
      RowBox[{"hhp", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "3"}], "]"}], "]"}], "*", 
      RowBox[{"uuNf", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"i", "-", "1"}], ")"}], "*", "6"}], "+", "2"}], ",", 
         "1"}], "]"}], "]"}]}]}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"E1N3", "[", 
     RowBox[{"[", 
      RowBox[{"3", ",", "1"}], "]"}], "]"}], "=", 
    RowBox[{
     RowBox[{"E1N3", "[", 
      RowBox[{"[", 
       RowBox[{"3", ",", "1"}], "]"}], "]"}], "+", 
     RowBox[{
      RowBox[{"hhp", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "3"}], "]"}], "]"}], "*", 
      RowBox[{"uuNf", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"i", "-", "1"}], ")"}], "*", "6"}], "+", "3"}], ",", 
         "1"}], "]"}], "]"}]}]}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"E1N3", "=", 
   RowBox[{
    RowBox[{"E1N3", "/", "Jaco"}], "+", "E10N3"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"E1N1", "//", "MatrixForm"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"E1N2", "//", "MatrixForm"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"E1N3", "//", "MatrixForm"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.58775422609374*^9, 3.587754398368726*^9}, {
  3.58775448274543*^9, 3.587754533076005*^9}, {3.587754582059051*^9, 
  3.587754635294845*^9}, {3.587817045064726*^9, 3.587817124864449*^9}, {
  3.5878334877572803`*^9, 3.5878334885764103`*^9}, {3.587836909925946*^9, 
  3.587836912640258*^9}, {3.587918649660986*^9, 3.58791880264116*^9}, {
  3.58804122939441*^9, 3.5880412421910057`*^9}, {3.5880413015857553`*^9, 
  3.588041306214417*^9}, {3.58828878079557*^9, 3.5882887814102707`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Compute RR0", "Subsection",
 CellChangeTimes->{{3.5878175759194517`*^9, 3.587817584177951*^9}}],

Cell[CellGroupData[{

Cell["Compose ccc and cc0", "Subsubsection",
 CellChangeTimes->{{3.587833553703298*^9, 3.58783355818044*^9}, {
  3.587833625365438*^9, 3.587833628130508*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ccN1", "=", 
   RowBox[{"CrvCompose0", "[", 
    RowBox[{
     RowBox[{"uuNf", "[", 
      RowBox[{"[", 
       RowBox[{"4", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{"uuNf", "[", 
      RowBox[{"[", 
       RowBox[{"5", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{"uuNf", "[", 
      RowBox[{"[", 
       RowBox[{"6", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{"uuN0", "[", 
      RowBox[{"[", 
       RowBox[{"4", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{"uuN0", "[", 
      RowBox[{"[", 
       RowBox[{"5", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{"uuN0", "[", 
      RowBox[{"[", 
       RowBox[{"6", ",", "1"}], "]"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ccN2", "=", 
   RowBox[{"CrvCompose0", "[", 
    RowBox[{
     RowBox[{"uuNf", "[", 
      RowBox[{"[", 
       RowBox[{"10", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{"uuNf", "[", 
      RowBox[{"[", 
       RowBox[{"11", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{"uuNf", "[", 
      RowBox[{"[", 
       RowBox[{"12", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{"uuN0", "[", 
      RowBox[{"[", 
       RowBox[{"10", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{"uuN0", "[", 
      RowBox[{"[", 
       RowBox[{"11", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{"uuN0", "[", 
      RowBox[{"[", 
       RowBox[{"12", ",", "1"}], "]"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ccN3", "=", 
   RowBox[{"CrvCompose0", "[", 
    RowBox[{
     RowBox[{"uuNf", "[", 
      RowBox[{"[", 
       RowBox[{"16", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{"uuNf", "[", 
      RowBox[{"[", 
       RowBox[{"17", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{"uuNf", "[", 
      RowBox[{"[", 
       RowBox[{"18", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{"uuN0", "[", 
      RowBox[{"[", 
       RowBox[{"16", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{"uuN0", "[", 
      RowBox[{"[", 
       RowBox[{"17", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{"uuN0", "[", 
      RowBox[{"[", 
       RowBox[{"18", ",", "1"}], "]"}], "]"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.5878351422118397`*^9, 3.587835231122501*^9}, {
  3.587835322485483*^9, 3.587835325641467*^9}, {3.587835359906851*^9, 
  3.587835441141786*^9}, {3.5879190490628643`*^9, 3.587919062942588*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Compute CRV Matrix R", "Subsubsection",
 CellChangeTimes->{{3.587835548562796*^9, 3.587835581040512*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"RR0N1", "=", 
   RowBox[{"CrvMatrixR", "[", 
    RowBox[{
     RowBox[{"ccN1", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{"ccN1", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{"ccN1", "[", 
      RowBox[{"[", 
       RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RR0N2", "=", 
   RowBox[{"CrvMatrixR", "[", 
    RowBox[{
     RowBox[{"ccN2", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{"ccN2", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{"ccN2", "[", 
      RowBox[{"[", 
       RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RR0N3", "=", 
   RowBox[{"CrvMatrixR", "[", 
    RowBox[{
     RowBox[{"ccN3", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{"ccN3", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{"ccN3", "[", 
      RowBox[{"[", 
       RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RR0N1", "//", "MatrixForm"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RR0N2", "//", "MatrixForm"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RR0N3", "//", "MatrixForm"}], ";"}]}], "Input",
 CellChangeTimes->{{3.587836512756153*^9, 3.587836560415715*^9}, {
  3.587836628758173*^9, 3.587836638001161*^9}, {3.587836793732723*^9, 
  3.587836826774221*^9}, {3.587836930771825*^9, 3.587836934376195*^9}, {
  3.5879190772783813`*^9, 3.587919141551895*^9}, {3.588288785017277*^9, 
  3.588288785687842*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Rotate C/S Stiffness Matrix", "Subsection",
 CellChangeTimes->{{3.587907596252862*^9, 3.587907599059901*^9}, {
  3.587907629276826*^9, 3.5879076477567787`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"tempR6", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "6"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"StifN1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "6"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"StifN2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "6"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"StifN3", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "6"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"tempR6", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
     RowBox[{"RR0N1", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"tempR6", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"i", "+", "3"}], ",", 
        RowBox[{"j", "+", "3"}]}], "]"}], "]"}], "=", 
     RowBox[{"RR0N1", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"StifN1", "=", 
   RowBox[{"tempR6", ".", "Stif0", ".", 
    RowBox[{"Transpose", "[", "tempR6", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"tempR6", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
     RowBox[{"RR0N2", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"tempR6", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"i", "+", "3"}], ",", 
        RowBox[{"j", "+", "3"}]}], "]"}], "]"}], "=", 
     RowBox[{"RR0N2", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"StifN2", "=", 
   RowBox[{"tempR6", ".", "Stif0", ".", 
    RowBox[{"Transpose", "[", "tempR6", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"tempR6", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
     RowBox[{"RR0N3", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"tempR6", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"i", "+", "3"}], ",", 
        RowBox[{"j", "+", "3"}]}], "]"}], "]"}], "=", 
     RowBox[{"RR0N3", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"StifN3", "=", 
   RowBox[{"tempR6", ".", "Stif0", ".", 
    RowBox[{"Transpose", "[", "tempR6", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cet", "=", 
   RowBox[{
    RowBox[{"Stif0", "[", 
     RowBox[{"[", 
      RowBox[{"5", ",", "5"}], "]"}], "]"}], "+", 
    RowBox[{"Stif0", "[", 
     RowBox[{"[", 
      RowBox[{"6", ",", "6"}], "]"}], "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.587908034268353*^9, 3.587908058171912*^9}, {
  3.587908088635612*^9, 3.587908175111252*^9}, {3.5879082252111998`*^9, 
  3.5879083891368017`*^9}, {3.587922103416482*^9, 3.5879221287435226`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Compute Relative Rotation", "Subsection",
 CellChangeTimes->{{3.587904277398987*^9, 3.587904282114883*^9}}],

Cell[CellGroupData[{

Cell["Compute Relative Rotation", "Subsubsection",
 CellChangeTimes->{{3.587904504014819*^9, 3.587904508868449*^9}, 
   3.587918519668853*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Nuuutemp1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Nuuutemp2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Nuuutemp3", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Nrrr", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "9"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Nuuutemp1", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "1"}], "]"}], "]"}], "=", 
     RowBox[{"uuNf", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "1"}], ")"}], "*", "6"}], "+", "3", "+", "i"}], 
        ",", "1"}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "3"}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Nuuutemp2", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "1"}], "]"}], "]"}], "=", 
     RowBox[{"uuNf", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"2", "-", "1"}], ")"}], "*", "6"}], "+", "3", "+", "i"}], 
        ",", "1"}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "3"}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Nuuutemp3", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "1"}], "]"}], "]"}], "=", 
     RowBox[{"uuNf", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"3", "-", "1"}], ")"}], "*", "6"}], "+", "3", "+", "i"}], 
        ",", "1"}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "3"}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Nrrrtemp1", "=", 
   RowBox[{"CrvCompose1", "[", 
    RowBox[{
     RowBox[{"Nuuutemp1", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{"Nuuutemp1", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{"Nuuutemp1", "[", 
      RowBox[{"[", 
       RowBox[{"3", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{"Nuuutemp1", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{"Nuuutemp1", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{"Nuuutemp1", "[", 
      RowBox[{"[", 
       RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Nrrrtemp2", "=", 
   RowBox[{"CrvCompose1", "[", 
    RowBox[{
     RowBox[{"Nuuutemp1", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{"Nuuutemp1", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{"Nuuutemp1", "[", 
      RowBox[{"[", 
       RowBox[{"3", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{"Nuuutemp2", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{"Nuuutemp2", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{"Nuuutemp2", "[", 
      RowBox[{"[", 
       RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Nrrrtemp3", "=", 
   RowBox[{"CrvCompose1", "[", 
    RowBox[{
     RowBox[{"Nuuutemp1", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{"Nuuutemp1", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{"Nuuutemp1", "[", 
      RowBox[{"[", 
       RowBox[{"3", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{"Nuuutemp3", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{"Nuuutemp3", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{"Nuuutemp3", "[", 
      RowBox[{"[", 
       RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Nrrr", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "1"}], "]"}], "]"}], "=", 
     RowBox[{"Nrrrtemp1", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "3"}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Nrrr", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"3", "+", "i"}], ",", "1"}], "]"}], "]"}], "=", 
     RowBox[{"Nrrrtemp2", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "3"}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Nrrr", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"6", "+", "i"}], ",", "1"}], "]"}], "]"}], "=", 
     RowBox[{"Nrrrtemp3", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "3"}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Nrrr", "//", "MatrixForm"}], ";"}]}], "Input",
 CellChangeTimes->{{3.587904533971443*^9, 3.5879045391809196`*^9}, {
   3.5879045699430437`*^9, 3.587904609739019*^9}, {3.587904644373497*^9, 
   3.587904674235034*^9}, {3.587906040035295*^9, 3.587906174650429*^9}, {
   3.587906207314035*^9, 3.587906657572687*^9}, {3.587906689051874*^9, 
   3.587906880979817*^9}, 3.587918519671279*^9, {3.5879191964397697`*^9, 
   3.587919232004583*^9}, {3.5879192635091867`*^9, 3.587919268370551*^9}, 
   3.588288791516582*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Compute kapa", "Subsection",
 CellChangeTimes->{{3.587908410938456*^9, 3.587908414399622*^9}}],

Cell[CellGroupData[{

Cell["Compute Relative H", "Subsubsection",
 CellChangeTimes->{{3.587919985159912*^9, 3.587919990613364*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"tempHN1", " ", "=", " ", 
    RowBox[{"CrvMatrixH", "[", 
     RowBox[{
      RowBox[{"Nrrr", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", " ", 
      RowBox[{"Nrrr", "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", " ", "\n", "    ", 
      RowBox[{"Nrrr", "[", 
       RowBox[{"[", 
        RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "]"}]}], ";"}], " "}], "\n", 

 RowBox[{
  RowBox[{
   RowBox[{"tempHN2", " ", "=", " ", 
    RowBox[{"CrvMatrixH", "[", 
     RowBox[{
      RowBox[{"Nrrr", "[", 
       RowBox[{"[", 
        RowBox[{"4", ",", "1"}], "]"}], "]"}], ",", " ", 
      RowBox[{"Nrrr", "[", 
       RowBox[{"[", 
        RowBox[{"5", ",", "1"}], "]"}], "]"}], ",", " ", "\n", "    ", 
      RowBox[{"Nrrr", "[", 
       RowBox[{"[", 
        RowBox[{"6", ",", "1"}], "]"}], "]"}]}], "]"}]}], ";"}], " "}], "\n", 

 RowBox[{
  RowBox[{
   RowBox[{"tempHN3", " ", "=", " ", 
    RowBox[{"CrvMatrixH", "[", 
     RowBox[{
      RowBox[{"Nrrr", "[", 
       RowBox[{"[", 
        RowBox[{"7", ",", "1"}], "]"}], "]"}], ",", " ", 
      RowBox[{"Nrrr", "[", 
       RowBox[{"[", 
        RowBox[{"8", ",", "1"}], "]"}], "]"}], ",", " ", "\n", "    ", 
      RowBox[{"Nrrr", "[", 
       RowBox[{"[", 
        RowBox[{"9", ",", "1"}], "]"}], "]"}]}], "]"}]}], ";"}], 
  " "}]}], "Input"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Compute Derivative of Relative Rotation", "Subsubsection",
 CellChangeTimes->{3.5879200143650312`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"rrpN1", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", " ", 
     RowBox[{"{", 
      RowBox[{"i", ",", " ", "1", ",", " ", "3"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"j", ",", " ", "1"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"rrpN1", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", " ", "1"}], "]"}], "]"}], " ", "=", " ", 
    RowBox[{
     RowBox[{"rrpN1", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", " ", "1"}], "]"}], "]"}], " ", "+", " ", 
     RowBox[{
      RowBox[{"hhp", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", " ", "1"}], "]"}], "]"}], "*", 
      RowBox[{"Nrrr", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"i", " ", "-", " ", "1"}], ")"}], "*", "3"}], " ", "+", 
          " ", "1"}], ",", " ", "1"}], "]"}], "]"}]}]}]}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"i", ",", " ", "3"}], "}"}]}], "]"}], "\n", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"rrpN1", "[", 
     RowBox[{"[", 
      RowBox[{"2", ",", " ", "1"}], "]"}], "]"}], " ", "=", " ", 
    RowBox[{
     RowBox[{"rrpN1", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", " ", "1"}], "]"}], "]"}], " ", "+", " ", 
     RowBox[{
      RowBox[{"hhp", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", " ", "1"}], "]"}], "]"}], "*", 
      RowBox[{"Nrrr", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"i", " ", "-", " ", "1"}], ")"}], "*", "3"}], " ", "+", 
          " ", "2"}], ",", " ", "1"}], "]"}], "]"}]}]}]}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"i", ",", " ", "3"}], "}"}]}], "]"}], "\n", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"rrpN1", "[", 
     RowBox[{"[", 
      RowBox[{"3", ",", " ", "1"}], "]"}], "]"}], " ", "=", " ", 
    RowBox[{
     RowBox[{"rrpN1", "[", 
      RowBox[{"[", 
       RowBox[{"3", ",", " ", "1"}], "]"}], "]"}], " ", "+", " ", 
     RowBox[{
      RowBox[{"hhp", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", " ", "1"}], "]"}], "]"}], "*", 
      RowBox[{"Nrrr", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"i", " ", "-", " ", "1"}], ")"}], "*", "3"}], " ", "+", 
          " ", "3"}], ",", " ", "1"}], "]"}], "]"}]}]}]}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"i", ",", " ", "3"}], "}"}]}], "]"}], "\n", 
 RowBox[{
  RowBox[{"rrpN2", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", " ", 
     RowBox[{"{", 
      RowBox[{"i", ",", " ", "1", ",", " ", "3"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"j", ",", " ", "1"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"rrpN2", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", " ", "1"}], "]"}], "]"}], " ", "=", " ", 
    RowBox[{
     RowBox[{"rrpN2", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", " ", "1"}], "]"}], "]"}], " ", "+", " ", 
     RowBox[{
      RowBox[{"hhp", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", " ", "2"}], "]"}], "]"}], "*", 
      RowBox[{"Nrrr", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"i", " ", "-", " ", "1"}], ")"}], "*", "3"}], " ", "+", 
          " ", "1"}], ",", " ", "1"}], "]"}], "]"}]}]}]}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"i", ",", " ", "3"}], "}"}]}], "]"}], "\n", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"rrpN2", "[", 
     RowBox[{"[", 
      RowBox[{"2", ",", " ", "1"}], "]"}], "]"}], " ", "=", " ", 
    RowBox[{
     RowBox[{"rrpN2", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", " ", "1"}], "]"}], "]"}], " ", "+", " ", 
     RowBox[{
      RowBox[{"hhp", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", " ", "2"}], "]"}], "]"}], "*", 
      RowBox[{"Nrrr", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"i", " ", "-", " ", "1"}], ")"}], "*", "3"}], " ", "+", 
          " ", "2"}], ",", " ", "1"}], "]"}], "]"}]}]}]}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"i", ",", " ", "3"}], "}"}]}], "]"}], "\n", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"rrpN2", "[", 
     RowBox[{"[", 
      RowBox[{"3", ",", " ", "1"}], "]"}], "]"}], " ", "=", " ", 
    RowBox[{
     RowBox[{"rrpN2", "[", 
      RowBox[{"[", 
       RowBox[{"3", ",", " ", "1"}], "]"}], "]"}], " ", "+", " ", 
     RowBox[{
      RowBox[{"hhp", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", " ", "2"}], "]"}], "]"}], "*", 
      RowBox[{"Nrrr", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"i", " ", "-", " ", "1"}], ")"}], "*", "3"}], " ", "+", 
          " ", "3"}], ",", " ", "1"}], "]"}], "]"}]}]}]}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"i", ",", " ", "3"}], "}"}]}], "]"}], "\n", 
 RowBox[{
  RowBox[{"rrpN3", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", " ", 
     RowBox[{"{", 
      RowBox[{"i", ",", " ", "1", ",", " ", "3"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"j", ",", " ", "1"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"rrpN3", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", " ", "1"}], "]"}], "]"}], " ", "=", " ", 
    RowBox[{
     RowBox[{"rrpN3", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", " ", "1"}], "]"}], "]"}], " ", "+", " ", 
     RowBox[{
      RowBox[{"hhp", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", " ", "3"}], "]"}], "]"}], "*", 
      RowBox[{"Nrrr", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"i", " ", "-", " ", "1"}], ")"}], "*", "3"}], " ", "+", 
          " ", "1"}], ",", " ", "1"}], "]"}], "]"}]}]}]}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"i", ",", " ", "3"}], "}"}]}], "]"}], "\n", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"rrpN3", "[", 
     RowBox[{"[", 
      RowBox[{"2", ",", " ", "1"}], "]"}], "]"}], " ", "=", " ", 
    RowBox[{
     RowBox[{"rrpN3", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", " ", "1"}], "]"}], "]"}], " ", "+", " ", 
     RowBox[{
      RowBox[{"hhp", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", " ", "3"}], "]"}], "]"}], "*", 
      RowBox[{"Nrrr", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"i", " ", "-", " ", "1"}], ")"}], "*", "3"}], " ", "+", 
          " ", "2"}], ",", " ", "1"}], "]"}], "]"}]}]}]}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"i", ",", " ", "3"}], "}"}]}], "]"}], "\n", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"rrpN3", "[", 
     RowBox[{"[", 
      RowBox[{"3", ",", " ", "1"}], "]"}], "]"}], " ", "=", " ", 
    RowBox[{
     RowBox[{"rrpN3", "[", 
      RowBox[{"[", 
       RowBox[{"3", ",", " ", "1"}], "]"}], "]"}], " ", "+", " ", 
     RowBox[{
      RowBox[{"hhp", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", " ", "3"}], "]"}], "]"}], "*", 
      RowBox[{"Nrrr", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"i", " ", "-", " ", "1"}], ")"}], "*", "3"}], " ", "+", 
          " ", "3"}], ",", " ", "1"}], "]"}], "]"}]}]}]}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"i", ",", " ", "3"}], "}"}]}], "]"}], "\n", 
 RowBox[{
  RowBox[{"rrpN1", "=", 
   RowBox[{"rrpN1", "/", "Jaco"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rrpN2", "=", 
   RowBox[{"rrpN2", "/", "Jaco"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rrpN3", "=", 
   RowBox[{"rrpN3", "/", "Jaco"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rrpN1", " ", "//", " ", "MatrixForm"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"rrpN2", " ", "//", " ", "MatrixForm"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"rrpN3", " ", "//", " ", "MatrixForm"}], ";"}]}], "Input",
 CellChangeTimes->{{3.587920023121694*^9, 3.587920023123228*^9}, {
  3.588041332193749*^9, 3.588041349045936*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Compute temp cc", "Subsubsection",
 CellChangeTimes->{{3.587920036032868*^9, 3.5879200390369797`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"tempccN1", " ", "=", " ", 
   RowBox[{"tempHN1", ".", "rrpN1"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"tempccN2", " ", "=", " ", 
   RowBox[{"tempHN2", ".", "rrpN2"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"tempccN3", " ", "=", " ", 
   RowBox[{"tempHN2", ".", "rrpN3"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.587920045421794*^9, 3.58792004542385*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Compute Crv Matrix R with c at Node 1", "Subsubsection",
 CellChangeTimes->{{3.587920050713484*^9, 3.5879200599866447`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"tempRN1", " ", "=", " ", 
   RowBox[{"CrvMatrixR", "[", 
    RowBox[{
     RowBox[{"uuNf", "[", 
      RowBox[{"[", 
       RowBox[{"4", ",", " ", "1"}], "]"}], "]"}], ",", " ", 
     RowBox[{"uuNf", "[", 
      RowBox[{"[", 
       RowBox[{"5", ",", " ", "1"}], "]"}], "]"}], ",", " ", 
     RowBox[{"uuNf", "[", 
      RowBox[{"[", 
       RowBox[{"6", ",", " ", "1"}], "]"}], "]"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"tempRN1", " ", "//", " ", "MatrixForm"}], ";"}]}], "Input",
 CellChangeTimes->{{3.587920067330834*^9, 3.587920067332903*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Compute kapa", "Subsubsection",
 CellChangeTimes->{{3.587920073069566*^9, 3.587920075371022*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"kapaN1", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", " ", 
     RowBox[{"{", 
      RowBox[{"i", ",", " ", "1", ",", " ", "3"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"j", ",", " ", "1"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"kapaN1", " ", "=", " ", 
   RowBox[{"tempRN1", ".", "tempccN1"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"kapaN2", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", " ", 
     RowBox[{"{", 
      RowBox[{"i", ",", " ", "1", ",", " ", "3"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"j", ",", " ", "1"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"kapaN2", " ", "=", " ", 
   RowBox[{"tempRN1", ".", "tempccN2"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"kapaN3", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", " ", 
     RowBox[{"{", 
      RowBox[{"i", ",", " ", "1", ",", " ", "3"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"j", ",", " ", "1"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"kapaN3", " ", "=", " ", 
   RowBox[{"tempRN1", ".", "tempccN3"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"kapaN1", " ", "//", " ", "MatrixForm"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"kapaN2", " ", "//", " ", "MatrixForm"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"kapaN3", " ", "//", " ", "MatrixForm"}], ";"}]}], "Input",
 CellChangeTimes->{{3.587920084334147*^9, 3.587920084335631*^9}, 
   3.5879203634776707`*^9, 3.587920402420949*^9}]
}, Open  ]]
}, Open  ]],

Cell["(*END Compute Nodal Values: E1, RR0, Stif, cet, kapa*)", "Subsection",
 CellChangeTimes->{{3.587920493101604*^9, 3.5879205108350143`*^9}, {
  3.587922065368395*^9, 3.587922066694962*^9}}],

Cell["(*Compute Elastic Forces: Fc, Fd, Oe, Pe, Qe*)", "Subsection",
 CellChangeTimes->{{3.587920425135985*^9, 3.587920441733261*^9}, {
  3.5879308691754103`*^9, 3.58793087762665*^9}}],

Cell[CellGroupData[{

Cell["Compute Elastic Force Fc and Fd", "Subsection",
 CellChangeTimes->{{3.587920597615859*^9, 3.5879206474071703`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"eeeN1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eeeN2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eeeN3", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"eeeN1", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", "1"}], "]"}], "]"}], "=", 
    RowBox[{
     RowBox[{"E1N1", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "1"}], "]"}], "]"}], "-", 
     RowBox[{"RR0N1", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "1"}], "]"}], "]"}]}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"eeeN1", "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"i", "+", "3"}], ",", "1"}], "]"}], "]"}], "=", 
    RowBox[{"kapaN1", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"eeeN2", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", "1"}], "]"}], "]"}], "=", 
    RowBox[{
     RowBox[{"E1N2", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "1"}], "]"}], "]"}], "-", 
     RowBox[{"RR0N2", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "1"}], "]"}], "]"}]}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"eeeN2", "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"i", "+", "3"}], ",", "1"}], "]"}], "]"}], "=", 
    RowBox[{"kapaN2", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"eeeN3", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", "1"}], "]"}], "]"}], "=", 
    RowBox[{
     RowBox[{"E1N3", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "1"}], "]"}], "]"}], "-", 
     RowBox[{"RR0N3", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "1"}], "]"}], "]"}]}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"eeeN3", "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"i", "+", "3"}], ",", "1"}], "]"}], "]"}], "=", 
    RowBox[{"kapaN3", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tempSN1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tempSN2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tempSN3", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tempKN1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tempKN2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tempKN3", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"tempSN1", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", "1"}], "]"}], "]"}], "=", 
    RowBox[{"eeeN1", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"tempSN2", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", "1"}], "]"}], "]"}], "=", 
    RowBox[{"eeeN2", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"tempSN3", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", "1"}], "]"}], "]"}], "=", 
    RowBox[{"eeeN3", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"tempKN1", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", "1"}], "]"}], "]"}], "=", 
    RowBox[{"eeeN1", "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"i", "+", "3"}], ",", "1"}], "]"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"tempKN2", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", "1"}], "]"}], "]"}], "=", 
    RowBox[{"eeeN2", "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"i", "+", "3"}], ",", "1"}], "]"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"tempKN3", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", "1"}], "]"}], "]"}], "=", 
    RowBox[{"eeeN3", "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"i", "+", "3"}], ",", "1"}], "]"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fffN1", "=", 
   RowBox[{"StifN1", ".", "eeeN1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fffN2", "=", 
   RowBox[{"StifN2", ".", "eeeN2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fffN3", "=", 
   RowBox[{"StifN3", ".", "eeeN3"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Wrk31", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Wrk31", "=", 
   RowBox[{
    RowBox[{"Transpose", "[", "RR0N1", "]"}], ".", "tempSN1"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"e1sN1", "=", 
   RowBox[{"Wrk31", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Wrk31", "=", 
   RowBox[{
    RowBox[{"Transpose", "[", "RR0N2", "]"}], ".", "tempSN2"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"e1sN2", "=", 
   RowBox[{"Wrk31", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Wrk31", "=", 
   RowBox[{
    RowBox[{"Transpose", "[", "RR0N3", "]"}], ".", "tempSN3"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"e1sN3", "=", 
   RowBox[{"Wrk31", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Wrk31", "=", 
   RowBox[{
    RowBox[{"Transpose", "[", "RR0N1", "]"}], ".", "tempKN1"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"k1sN1", "=", 
   RowBox[{"Wrk31", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Wrk31", "=", 
   RowBox[{
    RowBox[{"Transpose", "[", "RR0N2", "]"}], ".", "tempKN2"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"k1sN2", "=", 
   RowBox[{"Wrk31", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Wrk31", "=", 
   RowBox[{
    RowBox[{"Transpose", "[", "RR0N3", "]"}], ".", "tempKN3"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"k1sN3", "=", 
   RowBox[{"Wrk31", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"fffN1", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", "1"}], "]"}], "]"}], "=", 
    RowBox[{
     RowBox[{"fffN1", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "1"}], "]"}], "]"}], "+", 
     RowBox[{"0.5", "*", "cet", "*", "k1sN1", "*", "k1sN1", "*", 
      RowBox[{"RR0N1", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "1"}], "]"}], "]"}]}]}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"fffN1", "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"i", "+", "3"}], ",", "1"}], "]"}], "]"}], "=", 
    RowBox[{
     RowBox[{"fffN1", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"i", "+", "3"}], ",", "1"}], "]"}], "]"}], "+", 
     RowBox[{"cet", "*", "e1sN1", "*", "k1sN1", "*", 
      RowBox[{"RR0N1", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "1"}], "]"}], "]"}]}]}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"fffN2", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", "1"}], "]"}], "]"}], "=", 
    RowBox[{
     RowBox[{"fffN2", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "1"}], "]"}], "]"}], "+", 
     RowBox[{"0.5", "*", "cet", "*", "k1sN2", "*", "k1sN2", "*", 
      RowBox[{"RR0N2", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "1"}], "]"}], "]"}]}]}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"fffN2", "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"i", "+", "3"}], ",", "1"}], "]"}], "]"}], "=", 
    RowBox[{
     RowBox[{"fffN2", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"i", "+", "3"}], ",", "1"}], "]"}], "]"}], "+", 
     RowBox[{"cet", "*", "e1sN2", "*", "k1sN2", "*", 
      RowBox[{"RR0N2", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "1"}], "]"}], "]"}]}]}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"fffN3", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", "1"}], "]"}], "]"}], "=", 
    RowBox[{
     RowBox[{"fffN3", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "1"}], "]"}], "]"}], "+", 
     RowBox[{"0.5", "*", "cet", "*", "k1sN3", "*", "k1sN3", "*", 
      RowBox[{"RR0N3", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "1"}], "]"}], "]"}]}]}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"fffN3", "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"i", "+", "3"}], ",", "1"}], "]"}], "]"}], "=", 
    RowBox[{
     RowBox[{"fffN3", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"i", "+", "3"}], ",", "1"}], "]"}], "]"}], "+", 
     RowBox[{"cet", "*", "e1sN3", "*", "k1sN3", "*", 
      RowBox[{"RR0N3", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "1"}], "]"}], "]"}]}]}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FcN1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FcN2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FcN3", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FcN1", "=", "fffN1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FcN2", "=", "fffN2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FcN3", "=", "fffN3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FdN1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FdN2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FdN3", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Wrk31", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", "1"}], "]"}], "]"}], "=", 
    RowBox[{"fffN1", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"temp", "=", 
    RowBox[{
     RowBox[{"Transpose", "[", 
      RowBox[{"Tilde", "[", 
       RowBox[{
        RowBox[{"E1N1", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
        RowBox[{"E1N1", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
        RowBox[{"E1N1", "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "]"}], "]"}], ".", 
     "Wrk31"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"Tilde", "[", 
      RowBox[{
       RowBox[{"Wrk31", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"Wrk31", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"Wrk31", "[", 
        RowBox[{"[", 
         RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "]"}], ".", "E1N1"}], ";"}],
    "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"FdN1", "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"i", "+", "3"}], ",", "1"}], "]"}], "]"}], "=", 
    RowBox[{"temp", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Wrk31", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", "1"}], "]"}], "]"}], "=", 
    RowBox[{"fffN2", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"temp", "=", 
    RowBox[{
     RowBox[{"Transpose", "[", 
      RowBox[{"Tilde", "[", 
       RowBox[{
        RowBox[{"E1N2", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
        RowBox[{"E1N2", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
        RowBox[{"E1N2", "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "]"}], "]"}], ".", 
     "Wrk31"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"Tilde", "[", 
      RowBox[{
       RowBox[{"Wrk31", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"Wrk31", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"Wrk31", "[", 
        RowBox[{"[", 
         RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "]"}], ".", "E1N2"}], ";"}],
    "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"FdN2", "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"i", "+", "3"}], ",", "1"}], "]"}], "]"}], "=", 
    RowBox[{"temp", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Wrk31", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", "1"}], "]"}], "]"}], "=", 
    RowBox[{"fffN3", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"temp", "=", 
    RowBox[{
     RowBox[{"Transpose", "[", 
      RowBox[{"Tilde", "[", 
       RowBox[{
        RowBox[{"E1N3", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
        RowBox[{"E1N3", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
        RowBox[{"E1N3", "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "]"}], "]"}], ".", 
     "Wrk31"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"Tilde", "[", 
      RowBox[{
       RowBox[{"Wrk31", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"Wrk31", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"Wrk31", "[", 
        RowBox[{"[", 
         RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "]"}], ".", "E1N3"}], ";"}],
    "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"FdN3", "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"i", "+", "3"}], ",", "1"}], "]"}], "]"}], "=", 
    RowBox[{"temp", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FcN1", "//", "MatrixForm"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FcN2", "//", "MatrixForm"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FcN3", "//", "MatrixForm"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FdN1", "//", "MatrixForm"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FdN2", "//", "MatrixForm"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FdN3", "//", "MatrixForm"}], ";"}]}], "Input",
 CellChangeTimes->{{3.5879206584972677`*^9, 3.5879206691019*^9}, {
  3.587920707683364*^9, 3.587920970346223*^9}, {3.587921055648239*^9, 
  3.587921223635993*^9}, {3.587921298294036*^9, 3.587921393336591*^9}, {
  3.587921439759502*^9, 3.58792158843277*^9}, {3.58792166415532*^9, 
  3.5879218645421267`*^9}, {3.587922034825398*^9, 3.587922051233824*^9}, {
  3.5879221367754383`*^9, 3.587922383708789*^9}, {3.587923573616172*^9, 
  3.58792366191226*^9}, {3.5879239782637033`*^9, 3.587924049455968*^9}, {
  3.587924232418064*^9, 3.587924498722577*^9}, {3.587928074663891*^9, 
  3.587928284911957*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Compute Elastic Matrix Oe, Pe, Qe", "Subsection",
 CellChangeTimes->{{3.587925328397952*^9, 3.587925344995552*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"C11N1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "3"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"C11N2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "3"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"C11N3", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "3"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"C12N1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "3"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"C12N2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "3"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"C12N3", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "3"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"C21N1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "3"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"C21N2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "3"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"C21N3", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "3"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"C22N1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "3"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"C22N2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "3"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"C22N3", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "3"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"C11N1", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
    RowBox[{"StifN1", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"C11N2", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
    RowBox[{"StifN2", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"C11N3", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
    RowBox[{"StifN3", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"C12N1", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
    RowBox[{"StifN1", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", 
       RowBox[{"j", "+", "3"}]}], "]"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"C12N2", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
    RowBox[{"StifN2", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", 
       RowBox[{"j", "+", "3"}]}], "]"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"C12N3", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
    RowBox[{"StifN3", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", 
       RowBox[{"j", "+", "3"}]}], "]"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"C21N1", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
    RowBox[{"StifN1", "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"i", "+", "3"}], ",", "j"}], "]"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"C21N2", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
    RowBox[{"StifN2", "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"i", "+", "3"}], ",", "j"}], "]"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"C21N3", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
    RowBox[{"StifN3", "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"i", "+", "3"}], ",", "j"}], "]"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"C22N1", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
    RowBox[{"StifN1", "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"i", "+", "3"}], ",", 
       RowBox[{"j", "+", "3"}]}], "]"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"C22N2", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
    RowBox[{"StifN2", "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"i", "+", "3"}], ",", 
       RowBox[{"j", "+", "3"}]}], "]"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"C22N3", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
     RowBox[{"StifN3", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"i", "+", "3"}], ",", 
        RowBox[{"j", "+", "3"}]}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Modify", " ", 
     RowBox[{"C", "/", "S"}], " ", "stiffness", " ", "matrix", " ", "due", 
     " ", "to", " ", "tension"}], "-", 
    RowBox[{"twist", " ", "coupling"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Wrk31", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", "1"}], "]"}], "]"}], "=", 
    RowBox[{"RR0N1", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Wrk33", "=", 
   RowBox[{"Outer", "[", 
    RowBox[{"Times", ",", 
     RowBox[{"Flatten", "[", "Wrk31", "]"}], ",", 
     RowBox[{"Flatten", "[", "Wrk31", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"C12N1", "=", 
   RowBox[{"C12N1", "+", 
    RowBox[{"cet", "*", "k1sN1", "*", "Wrk33"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"C21N1", "=", 
   RowBox[{"C21N1", "+", 
    RowBox[{"cet", "*", "k1sN1", "*", "Wrk33"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"C22N1", "=", 
   RowBox[{"C22N1", "+", 
    RowBox[{"cet", "*", "e1sN1", "*", "Wrk33"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Wrk31", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", "1"}], "]"}], "]"}], "=", 
    RowBox[{"RR0N2", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Wrk33", "=", 
   RowBox[{"Outer", "[", 
    RowBox[{"Times", ",", 
     RowBox[{"Flatten", "[", "Wrk31", "]"}], ",", 
     RowBox[{"Flatten", "[", "Wrk31", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"C12N2", "=", 
   RowBox[{"C12N2", "+", 
    RowBox[{"cet", "*", "k1sN2", "*", "Wrk33"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"C21N2", "=", 
   RowBox[{"C21N2", "+", 
    RowBox[{"cet", "*", "k1sN2", "*", "Wrk33"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"C22N2", "=", 
   RowBox[{"C22N2", "+", 
    RowBox[{"cet", "*", "e1sN2", "*", "Wrk33"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Wrk31", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", "1"}], "]"}], "]"}], "=", 
    RowBox[{"RR0N3", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Wrk33", "=", 
   RowBox[{"Outer", "[", 
    RowBox[{"Times", ",", 
     RowBox[{"Flatten", "[", "Wrk31", "]"}], ",", 
     RowBox[{"Flatten", "[", "Wrk31", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"C12N3", "=", 
   RowBox[{"C12N3", "+", 
    RowBox[{"cet", "*", "k1sN3", "*", "Wrk33"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"C21N3", "=", 
   RowBox[{"C21N3", "+", 
    RowBox[{"cet", "*", "k1sN3", "*", "Wrk33"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"C22N3", "=", 
    RowBox[{"C22N3", "+", 
     RowBox[{"cet", "*", "e1sN3", "*", "Wrk33"}]}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Compute", " ", "Oe"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"epsiN1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "3"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"epsiN2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "3"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"epsiN3", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "3"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"muN1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "3"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"muN2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "3"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"muN3", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "3"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"epsiN1", "=", 
   RowBox[{"C11N1", ".", 
    RowBox[{"Tilde", "[", 
     RowBox[{
      RowBox[{"E1N1", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
      RowBox[{"E1N1", "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
      RowBox[{"E1N1", "[", 
       RowBox[{"[", 
        RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"epsiN2", "=", 
   RowBox[{"C11N2", ".", 
    RowBox[{"Tilde", "[", 
     RowBox[{
      RowBox[{"E1N2", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
      RowBox[{"E1N2", "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
      RowBox[{"E1N2", "[", 
       RowBox[{"[", 
        RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"epsiN3", "=", 
   RowBox[{"C11N3", ".", 
    RowBox[{"Tilde", "[", 
     RowBox[{
      RowBox[{"E1N3", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
      RowBox[{"E1N3", "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
      RowBox[{"E1N3", "[", 
       RowBox[{"[", 
        RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"muN1", "=", 
   RowBox[{"C21N1", ".", 
    RowBox[{"Tilde", "[", 
     RowBox[{
      RowBox[{"E1N1", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
      RowBox[{"E1N1", "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
      RowBox[{"E1N1", "[", 
       RowBox[{"[", 
        RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"muN2", "=", 
   RowBox[{"C21N2", ".", 
    RowBox[{"Tilde", "[", 
     RowBox[{
      RowBox[{"E1N2", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
      RowBox[{"E1N2", "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
      RowBox[{"E1N2", "[", 
       RowBox[{"[", 
        RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"muN3", "=", 
   RowBox[{"C21N3", ".", 
    RowBox[{"Tilde", "[", 
     RowBox[{
      RowBox[{"E1N3", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
      RowBox[{"E1N3", "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
      RowBox[{"E1N3", "[", 
       RowBox[{"[", 
        RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"OeN1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "6"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"OeN2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "6"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"OeN3", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "6"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"OeN1", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", 
        RowBox[{"j", "+", "3"}]}], "]"}], "]"}], "=", 
     RowBox[{
      RowBox[{"epsiN1", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j"}], "]"}], "]"}], "-", 
      RowBox[{
       RowBox[{"Tilde", "[", 
        RowBox[{
         RowBox[{"fffN1", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"fffN1", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"fffN1", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j"}], "]"}], "]"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "3"}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"OeN1", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"i", "+", "3"}], ",", 
        RowBox[{"j", "+", "3"}]}], "]"}], "]"}], "=", 
     RowBox[{
      RowBox[{"muN1", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j"}], "]"}], "]"}], "-", 
      RowBox[{
       RowBox[{"Tilde", "[", 
        RowBox[{
         RowBox[{"fffN1", "[", 
          RowBox[{"[", 
           RowBox[{"4", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"fffN1", "[", 
          RowBox[{"[", 
           RowBox[{"5", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"fffN1", "[", 
          RowBox[{"[", 
           RowBox[{"6", ",", "1"}], "]"}], "]"}]}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j"}], "]"}], "]"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "3"}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"OeN2", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", 
        RowBox[{"j", "+", "3"}]}], "]"}], "]"}], "=", 
     RowBox[{
      RowBox[{"epsiN2", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j"}], "]"}], "]"}], "-", 
      RowBox[{
       RowBox[{"Tilde", "[", 
        RowBox[{
         RowBox[{"fffN2", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"fffN2", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"fffN2", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j"}], "]"}], "]"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "3"}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"OeN2", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"i", "+", "3"}], ",", 
        RowBox[{"j", "+", "3"}]}], "]"}], "]"}], "=", 
     RowBox[{
      RowBox[{"muN2", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j"}], "]"}], "]"}], "-", 
      RowBox[{
       RowBox[{"Tilde", "[", 
        RowBox[{
         RowBox[{"fffN2", "[", 
          RowBox[{"[", 
           RowBox[{"4", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"fffN2", "[", 
          RowBox[{"[", 
           RowBox[{"5", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"fffN2", "[", 
          RowBox[{"[", 
           RowBox[{"6", ",", "1"}], "]"}], "]"}]}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j"}], "]"}], "]"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "3"}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"OeN3", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", 
        RowBox[{"j", "+", "3"}]}], "]"}], "]"}], "=", 
     RowBox[{
      RowBox[{"epsiN3", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j"}], "]"}], "]"}], "-", 
      RowBox[{
       RowBox[{"Tilde", "[", 
        RowBox[{
         RowBox[{"fffN3", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"fffN3", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"fffN3", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j"}], "]"}], "]"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "3"}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"OeN3", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"i", "+", "3"}], ",", 
         RowBox[{"j", "+", "3"}]}], "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{"muN3", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "j"}], "]"}], "]"}], "-", 
       RowBox[{
        RowBox[{"Tilde", "[", 
         RowBox[{
          RowBox[{"fffN3", "[", 
           RowBox[{"[", 
            RowBox[{"4", ",", "1"}], "]"}], "]"}], ",", 
          RowBox[{"fffN3", "[", 
           RowBox[{"[", 
            RowBox[{"5", ",", "1"}], "]"}], "]"}], ",", 
          RowBox[{"fffN3", "[", 
           RowBox[{"[", 
            RowBox[{"6", ",", "1"}], "]"}], "]"}]}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "j"}], "]"}], "]"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "3"}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Compute", " ", "Pe"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PeN1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "6"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PeN2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "6"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PeN3", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "6"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"PeN1", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"i", "+", "3"}], ",", "j"}], "]"}], "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Transpose", "[", "epsiN1", "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j"}], "]"}], "]"}], "+", 
      RowBox[{
       RowBox[{"Tilde", "[", 
        RowBox[{
         RowBox[{"fffN1", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"fffN1", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"fffN1", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j"}], "]"}], "]"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "3"}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"PeN1", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"i", "+", "3"}], ",", 
        RowBox[{"j", "+", "3"}]}], "]"}], "]"}], "=", 
     RowBox[{
      RowBox[{"Transpose", "[", "muN1", "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "3"}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"PeN2", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"i", "+", "3"}], ",", "j"}], "]"}], "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Transpose", "[", "epsiN2", "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j"}], "]"}], "]"}], "+", 
      RowBox[{
       RowBox[{"Tilde", "[", 
        RowBox[{
         RowBox[{"fffN2", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"fffN2", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"fffN2", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j"}], "]"}], "]"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "3"}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"PeN2", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"i", "+", "3"}], ",", 
        RowBox[{"j", "+", "3"}]}], "]"}], "]"}], "=", 
     RowBox[{
      RowBox[{"Transpose", "[", "muN2", "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "3"}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"PeN3", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"i", "+", "3"}], ",", "j"}], "]"}], "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Transpose", "[", "epsiN3", "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j"}], "]"}], "]"}], "+", 
      RowBox[{
       RowBox[{"Tilde", "[", 
        RowBox[{
         RowBox[{"fffN3", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"fffN3", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"fffN3", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j"}], "]"}], "]"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "3"}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PeN3", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"i", "+", "3"}], ",", 
         RowBox[{"j", "+", "3"}]}], "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{"Transpose", "[", "muN3", "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "3"}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Compute", " ", "Qe"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"QeN1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "6"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"QeN2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "6"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"QeN3", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "6"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tempO12", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "3"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"tempO12", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
     RowBox[{"OeN1", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", 
        RowBox[{"j", "+", "3"}]}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "3"}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"temp", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "3"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"temp", "=", 
   RowBox[{
    RowBox[{"Transpose", "[", 
     RowBox[{"Tilde", "[", 
      RowBox[{
       RowBox[{"E1N1", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"E1N1", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"E1N1", "[", 
        RowBox[{"[", 
         RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "]"}], "]"}], ".", 
    "tempO12"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"QeN1", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"i", "+", "3"}], ",", 
        RowBox[{"j", "+", "3"}]}], "]"}], "]"}], "=", 
     RowBox[{"temp", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "3"}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"tempO12", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
     RowBox[{"OeN2", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", 
        RowBox[{"j", "+", "3"}]}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "3"}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"temp", "=", 
   RowBox[{
    RowBox[{"Transpose", "[", 
     RowBox[{"Tilde", "[", 
      RowBox[{
       RowBox[{"E1N2", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"E1N2", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"E1N2", "[", 
        RowBox[{"[", 
         RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "]"}], "]"}], ".", 
    "tempO12"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"QeN2", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"i", "+", "3"}], ",", 
        RowBox[{"j", "+", "3"}]}], "]"}], "]"}], "=", 
     RowBox[{"temp", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "3"}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"tempO12", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
     RowBox[{"OeN3", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", 
        RowBox[{"j", "+", "3"}]}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "3"}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"temp", "=", 
   RowBox[{
    RowBox[{"Transpose", "[", 
     RowBox[{"Tilde", "[", 
      RowBox[{
       RowBox[{"E1N3", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"E1N3", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"E1N3", "[", 
        RowBox[{"[", 
         RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "]"}], "]"}], ".", 
    "tempO12"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"QeN3", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"i", "+", "3"}], ",", 
        RowBox[{"j", "+", "3"}]}], "]"}], "]"}], "=", 
     RowBox[{"temp", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "3"}], "}"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.587929320869298*^9, 3.587929351203936*^9}, {
  3.587929396050127*^9, 3.5879294326626453`*^9}, {3.5879294707822866`*^9, 
  3.587929578460314*^9}, {3.5879299716545763`*^9, 3.587929995436585*^9}, {
  3.587930091351926*^9, 3.587930107172978*^9}, {3.587930166594445*^9, 
  3.5879301697681704`*^9}, {3.587930530160406*^9, 3.5879305422730017`*^9}, {
  3.5879306165633717`*^9, 3.587930627711714*^9}, {3.58795664799866*^9, 
  3.587956873348321*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Check", " ", "Output"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"QeN1", "//", "MatrixForm"}]}]], "Input",
 CellChangeTimes->{{3.587930642306645*^9, 3.5879306577861423`*^9}, {
   3.587930715272203*^9, 3.587930725007863*^9}, {3.587995014700252*^9, 
   3.587995014912945*^9}, {3.5880018267032413`*^9, 3.588001832962028*^9}, {
   3.588002284755405*^9, 3.5880022850661583`*^9}, {3.588002456150976*^9, 
   3.5880024564110403`*^9}, {3.588002494188361*^9, 3.588002498072041*^9}, {
   3.588098273207406*^9, 3.588098275196954*^9}, {3.5880986527964*^9, 
   3.5880986570256977`*^9}, {3.588098776635257*^9, 3.588098802960738*^9}, {
   3.588098901289872*^9, 3.5880989335595083`*^9}, 3.5882888102037687`*^9, {
   3.590857734334244*^9, 3.590857748491251*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0.`", "0.`", "0.`"},
     {"0", "0", "0", "0.`", "1.09162`*^8", "0.`"},
     {"0", "0", "0", "0.`", "0.`", "1.09162`*^8"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.590857734794134*^9, 3.590857749044455*^9}, 
   3.590866095436784*^9}]
}, Open  ]]
}, Open  ]],

Cell["(*END Compute Elastic Forces: Fc, Fd, Oe, Pe, Qe*)", "Subsection",
 CellChangeTimes->{{3.587930854121129*^9, 3.5879308607551003`*^9}, 
   3.5879309052892113`*^9}],

Cell[CellGroupData[{

Cell["\<\
(*Rotate Mass Constants mEta0 and rho0*)\
\>", "Subsection",
 CellChangeTimes->{{3.59085470986687*^9, 3.590854760207468*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"tempR3", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "3"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mEtaN1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mEtaN2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mEtaN3", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rhoN1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "3"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rhoN2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "3"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rhoN3", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "3"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"tempR3", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
     RowBox[{"RR0N1", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mEtaN1", "=", 
   RowBox[{"tempR3", ".", "mEta0"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rhoN1", "=", 
   RowBox[{"tempR3", ".", "rho0", ".", 
    RowBox[{"Transpose", "[", "tempR3", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"tempR3", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
     RowBox[{"RR0N2", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mEtaN2", "=", 
   RowBox[{"tempR3", ".", "mEta0"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rhoN2", "=", 
   RowBox[{"tempR3", ".", "rho0", ".", 
    RowBox[{"Transpose", "[", "tempR3", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"tempR3", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
     RowBox[{"RR0N3", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mEtaN3", "=", 
   RowBox[{"tempR3", ".", "mEta0"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rhoN3", "=", 
   RowBox[{"tempR3", ".", "rho0", ".", 
    RowBox[{"Transpose", "[", "tempR3", "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.587908034268353*^9, 3.587908058171912*^9}, {
  3.587908088635612*^9, 3.587908175111252*^9}, {3.5879082252111998`*^9, 
  3.5879083891368017`*^9}, {3.587922103416482*^9, 3.5879221287435226`*^9}, {
  3.5908548413007812`*^9, 3.5908550406315193`*^9}}]
}, Open  ]],

Cell["\<\
(*END Rotate Mass Constants mEta0 and rho0*)\
\>", "Subsection",
 CellChangeTimes->{{3.5908551074121447`*^9, 3.59085512156304*^9}}],

Cell[CellGroupData[{

Cell["\<\
(*Compute Inertial Forces: Mi, Fi, Ki, Gi*)\
\>", "Subsection",
 CellChangeTimes->{{3.590854621414796*^9, 3.590854640915359*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"omeN1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"omeN2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"omeN3", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"omdN1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"omdN2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"omdN3", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tempVN1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tempVN2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tempVN3", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tempAN1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tempAN2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tempAN3", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"omeN1", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "1"}], "]"}], "]"}], "=", 
     RowBox[{"vvNf", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"i", "+", "3"}], ",", "1"}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "3"}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"omeN2", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "1"}], "]"}], "]"}], "=", 
     RowBox[{"vvNf", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"i", "+", "3", "+", "6"}], ",", "1"}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "3"}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"omeN3", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "1"}], "]"}], "]"}], "=", 
     RowBox[{"vvNf", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"i", "+", "3", "+", "12"}], ",", "1"}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "3"}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"omdN1", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "1"}], "]"}], "]"}], "=", 
     RowBox[{"aaNf", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"i", "+", "3"}], ",", "1"}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "3"}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"omdN2", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "1"}], "]"}], "]"}], "=", 
     RowBox[{"aaNf", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"i", "+", "3", "+", "6"}], ",", "1"}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "3"}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"omdN3", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "1"}], "]"}], "]"}], "=", 
     RowBox[{"aaNf", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"i", "+", "3", "+", "12"}], ",", "1"}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "3"}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"tempVN1", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "1"}], "]"}], "]"}], "=", 
     RowBox[{"vvNf", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "3"}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"tempVN2", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "1"}], "]"}], "]"}], "=", 
     RowBox[{"vvNf", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"i", "+", "6"}], ",", "1"}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "3"}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"tempVN3", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "1"}], "]"}], "]"}], "=", 
     RowBox[{"vvNf", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"i", "+", "12"}], ",", "1"}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "3"}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"tempAN1", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "1"}], "]"}], "]"}], "=", 
     RowBox[{"aaNf", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "3"}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"tempAN2", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "1"}], "]"}], "]"}], "=", 
     RowBox[{"aaNf", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"i", "+", "6"}], ",", "1"}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "3"}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"tempAN3", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "1"}], "]"}], "]"}], "=", 
     RowBox[{"aaNf", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"i", "+", "12"}], ",", "1"}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "3"}], "}"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.5908656647573137`*^9, 3.590866002484248*^9}, {
  3.590866217626129*^9, 3.59086629594396*^9}, {3.5908663562831097`*^9, 
  3.59086635881288*^9}, {3.5908663933812027`*^9, 3.590866476944598*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FiN1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"beta", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gama", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nu", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"beta", "=", 
   RowBox[{
    RowBox[{"Tilde", "[", 
     RowBox[{
      RowBox[{"omeN1", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
      RowBox[{"omeN1", "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
      RowBox[{"omeN1", "[", 
       RowBox[{"[", 
        RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "]"}], ".", "mEtaN1"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gama", "=", 
   RowBox[{"rhoN1", ".", "omeN1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nu", "=", 
   RowBox[{"rhoN1", ".", "omdN1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"temp3", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"temp3", "=", 
   RowBox[{
    RowBox[{"m00", "*", "tempAN1"}], "+", 
    RowBox[{
     RowBox[{"Tilde", "[", 
      RowBox[{
       RowBox[{"omdN1", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"omdN1", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"omdN1", "[", 
        RowBox[{"[", 
         RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "]"}], ".", "mEtaN1"}], "+", 
    RowBox[{
     RowBox[{"Tilde", "[", 
      RowBox[{
       RowBox[{"omeN1", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"omeN1", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"omeN1", "[", 
        RowBox[{"[", 
         RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "]"}], ".", "beta"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"FiN1", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "1"}], "]"}], "]"}], "=", 
     RowBox[{"temp3", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "3"}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"temp3", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"temp3", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Tilde", "[", 
      RowBox[{
       RowBox[{"mEtaN1", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"mEtaN1", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"mEtaN1", "[", 
        RowBox[{"[", 
         RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "]"}], ".", "tempAN1"}], 
    "+", "nu", "+", 
    RowBox[{
     RowBox[{"Tilde", "[", 
      RowBox[{
       RowBox[{"omeN1", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"omeN1", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"omeN1", "[", 
        RowBox[{"[", 
         RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "]"}], ".", "gama"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"FiN1", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"i", "+", "3"}], ",", "1"}], "]"}], "]"}], "=", 
     RowBox[{"temp3", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "3"}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FiN2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"beta", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gama", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nu", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"beta", "=", 
   RowBox[{
    RowBox[{"Tilde", "[", 
     RowBox[{
      RowBox[{"omeN2", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
      RowBox[{"omeN2", "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
      RowBox[{"omeN2", "[", 
       RowBox[{"[", 
        RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "]"}], ".", "mEtaN2"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gama", "=", 
   RowBox[{"rhoN2", ".", "omeN2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nu", "=", 
   RowBox[{"rhoN2", ".", "omdN2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"temp3", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"temp3", "=", 
   RowBox[{
    RowBox[{"m00", "*", "tempAN2"}], "+", 
    RowBox[{
     RowBox[{"Tilde", "[", 
      RowBox[{
       RowBox[{"omdN2", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"omdN2", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"omdN2", "[", 
        RowBox[{"[", 
         RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "]"}], ".", "mEtaN2"}], "+", 
    RowBox[{
     RowBox[{"Tilde", "[", 
      RowBox[{
       RowBox[{"omeN2", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"omeN2", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"omeN2", "[", 
        RowBox[{"[", 
         RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "]"}], ".", "beta"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"FiN2", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "1"}], "]"}], "]"}], "=", 
     RowBox[{"temp3", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "3"}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"temp3", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"temp3", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Tilde", "[", 
      RowBox[{
       RowBox[{"mEtaN2", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"mEtaN2", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"mEtaN2", "[", 
        RowBox[{"[", 
         RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "]"}], ".", "tempAN2"}], 
    "+", "nu", "+", 
    RowBox[{
     RowBox[{"Tilde", "[", 
      RowBox[{
       RowBox[{"omeN2", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"omeN2", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"omeN2", "[", 
        RowBox[{"[", 
         RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "]"}], ".", "gama"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"FiN2", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"i", "+", "3"}], ",", "1"}], "]"}], "]"}], "=", 
     RowBox[{"temp3", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "3"}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FiN3", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"beta", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gama", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nu", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"beta", "=", 
   RowBox[{
    RowBox[{"Tilde", "[", 
     RowBox[{
      RowBox[{"omeN3", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
      RowBox[{"omeN3", "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
      RowBox[{"omeN3", "[", 
       RowBox[{"[", 
        RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "]"}], ".", "mEtaN3"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gama", "=", 
   RowBox[{"rhoN3", ".", "omeN3"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nu", "=", 
   RowBox[{"rhoN3", ".", "omdN3"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"temp3", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"temp3", "=", 
   RowBox[{
    RowBox[{"m00", "*", "tempAN3"}], "+", 
    RowBox[{
     RowBox[{"Tilde", "[", 
      RowBox[{
       RowBox[{"omdN3", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"omdN3", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"omdN3", "[", 
        RowBox[{"[", 
         RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "]"}], ".", "mEtaN3"}], "+", 
    RowBox[{
     RowBox[{"Tilde", "[", 
      RowBox[{
       RowBox[{"omeN3", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"omeN3", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"omeN3", "[", 
        RowBox[{"[", 
         RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "]"}], ".", "beta"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"FiN3", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "1"}], "]"}], "]"}], "=", 
     RowBox[{"temp3", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "3"}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"temp3", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"temp3", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Tilde", "[", 
      RowBox[{
       RowBox[{"mEtaN3", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"mEtaN3", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"mEtaN3", "[", 
        RowBox[{"[", 
         RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "]"}], ".", "tempAN3"}], 
    "+", "nu", "+", 
    RowBox[{
     RowBox[{"Tilde", "[", 
      RowBox[{
       RowBox[{"omeN3", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"omeN3", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"omeN3", "[", 
        RowBox[{"[", 
         RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "]"}], ".", "gama"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"FiN3", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"i", "+", "3"}], ",", "1"}], "]"}], "]"}], "=", 
     RowBox[{"temp3", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "3"}], "}"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.590866480272992*^9, 3.590866791308674*^9}, {
  3.5908669028927927`*^9, 3.590867010838739*^9}, {3.590867041208591*^9, 
  3.590867049600483*^9}, {3.590867127292302*^9, 3.590867532551229*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["(*Compute Elemental Matrices: elk,elf*)", "Subsection",
 CellChangeTimes->{{3.587945678551869*^9, 3.5879456827472963`*^9}, {
  3.587945748339109*^9, 3.587945757998966*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"elk", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "18"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "18"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.587945764965375*^9, 3.5879458139177856`*^9}, {
  3.5880326090372057`*^9, 3.5880326100305*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"temp66", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "6"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"temp66", "=", 
   RowBox[{
    RowBox[{"wj", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "1"}], "]"}], "]"}], "*", "Jaco", "*", "QeN1"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"elk", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
     RowBox[{
      RowBox[{"elk", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j"}], "]"}], "]"}], "+", 
      RowBox[{"temp66", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j"}], "]"}], "]"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "6"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "6"}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"temp66", "=", 
   RowBox[{
    RowBox[{"wj", "[", 
     RowBox[{"[", 
      RowBox[{"2", ",", "1"}], "]"}], "]"}], "*", "Jaco", "*", "QeN2"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"elk", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"i", "+", "6"}], ",", 
        RowBox[{"j", "+", "6"}]}], "]"}], "]"}], "=", 
     RowBox[{
      RowBox[{"elk", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"i", "+", "6"}], ",", 
         RowBox[{"j", "+", "6"}]}], "]"}], "]"}], "+", 
      RowBox[{"temp66", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j"}], "]"}], "]"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "6"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "6"}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"temp66", "=", 
   RowBox[{
    RowBox[{"wj", "[", 
     RowBox[{"[", 
      RowBox[{"3", ",", "1"}], "]"}], "]"}], "*", "Jaco", "*", "QeN3"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"elk", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"i", "+", "12"}], ",", 
        RowBox[{"j", "+", "12"}]}], "]"}], "]"}], "=", 
     RowBox[{
      RowBox[{"elk", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"i", "+", "12"}], ",", 
         RowBox[{"j", "+", "12"}]}], "]"}], "]"}], "+", 
      RowBox[{"temp66", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j"}], "]"}], "]"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "6"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "6"}], "}"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.587945838925054*^9, 3.587945902664487*^9}, {
  3.5879461810639067`*^9, 3.587946444589766*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "\[LessEqual]", "6"}], ",", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"j", "=", "1"}], ",", 
        RowBox[{"j", "\[LessEqual]", "3"}], ",", 
        RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"k", "=", "1"}], ",", 
            RowBox[{"k", "\[LessEqual]", "6"}], ",", 
            RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"elk", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"j", "-", "1"}], ")"}], "*", "6"}], "+", "k"}]}], 
                 "]"}], "]"}], "=", 
               RowBox[{
                RowBox[{"elk", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"j", "-", "1"}], ")"}], "*", "6"}], "+", "k"}]}], 
                  "]"}], "]"}], "+", 
                RowBox[{
                 RowBox[{"wj", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", "1"}], "]"}], "]"}], "*", 
                 RowBox[{"PeN1", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "k"}], "]"}], "]"}], "*", 
                 RowBox[{"hhp", "[", 
                  RowBox[{"[", 
                   RowBox[{"j", ",", "1"}], "]"}], "]"}]}]}]}], ";"}], 
             "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", "}"}]}], "]"}], 
      ";"}], "\[IndentingNewLine]", "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "7"}], ",", 
    RowBox[{"i", "\[LessEqual]", "12"}], ",", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"j", "=", "1"}], ",", 
        RowBox[{"j", "\[LessEqual]", "3"}], ",", 
        RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"k", "=", "1"}], ",", 
            RowBox[{"k", "\[LessEqual]", "6"}], ",", 
            RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"elk", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"j", "-", "1"}], ")"}], "*", "6"}], "+", "k"}]}], 
                 "]"}], "]"}], "=", 
               RowBox[{
                RowBox[{"elk", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"j", "-", "1"}], ")"}], "*", "6"}], "+", "k"}]}], 
                  "]"}], "]"}], "+", 
                RowBox[{
                 RowBox[{"wj", "[", 
                  RowBox[{"[", 
                   RowBox[{"2", ",", "1"}], "]"}], "]"}], "*", 
                 RowBox[{"PeN2", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"i", "-", "6"}], ",", "k"}], "]"}], "]"}], "*", 
                 RowBox[{"hhp", "[", 
                  RowBox[{"[", 
                   RowBox[{"j", ",", "2"}], "]"}], "]"}]}]}]}], ";"}], 
             "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", "}"}]}], "]"}], 
      ";"}], "\[IndentingNewLine]", "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "13"}], ",", 
    RowBox[{"i", "\[LessEqual]", "18"}], ",", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"j", "=", "1"}], ",", 
        RowBox[{"j", "\[LessEqual]", "3"}], ",", 
        RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"k", "=", "1"}], ",", 
            RowBox[{"k", "\[LessEqual]", "6"}], ",", 
            RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"elk", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"j", "-", "1"}], ")"}], "*", "6"}], "+", "k"}]}], 
                 "]"}], "]"}], "=", 
               RowBox[{
                RowBox[{"elk", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"j", "-", "1"}], ")"}], "*", "6"}], "+", "k"}]}], 
                  "]"}], "]"}], "+", 
                RowBox[{
                 RowBox[{"wj", "[", 
                  RowBox[{"[", 
                   RowBox[{"3", ",", "1"}], "]"}], "]"}], "*", 
                 RowBox[{"PeN3", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"i", "-", "12"}], ",", "k"}], "]"}], "]"}], "*", 
                 RowBox[{"hhp", "[", 
                  RowBox[{"[", 
                   RowBox[{"j", ",", "3"}], "]"}], "]"}]}]}]}], ";"}], 
             "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", "}"}]}], "]"}], 
      ";"}], "\[IndentingNewLine]", "}"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.5879469824169817`*^9, 3.587946986295197*^9}, {
  3.5879473248471537`*^9, 3.587947349083579*^9}, {3.587947413494095*^9, 
  3.5879474547025547`*^9}, {3.5879474867823277`*^9, 3.5879476525518436`*^9}, {
  3.5879476983275127`*^9, 3.587947698784689*^9}, {3.58794773684647*^9, 
  3.5879477682084837`*^9}, {3.587953132635401*^9, 3.587953160814477*^9}, {
  3.58795376728957*^9, 3.587953864392796*^9}, {3.587953895295532*^9, 
  3.587954006798662*^9}, {3.587955382211265*^9, 3.5879554293337727`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "\[LessEqual]", "6"}], ",", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"j", "=", "1"}], ",", 
        RowBox[{"j", "\[LessEqual]", "3"}], ",", 
        RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"k", "=", "1"}], ",", 
            RowBox[{"k", "\[LessEqual]", "6"}], ",", 
            RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"elk", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"j", "-", "1"}], ")"}], "*", "6"}], "+", "k"}], 
                  ",", "i"}], "]"}], "]"}], "=", 
               RowBox[{
                RowBox[{"elk", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"j", "-", "1"}], ")"}], "*", "6"}], "+", "k"}], 
                   ",", "i"}], "]"}], "]"}], "+", 
                RowBox[{
                 RowBox[{"wj", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", "1"}], "]"}], "]"}], "*", 
                 RowBox[{"OeN1", "[", 
                  RowBox[{"[", 
                   RowBox[{"k", ",", "i"}], "]"}], "]"}], "*", 
                 RowBox[{"hhp", "[", 
                  RowBox[{"[", 
                   RowBox[{"j", ",", "1"}], "]"}], "]"}]}]}]}], ";"}], 
             "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", "}"}]}], "]"}], 
      ";"}], "\[IndentingNewLine]", "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "7"}], ",", 
    RowBox[{"i", "\[LessEqual]", "12"}], ",", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"j", "=", "1"}], ",", 
        RowBox[{"j", "\[LessEqual]", "3"}], ",", 
        RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"k", "=", "1"}], ",", 
            RowBox[{"k", "\[LessEqual]", "6"}], ",", 
            RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"elk", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"j", "-", "1"}], ")"}], "*", "6"}], "+", "k"}], 
                  ",", "i"}], "]"}], "]"}], "=", 
               RowBox[{
                RowBox[{"elk", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"j", "-", "1"}], ")"}], "*", "6"}], "+", "k"}], 
                   ",", "i"}], "]"}], "]"}], "+", 
                RowBox[{
                 RowBox[{"wj", "[", 
                  RowBox[{"[", 
                   RowBox[{"2", ",", "1"}], "]"}], "]"}], "*", 
                 RowBox[{"OeN2", "[", 
                  RowBox[{"[", 
                   RowBox[{"k", ",", 
                    RowBox[{"i", "-", "6"}]}], "]"}], "]"}], "*", 
                 RowBox[{"hhp", "[", 
                  RowBox[{"[", 
                   RowBox[{"j", ",", "2"}], "]"}], "]"}]}]}]}], ";"}], 
             "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", "}"}]}], "]"}], 
      ";"}], "\[IndentingNewLine]", "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "13"}], ",", 
    RowBox[{"i", "\[LessEqual]", "18"}], ",", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"j", "=", "1"}], ",", 
        RowBox[{"j", "\[LessEqual]", "3"}], ",", 
        RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"k", "=", "1"}], ",", 
            RowBox[{"k", "\[LessEqual]", "6"}], ",", 
            RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"elk", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"j", "-", "1"}], ")"}], "*", "6"}], "+", "k"}], 
                  ",", "i"}], "]"}], "]"}], "=", 
               RowBox[{
                RowBox[{"elk", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"j", "-", "1"}], ")"}], "*", "6"}], "+", "k"}], 
                   ",", "i"}], "]"}], "]"}], "+", 
                RowBox[{
                 RowBox[{"wj", "[", 
                  RowBox[{"[", 
                   RowBox[{"3", ",", "1"}], "]"}], "]"}], "*", 
                 RowBox[{"OeN3", "[", 
                  RowBox[{"[", 
                   RowBox[{"k", ",", 
                    RowBox[{"i", "-", "12"}]}], "]"}], "]"}], "*", 
                 RowBox[{"hhp", "[", 
                  RowBox[{"[", 
                   RowBox[{"j", ",", "3"}], "]"}], "]"}]}]}]}], ";"}], 
             "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", "}"}]}], "]"}], 
      ";"}], "\[IndentingNewLine]", "}"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.587954356962047*^9, 3.5879543700669193`*^9}, {
  3.587954414141038*^9, 3.587954414451758*^9}, {3.5879544573390207`*^9, 
  3.587954459137031*^9}, {3.587954614436022*^9, 3.587954701219331*^9}, {
  3.5879554362702436`*^9, 3.58795543962208*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "\[LessEqual]", "3"}], ",", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"j", "=", "1"}], ",", 
        RowBox[{"j", "\[LessEqual]", "3"}], ",", 
        RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"k", "=", "1"}], ",", 
            RowBox[{"k", "\[LessEqual]", "6"}], ",", 
            RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"m", "=", "1"}], ",", 
                RowBox[{"m", "\[LessEqual]", "6"}], ",", 
                RowBox[{"m", "++"}], ",", "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"elk", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"i", "-", "1"}], ")"}], "*", "6"}], "+", "k"}], 
                    ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"j", "-", "1"}], ")"}], "*", "6"}], "+", "m"}]}], 
                    "]"}], "]"}], "=", 
                   RowBox[{
                    RowBox[{"elk", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"i", "-", "1"}], ")"}], "*", "6"}], "+", "k"}], 
                    ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"j", "-", "1"}], ")"}], "*", "6"}], "+", "m"}]}], 
                    "]"}], "]"}], "+", 
                    RowBox[{
                    RowBox[{"wj", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], "*", 
                    RowBox[{"hhp", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}], "*", 
                    RowBox[{"StifN1", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "m"}], "]"}], "]"}], "*", 
                    RowBox[{
                    RowBox[{"hhp", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "1"}], "]"}], "]"}], "/", "Jaco"}]}], 
                    "+", 
                    RowBox[{
                    RowBox[{"wj", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}], "*", 
                    RowBox[{"hhp", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], "*", 
                    RowBox[{"StifN2", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "m"}], "]"}], "]"}], "*", 
                    RowBox[{
                    RowBox[{"hhp", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "2"}], "]"}], "]"}], "/", "Jaco"}]}], 
                    "+", 
                    RowBox[{
                    RowBox[{"wj", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", "1"}], "]"}], "]"}], "*", 
                    RowBox[{"hhp", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "3"}], "]"}], "]"}], "*", 
                    RowBox[{"StifN3", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "m"}], "]"}], "]"}], "*", 
                    RowBox[{
                    RowBox[{"hhp", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "3"}], "]"}], "]"}], "/", 
                    "Jaco"}]}]}]}], ";"}], "\[IndentingNewLine]", "}"}]}], 
               "]"}], ";"}], "\[IndentingNewLine]", "}"}]}], "]"}], ";"}], 
         "\[IndentingNewLine]", "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
     "}"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.587955575440631*^9, 3.587955643583229*^9}, {
  3.587955676574108*^9, 3.5879558351905613`*^9}, {3.5879558706569767`*^9, 
  3.587956115668538*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Check", " ", "Output", " ", "elk"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"elk", "//", "MatrixForm"}], ";"}]}]], "Input",
 CellChangeTimes->{{3.587956130925693*^9, 3.587956143249234*^9}, 
   3.588291170400877*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Compute", " ", "RHS", " ", "Force", " ", "Vector", " ", "elf"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"elf", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "18"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"temp61", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "6"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"temp61", "=", 
     RowBox[{
      RowBox[{"wj", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}], "*", "Jaco", "*", "FdN1"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"elf", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "1"}], "]"}], "]"}], "=", 
       RowBox[{
        RowBox[{"elf", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "1"}], "]"}], "]"}], "+", 
        RowBox[{"temp61", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "1"}], "]"}], "]"}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "6"}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"temp61", "=", 
     RowBox[{
      RowBox[{"wj", "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "1"}], "]"}], "]"}], "*", "Jaco", "*", "FdN2"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"elf", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"i", "+", "6"}], ",", "1"}], "]"}], "]"}], "=", 
       RowBox[{
        RowBox[{"elf", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"i", "+", "6"}], ",", "1"}], "]"}], "]"}], "+", 
        RowBox[{"temp61", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "1"}], "]"}], "]"}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "6"}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"temp61", "=", 
     RowBox[{
      RowBox[{"wj", "[", 
       RowBox[{"[", 
        RowBox[{"3", ",", "1"}], "]"}], "]"}], "*", "Jaco", "*", "FdN3"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"elf", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"i", "+", "12"}], ",", "1"}], "]"}], "]"}], "=", 
       RowBox[{
        RowBox[{"elf", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"i", "+", "12"}], ",", "1"}], "]"}], "]"}], "+", 
        RowBox[{"temp61", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "1"}], "]"}], "]"}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "6"}], "}"}]}], "]"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.588030868412489*^9, 3.58803088295326*^9}, {
   3.588031054262599*^9, 3.588031065510819*^9}, 3.588031108890665*^9, {
   3.588031155993059*^9, 3.5880313159574757`*^9}, {3.588032616823866*^9, 
   3.58803261736913*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "\[LessEqual]", "6"}], ",", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"elf", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "1"}], "]"}], "]"}], "=", 
       RowBox[{
        RowBox[{"elf", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "1"}], "]"}], "]"}], "+", 
        RowBox[{
         RowBox[{"wj", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], "*", 
         RowBox[{"hhp", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], "*", 
         RowBox[{"FcN1", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "1"}], "]"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"wj", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "1"}], "]"}], "]"}], "*", 
         RowBox[{"hhp", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "2"}], "]"}], "]"}], "*", 
         RowBox[{"FcN2", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "1"}], "]"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"wj", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "1"}], "]"}], "]"}], "*", 
         RowBox[{"hhp", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "3"}], "]"}], "]"}], "*", 
         RowBox[{"FcN3", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "1"}], "]"}], "]"}]}]}]}], "}"}], ";"}]}], "]"}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "7"}], ",", 
    RowBox[{"i", "\[LessEqual]", "12"}], ",", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"elf", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "1"}], "]"}], "]"}], "=", 
       RowBox[{
        RowBox[{"elf", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "1"}], "]"}], "]"}], "+", 
        RowBox[{
         RowBox[{"wj", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], "*", 
         RowBox[{"hhp", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "1"}], "]"}], "]"}], "*", 
         RowBox[{"FcN1", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"i", "-", "6"}], ",", "1"}], "]"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"wj", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "1"}], "]"}], "]"}], "*", 
         RowBox[{"hhp", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "2"}], "]"}], "]"}], "*", 
         RowBox[{"FcN2", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"i", "-", "6"}], ",", "1"}], "]"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"wj", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "1"}], "]"}], "]"}], "*", 
         RowBox[{"hhp", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "3"}], "]"}], "]"}], "*", 
         RowBox[{"FcN3", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"i", "-", "6"}], ",", "1"}], "]"}], "]"}]}]}]}], "}"}], 
     ";"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "13"}], ",", 
    RowBox[{"i", "\[LessEqual]", "18"}], ",", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"elf", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "1"}], "]"}], "]"}], "=", 
       RowBox[{
        RowBox[{"elf", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "1"}], "]"}], "]"}], "+", 
        RowBox[{
         RowBox[{"wj", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], "*", 
         RowBox[{"hhp", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "1"}], "]"}], "]"}], "*", 
         RowBox[{"FcN1", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"i", "-", "12"}], ",", "1"}], "]"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"wj", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "1"}], "]"}], "]"}], "*", 
         RowBox[{"hhp", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "2"}], "]"}], "]"}], "*", 
         RowBox[{"FcN2", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"i", "-", "12"}], ",", "1"}], "]"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"wj", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "1"}], "]"}], "]"}], "*", 
         RowBox[{"hhp", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "3"}], "]"}], "]"}], "*", 
         RowBox[{"FcN3", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"i", "-", "12"}], ",", "1"}], "]"}], "]"}]}]}]}], "}"}], 
     ";"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"elf", "=", 
   RowBox[{"-", "elf"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.5880313624990673`*^9, 3.588031380207995*^9}, {
  3.588031418127784*^9, 3.588031597352096*^9}, {3.588031632293249*^9, 
  3.588031665448867*^9}, {3.5880317454121523`*^9, 3.588031902605197*^9}, {
  3.588033410369708*^9, 3.588033415564231*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"temp61", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "1"}], "]"}], "]"}], "=", 
      RowBox[{"Fext", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "6"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
   RowBox[{"temp61", "=", 
    RowBox[{
     RowBox[{"wj", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}], "*", "Jaco", "*", "temp61"}]}], 
   ";", "\[IndentingNewLine]", 
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"elf", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "1"}], "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{"elf", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "1"}], "]"}], "]"}], "+", 
       RowBox[{"temp61", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "1"}], "]"}], "]"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "6"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"temp61", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "1"}], "]"}], "]"}], "=", 
      RowBox[{"Fext", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"i", "+", "6"}], ",", "1"}], "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "6"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
   RowBox[{"temp61", "=", 
    RowBox[{
     RowBox[{"wj", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "1"}], "]"}], "]"}], "*", "Jaco", "*", "temp61"}]}], 
   ";", "\[IndentingNewLine]", 
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"elf", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"i", "+", "6"}], ",", "1"}], "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{"elf", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"i", "+", "6"}], ",", "1"}], "]"}], "]"}], "+", 
       RowBox[{"temp61", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "1"}], "]"}], "]"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "6"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"temp61", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "1"}], "]"}], "]"}], "=", 
      RowBox[{"Fext", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"i", "+", "12"}], ",", "1"}], "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "6"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
   RowBox[{"temp61", "=", 
    RowBox[{
     RowBox[{"wj", "[", 
      RowBox[{"[", 
       RowBox[{"3", ",", "1"}], "]"}], "]"}], "*", "Jaco", "*", "temp61"}]}], 
   ";", "\[IndentingNewLine]", 
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"elf", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"i", "+", "12"}], ",", "1"}], "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{"elf", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"i", "+", "12"}], ",", "1"}], "]"}], "]"}], "+", 
       RowBox[{"temp61", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "1"}], "]"}], "]"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "6"}], "}"}]}], "]"}], ";"}], "*)"}]], "Input",
 CellChangeTimes->{{3.588032187132986*^9, 3.5880324093818197`*^9}, {
  3.588212000596034*^9, 3.588212003517642*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"elf", "//", "MatrixForm"}], ";"}]], "Input",
 CellChangeTimes->{{3.588032420631913*^9, 3.588032424227192*^9}, 
   3.588291179644392*^9}]
}, Open  ]],

Cell["(*END Compute Elemental Matrices: elk,elf*)", "Subsection",
 CellChangeTimes->{{3.58803419482736*^9, 3.588034235833897*^9}}],

Cell[CellGroupData[{

Cell["(* Solve Linear System *)", "Subsection",
 CellChangeTimes->{{3.5880342481027184`*^9, 3.588034258847475*^9}}],

Cell[CellGroupData[{

Cell["Include BC condition into elk, elf", "Subsubsection",
 CellChangeTimes->{{3.588034268795136*^9, 3.588034281554613*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "\[LessEqual]", "6"}], ",", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"j", "=", "1"}], ",", 
       RowBox[{"j", "\[LessEqual]", "18"}], ",", 
       RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"elk", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", "0"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "\[LessEqual]", "18"}], ",", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"j", "=", "1"}], ",", 
       RowBox[{"j", "\[LessEqual]", "6"}], ",", 
       RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"elk", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", "0"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "\[LessEqual]", "6"}], ",", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"elk", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "i"}], "]"}], "]"}], "=", "1"}], ";"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"elk", "//", "MatrixForm"}], ";"}]}], "Input",
 CellChangeTimes->{{3.588034300659892*^9, 3.5880343567790213`*^9}, 
   3.5882911853621073`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "\[LessEqual]", "6"}], ",", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"elf", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "1"}], "]"}], "]"}], "=", "0.0"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"elf", "=", 
   RowBox[{"elf", "+", "Fext"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"elf", "//", "MatrixForm"}], ";"}]}], "Input",
 CellChangeTimes->{{3.588034404192913*^9, 3.588034413161859*^9}, {
   3.588212017661673*^9, 3.588212074043458*^9}, 3.588291187911639*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Solve elk.x=elf", "Subsubsection",
 CellChangeTimes->{{3.588034464541416*^9, 3.58803447330228*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ui", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "18"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ui", "=", 
   RowBox[{
    RowBox[{"Inverse", "[", "elk", "]"}], ".", "elf"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ui", "//", "MatrixForm"}], ";"}]}], "Input",
 CellChangeTimes->{{3.588034482854357*^9, 3.588034492718092*^9}, {
   3.588034645671698*^9, 3.588034702503128*^9}, 3.588291212337872*^9}]
}, Open  ]]
}, Open  ]],

Cell["(*END Solve Linear System*)", "Subsection",
 CellChangeTimes->{{3.588172152146029*^9, 3.588172162871367*^9}}],

Cell[CellGroupData[{

Cell["(* Update Configuration*)", "Subsection",
 CellChangeTimes->{{3.588172165951775*^9, 3.588172179559247*^9}}],

Cell[CellGroupData[{

Cell["Update Nodal Displacement", "Subsubsection",
 CellChangeTimes->{{3.588172184856985*^9, 3.58817219479946*^9}, {
  3.588172379780287*^9, 3.5881723805792503`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "\[LessEqual]", "3"}], ",", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"j", "=", "1"}], ",", 
        RowBox[{"j", "\[LessEqual]", "3"}], ",", 
        RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"uuNf", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"i", "-", "1"}], ")"}], "*", "6"}], "+", "j"}], ",", 
              "1"}], "]"}], "]"}], "=", 
           RowBox[{"ui", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"i", "-", "1"}], ")"}], "*", "6"}], "+", "j"}], ",", 
              "1"}], "]"}], "]"}]}], ";"}], "}"}]}], "]"}], ";"}], 
     "\[IndentingNewLine]", "}"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.5881722085444202`*^9, 3.588172359786334*^9}, {
  3.5882912190325537`*^9, 3.588291222249773*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Update Nodal Rotation", "Subsubsection",
 CellChangeTimes->{{3.588172369329556*^9, 3.588172383914003*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"temp31", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "\[LessEqual]", "3"}], ",", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"temp31", "=", 
       RowBox[{"CrvCompose0", "[", 
        RowBox[{
         RowBox[{"ui", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"i", "-", "1"}], ")"}], "*", "6"}], "+", "4"}], ",", 
            "1"}], "]"}], "]"}], ",", 
         RowBox[{"ui", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"i", "-", "1"}], ")"}], "*", "6"}], "+", "5"}], ",", 
            "1"}], "]"}], "]"}], ",", 
         RowBox[{"ui", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"i", "-", "1"}], ")"}], "*", "6"}], "+", "6"}], ",", 
            "1"}], "]"}], "]"}], ",", 
         RowBox[{"uuNf", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"i", "-", "1"}], ")"}], "*", "6"}], "+", "4"}], ",", 
            "1"}], "]"}], "]"}], ",", 
         RowBox[{"uuNf", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"i", "-", "1"}], ")"}], "*", "6"}], "+", "5"}], ",", 
            "1"}], "]"}], "]"}], ",", 
         RowBox[{"uuNf", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"i", "-", "1"}], ")"}], "*", "6"}], "+", "6"}], ",", 
            "1"}], "]"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"j", "=", "1"}], ",", 
        RowBox[{"j", "\[LessEqual]", "3"}], ",", 
        RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"uuNf", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"i", "-", "1"}], ")"}], "*", "6"}], "+", "3", "+", 
               "j"}], ",", "1"}], "]"}], "]"}], "=", 
           RowBox[{"temp31", "[", 
            RowBox[{"[", 
             RowBox[{"j", ",", "1"}], "]"}], "]"}]}], ";"}], "}"}]}], 
       "\[IndentingNewLine]", "]"}], ";"}], "}"}]}], "\[IndentingNewLine]", 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"uuNf", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.588172453219942*^9, 3.588172852176779*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Second Iteration", "Section",
 CellChangeTimes->{{3.587754189766006*^9, 3.587754202213131*^9}, {
  3.588212261814355*^9, 3.5882122702167187`*^9}}],

Cell["(*Compute Nodal Values: E1, RR0, Stif, cet, kapa*)", "Subsection",
 CellChangeTimes->{{3.5879204531678267`*^9, 3.5879204713047037`*^9}, {
  3.587922060812168*^9, 3.5879220622813997`*^9}}],

Cell[CellGroupData[{

Cell["Compute E10", "Subsection",
 CellChangeTimes->{{3.587754206339679*^9, 3.587754218302059*^9}, {
  3.587833514565754*^9, 3.58783351566555*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"E10N1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"E10N1", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "1"}], "]"}], "]"}], "=", 
    RowBox[{
     RowBox[{"E10N1", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}], "+", 
     RowBox[{
      RowBox[{"hhp", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "1"}], "]"}], "]"}], "*", 
      RowBox[{"uuN0", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"i", "-", "1"}], ")"}], "*", "6"}], "+", "1"}], ",", 
         "1"}], "]"}], "]"}]}]}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"E10N1", "[", 
     RowBox[{"[", 
      RowBox[{"2", ",", "1"}], "]"}], "]"}], "=", 
    RowBox[{
     RowBox[{"E10N1", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "1"}], "]"}], "]"}], "+", 
     RowBox[{
      RowBox[{"hhp", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "1"}], "]"}], "]"}], "*", 
      RowBox[{"uuN0", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"i", "-", "1"}], ")"}], "*", "6"}], "+", "2"}], ",", 
         "1"}], "]"}], "]"}]}]}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"E10N1", "[", 
     RowBox[{"[", 
      RowBox[{"3", ",", "1"}], "]"}], "]"}], "=", 
    RowBox[{
     RowBox[{"E10N1", "[", 
      RowBox[{"[", 
       RowBox[{"3", ",", "1"}], "]"}], "]"}], "+", 
     RowBox[{
      RowBox[{"hhp", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "1"}], "]"}], "]"}], "*", 
      RowBox[{"uuN0", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"i", "-", "1"}], ")"}], "*", "6"}], "+", "3"}], ",", 
         "1"}], "]"}], "]"}]}]}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"E10N2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"E10N2", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "1"}], "]"}], "]"}], "=", 
    RowBox[{
     RowBox[{"E10N2", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}], "+", 
     RowBox[{
      RowBox[{"hhp", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "2"}], "]"}], "]"}], "*", 
      RowBox[{"uuN0", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"i", "-", "1"}], ")"}], "*", "6"}], "+", "1"}], ",", 
         "1"}], "]"}], "]"}]}]}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"E10N2", "[", 
     RowBox[{"[", 
      RowBox[{"2", ",", "1"}], "]"}], "]"}], "=", 
    RowBox[{
     RowBox[{"E10N2", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "1"}], "]"}], "]"}], "+", 
     RowBox[{
      RowBox[{"hhp", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "2"}], "]"}], "]"}], "*", 
      RowBox[{"uuN0", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"i", "-", "1"}], ")"}], "*", "6"}], "+", "2"}], ",", 
         "1"}], "]"}], "]"}]}]}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"E10N2", "[", 
     RowBox[{"[", 
      RowBox[{"3", ",", "1"}], "]"}], "]"}], "=", 
    RowBox[{
     RowBox[{"E10N2", "[", 
      RowBox[{"[", 
       RowBox[{"3", ",", "1"}], "]"}], "]"}], "+", 
     RowBox[{
      RowBox[{"hhp", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "2"}], "]"}], "]"}], "*", 
      RowBox[{"uuN0", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"i", "-", "1"}], ")"}], "*", "6"}], "+", "3"}], ",", 
         "1"}], "]"}], "]"}]}]}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"E10N3", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"E10N3", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "1"}], "]"}], "]"}], "=", 
    RowBox[{
     RowBox[{"E10N3", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}], "+", 
     RowBox[{
      RowBox[{"hhp", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "3"}], "]"}], "]"}], "*", 
      RowBox[{"uuN0", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"i", "-", "1"}], ")"}], "*", "6"}], "+", "1"}], ",", 
         "1"}], "]"}], "]"}]}]}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"E10N3", "[", 
     RowBox[{"[", 
      RowBox[{"2", ",", "1"}], "]"}], "]"}], "=", 
    RowBox[{
     RowBox[{"E10N3", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "1"}], "]"}], "]"}], "+", 
     RowBox[{
      RowBox[{"hhp", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "3"}], "]"}], "]"}], "*", 
      RowBox[{"uuN0", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"i", "-", "1"}], ")"}], "*", "6"}], "+", "2"}], ",", 
         "1"}], "]"}], "]"}]}]}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"E10N3", "[", 
     RowBox[{"[", 
      RowBox[{"3", ",", "1"}], "]"}], "]"}], "=", 
    RowBox[{
     RowBox[{"E10N3", "[", 
      RowBox[{"[", 
       RowBox[{"3", ",", "1"}], "]"}], "]"}], "+", 
     RowBox[{
      RowBox[{"hhp", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "3"}], "]"}], "]"}], "*", 
      RowBox[{"uuN0", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"i", "-", "1"}], ")"}], "*", "6"}], "+", "3"}], ",", 
         "1"}], "]"}], "]"}]}]}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"E10N1", "=", 
   RowBox[{"E10N1", "/", "Jaco"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"E10N2", "=", 
   RowBox[{"E10N2", "/", "Jaco"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"E10N3", "=", 
   RowBox[{"E10N3", "/", "Jaco"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"E10N1", "//", "MatrixForm"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"E10N2", "//", "MatrixForm"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"E10N3", "//", "MatrixForm"}], ";"}]}], "Input",
 CellChangeTimes->{{3.58775422609374*^9, 3.587754398368726*^9}, {
  3.58775448274543*^9, 3.587754533076005*^9}, {3.587754582059051*^9, 
  3.587754635294845*^9}, {3.587833439517671*^9, 3.587833440703767*^9}, {
  3.587836890752481*^9, 3.587836899879169*^9}, {3.5879117005512943`*^9, 
  3.5879118154179993`*^9}, {3.587918533453866*^9, 3.587918622963627*^9}, {
  3.5880411868086*^9, 3.58804121775948*^9}, {3.5880412910752068`*^9, 
  3.5880412962205772`*^9}, {3.58821229538065*^9, 3.5882123298884697`*^9}, {
  3.5882912552555447`*^9, 3.588291256951083*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Compute E1", "Subsection",
 CellChangeTimes->{{3.587817010434211*^9, 3.587817014391336*^9}, {
  3.587833520311347*^9, 3.587833522365748*^9}, {3.587907571964334*^9, 
  3.587907581277869*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"E1N1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"E1N1", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "1"}], "]"}], "]"}], "=", 
    RowBox[{
     RowBox[{"E1N1", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}], "+", 
     RowBox[{
      RowBox[{"hhp", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "1"}], "]"}], "]"}], "*", 
      RowBox[{"uuNf", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"i", "-", "1"}], ")"}], "*", "6"}], "+", "1"}], ",", 
         "1"}], "]"}], "]"}]}]}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"E1N1", "[", 
     RowBox[{"[", 
      RowBox[{"2", ",", "1"}], "]"}], "]"}], "=", 
    RowBox[{
     RowBox[{"E1N1", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "1"}], "]"}], "]"}], "+", 
     RowBox[{
      RowBox[{"hhp", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "1"}], "]"}], "]"}], "*", 
      RowBox[{"uuNf", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"i", "-", "1"}], ")"}], "*", "6"}], "+", "2"}], ",", 
         "1"}], "]"}], "]"}]}]}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"E1N1", "[", 
     RowBox[{"[", 
      RowBox[{"3", ",", "1"}], "]"}], "]"}], "=", 
    RowBox[{
     RowBox[{"E1N1", "[", 
      RowBox[{"[", 
       RowBox[{"3", ",", "1"}], "]"}], "]"}], "+", 
     RowBox[{
      RowBox[{"hhp", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "1"}], "]"}], "]"}], "*", 
      RowBox[{"uuNf", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"i", "-", "1"}], ")"}], "*", "6"}], "+", "3"}], ",", 
         "1"}], "]"}], "]"}]}]}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"E1N1", "=", 
   RowBox[{
    RowBox[{"E1N1", "/", "Jaco"}], "+", "E10N1"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"E1N2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"E1N2", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "1"}], "]"}], "]"}], "=", 
    RowBox[{
     RowBox[{"E1N2", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}], "+", 
     RowBox[{
      RowBox[{"hhp", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "2"}], "]"}], "]"}], "*", 
      RowBox[{"uuNf", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"i", "-", "1"}], ")"}], "*", "6"}], "+", "1"}], ",", 
         "1"}], "]"}], "]"}]}]}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"E1N2", "[", 
     RowBox[{"[", 
      RowBox[{"2", ",", "1"}], "]"}], "]"}], "=", 
    RowBox[{
     RowBox[{"E1N2", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "1"}], "]"}], "]"}], "+", 
     RowBox[{
      RowBox[{"hhp", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "2"}], "]"}], "]"}], "*", 
      RowBox[{"uuNf", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"i", "-", "1"}], ")"}], "*", "6"}], "+", "2"}], ",", 
         "1"}], "]"}], "]"}]}]}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"E1N2", "[", 
     RowBox[{"[", 
      RowBox[{"3", ",", "1"}], "]"}], "]"}], "=", 
    RowBox[{
     RowBox[{"E1N2", "[", 
      RowBox[{"[", 
       RowBox[{"3", ",", "1"}], "]"}], "]"}], "+", 
     RowBox[{
      RowBox[{"hhp", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "2"}], "]"}], "]"}], "*", 
      RowBox[{"uuNf", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"i", "-", "1"}], ")"}], "*", "6"}], "+", "3"}], ",", 
         "1"}], "]"}], "]"}]}]}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"E1N2", "=", 
   RowBox[{
    RowBox[{"E1N2", "/", "Jaco"}], "+", "E10N2"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"E1N3", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"E1N3", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "1"}], "]"}], "]"}], "=", 
    RowBox[{
     RowBox[{"E1N3", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}], "+", 
     RowBox[{
      RowBox[{"hhp", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "3"}], "]"}], "]"}], "*", 
      RowBox[{"uuNf", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"i", "-", "1"}], ")"}], "*", "6"}], "+", "1"}], ",", 
         "1"}], "]"}], "]"}]}]}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"E1N3", "[", 
     RowBox[{"[", 
      RowBox[{"2", ",", "1"}], "]"}], "]"}], "=", 
    RowBox[{
     RowBox[{"E1N3", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "1"}], "]"}], "]"}], "+", 
     RowBox[{
      RowBox[{"hhp", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "3"}], "]"}], "]"}], "*", 
      RowBox[{"uuNf", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"i", "-", "1"}], ")"}], "*", "6"}], "+", "2"}], ",", 
         "1"}], "]"}], "]"}]}]}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"E1N3", "[", 
     RowBox[{"[", 
      RowBox[{"3", ",", "1"}], "]"}], "]"}], "=", 
    RowBox[{
     RowBox[{"E1N3", "[", 
      RowBox[{"[", 
       RowBox[{"3", ",", "1"}], "]"}], "]"}], "+", 
     RowBox[{
      RowBox[{"hhp", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "3"}], "]"}], "]"}], "*", 
      RowBox[{"uuNf", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"i", "-", "1"}], ")"}], "*", "6"}], "+", "3"}], ",", 
         "1"}], "]"}], "]"}]}]}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"E1N3", "=", 
   RowBox[{
    RowBox[{"E1N3", "/", "Jaco"}], "+", "E10N3"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"E1N1", "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{"E1N2", "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"E1N3", "//", "MatrixForm"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.58775422609374*^9, 3.587754398368726*^9}, {
  3.58775448274543*^9, 3.587754533076005*^9}, {3.587754582059051*^9, 
  3.587754635294845*^9}, {3.587817045064726*^9, 3.587817124864449*^9}, {
  3.5878334877572803`*^9, 3.5878334885764103`*^9}, {3.587836909925946*^9, 
  3.587836912640258*^9}, {3.587918649660986*^9, 3.58791880264116*^9}, {
  3.58804122939441*^9, 3.5880412421910057`*^9}, {3.5880413015857553`*^9, 
  3.588041306214417*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Interpolate", " ", "E1", " ", "to", " ", "Gauss", " ", "Points", " ", 
     "at"}], " ", "+", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"Sqrt", "[", "3", "]"}]}], "/", "3"}], " ", "to", " ", 
     "compare", " ", "with", " ", "Dymore"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"E1v3GL", "[", "s_", "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"hh1", "[", "s", "]"}], "*", 
       RowBox[{"E1N1", "[", 
        RowBox[{"[", 
         RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"hh2", "[", "s", "]"}], "*", 
       RowBox[{"E1N2", "[", 
        RowBox[{"[", 
         RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"hh3", "[", "s", "]"}], "*", 
       RowBox[{"E1N3", "[", 
        RowBox[{"[", 
         RowBox[{"3", ",", "1"}], "]"}], "]"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"E1v3GL", "[", "GL1", "]"}], "\[IndentingNewLine]", 
   RowBox[{"E1v3GL", "[", "GL2", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.5882914726193247`*^9, 3.588291726588669*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Compute RR0", "Subsection",
 CellChangeTimes->{{3.5878175759194517`*^9, 3.587817584177951*^9}}],

Cell[CellGroupData[{

Cell["Compose ccc and cc0", "Subsubsection",
 CellChangeTimes->{{3.587833553703298*^9, 3.58783355818044*^9}, {
  3.587833625365438*^9, 3.587833628130508*^9}}],

Cell[BoxData[{
 RowBox[{"ccN1", "=", 
  RowBox[{"CrvCompose0", "[", 
   RowBox[{
    RowBox[{"uuNf", "[", 
     RowBox[{"[", 
      RowBox[{"4", ",", "1"}], "]"}], "]"}], ",", 
    RowBox[{"uuNf", "[", 
     RowBox[{"[", 
      RowBox[{"5", ",", "1"}], "]"}], "]"}], ",", 
    RowBox[{"uuNf", "[", 
     RowBox[{"[", 
      RowBox[{"6", ",", "1"}], "]"}], "]"}], ",", 
    RowBox[{"uuN0", "[", 
     RowBox[{"[", 
      RowBox[{"4", ",", "1"}], "]"}], "]"}], ",", 
    RowBox[{"uuN0", "[", 
     RowBox[{"[", 
      RowBox[{"5", ",", "1"}], "]"}], "]"}], ",", 
    RowBox[{"uuN0", "[", 
     RowBox[{"[", 
      RowBox[{"6", ",", "1"}], "]"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"ccN2", "=", 
  RowBox[{"CrvCompose0", "[", 
   RowBox[{
    RowBox[{"uuNf", "[", 
     RowBox[{"[", 
      RowBox[{"10", ",", "1"}], "]"}], "]"}], ",", 
    RowBox[{"uuNf", "[", 
     RowBox[{"[", 
      RowBox[{"11", ",", "1"}], "]"}], "]"}], ",", 
    RowBox[{"uuNf", "[", 
     RowBox[{"[", 
      RowBox[{"12", ",", "1"}], "]"}], "]"}], ",", 
    RowBox[{"uuN0", "[", 
     RowBox[{"[", 
      RowBox[{"10", ",", "1"}], "]"}], "]"}], ",", 
    RowBox[{"uuN0", "[", 
     RowBox[{"[", 
      RowBox[{"11", ",", "1"}], "]"}], "]"}], ",", 
    RowBox[{"uuN0", "[", 
     RowBox[{"[", 
      RowBox[{"12", ",", "1"}], "]"}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"ccN3", "=", 
  RowBox[{"CrvCompose0", "[", 
   RowBox[{
    RowBox[{"uuNf", "[", 
     RowBox[{"[", 
      RowBox[{"16", ",", "1"}], "]"}], "]"}], ",", 
    RowBox[{"uuNf", "[", 
     RowBox[{"[", 
      RowBox[{"17", ",", "1"}], "]"}], "]"}], ",", 
    RowBox[{"uuNf", "[", 
     RowBox[{"[", 
      RowBox[{"18", ",", "1"}], "]"}], "]"}], ",", 
    RowBox[{"uuN0", "[", 
     RowBox[{"[", 
      RowBox[{"16", ",", "1"}], "]"}], "]"}], ",", 
    RowBox[{"uuN0", "[", 
     RowBox[{"[", 
      RowBox[{"17", ",", "1"}], "]"}], "]"}], ",", 
    RowBox[{"uuN0", "[", 
     RowBox[{"[", 
      RowBox[{"18", ",", "1"}], "]"}], "]"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.5878351422118397`*^9, 3.587835231122501*^9}, {
  3.587835322485483*^9, 3.587835325641467*^9}, {3.587835359906851*^9, 
  3.587835441141786*^9}, {3.5879190490628643`*^9, 3.587919062942588*^9}, {
  3.588214467326396*^9, 3.588214469933873*^9}, {3.588293439388591*^9, 
  3.588293475965782*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Interpolate", " ", "E1", " ", "to", " ", "Gauss", " ", "Points", " ", 
     "at"}], " ", "+", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"Sqrt", "[", "3", "]"}]}], "/", "3"}], " ", "to", " ", 
     "compare", " ", "with", " ", "Dymore"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"ccv2GL", "[", "s_", "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"hh1", "[", "s", "]"}], "*", 
       RowBox[{"ccN1", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"hh2", "[", "s", "]"}], "*", 
       RowBox[{"ccN2", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"hh3", "[", "s", "]"}], "*", 
       RowBox[{"ccN3", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "1"}], "]"}], "]"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"ccv2GL", "[", "GL1", "]"}], "\[IndentingNewLine]", 
   RowBox[{"ccv2GL", "[", "GL2", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.5882934903411922`*^9, 3.5882935255197573`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Compute CRV Matrix R", "Subsubsection",
 CellChangeTimes->{{3.587835548562796*^9, 3.587835581040512*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"RR0N1", "=", 
   RowBox[{"CrvMatrixR", "[", 
    RowBox[{
     RowBox[{"ccN1", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{"ccN1", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{"ccN1", "[", 
      RowBox[{"[", 
       RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RR0N2", "=", 
   RowBox[{"CrvMatrixR", "[", 
    RowBox[{
     RowBox[{"ccN2", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{"ccN2", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{"ccN2", "[", 
      RowBox[{"[", 
       RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RR0N3", "=", 
   RowBox[{"CrvMatrixR", "[", 
    RowBox[{
     RowBox[{"ccN3", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{"ccN3", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{"ccN3", "[", 
      RowBox[{"[", 
       RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"RR0N1", "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{"RR0N2", "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{"RR0N3", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.587836512756153*^9, 3.587836560415715*^9}, {
  3.587836628758173*^9, 3.587836638001161*^9}, {3.587836793732723*^9, 
  3.587836826774221*^9}, {3.587836930771825*^9, 3.587836934376195*^9}, {
  3.5879190772783813`*^9, 3.587919141551895*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Rotate C/S Stiffness Matrix", "Subsection",
 CellChangeTimes->{{3.587907596252862*^9, 3.587907599059901*^9}, {
  3.587907629276826*^9, 3.5879076477567787`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"tempR6", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "6"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"StifN1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "6"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"StifN2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "6"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"StifN3", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "6"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"tempR6", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
     RowBox[{"RR0N1", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"tempR6", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"i", "+", "3"}], ",", 
        RowBox[{"j", "+", "3"}]}], "]"}], "]"}], "=", 
     RowBox[{"RR0N1", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"StifN1", "=", 
   RowBox[{"tempR6", ".", "Stif0", ".", 
    RowBox[{"Transpose", "[", "tempR6", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"tempR6", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
     RowBox[{"RR0N2", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"tempR6", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"i", "+", "3"}], ",", 
        RowBox[{"j", "+", "3"}]}], "]"}], "]"}], "=", 
     RowBox[{"RR0N2", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"StifN2", "=", 
   RowBox[{"tempR6", ".", "Stif0", ".", 
    RowBox[{"Transpose", "[", "tempR6", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"tempR6", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
     RowBox[{"RR0N3", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"tempR6", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"i", "+", "3"}], ",", 
        RowBox[{"j", "+", "3"}]}], "]"}], "]"}], "=", 
     RowBox[{"RR0N3", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"StifN3", "=", 
   RowBox[{"tempR6", ".", "Stif0", ".", 
    RowBox[{"Transpose", "[", "tempR6", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cet", "=", 
   RowBox[{
    RowBox[{"Stif0", "[", 
     RowBox[{"[", 
      RowBox[{"5", ",", "5"}], "]"}], "]"}], "+", 
    RowBox[{"Stif0", "[", 
     RowBox[{"[", 
      RowBox[{"6", ",", "6"}], "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"StifN1", "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{"StifN2", "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{"StifN3", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.587908034268353*^9, 3.587908058171912*^9}, {
  3.587908088635612*^9, 3.587908175111252*^9}, {3.5879082252111998`*^9, 
  3.5879083891368017`*^9}, {3.587922103416482*^9, 3.5879221287435226`*^9}, {
  3.588216067961424*^9, 3.58821608630972*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Compute Relative Rotation", "Subsection",
 CellChangeTimes->{{3.587904277398987*^9, 3.587904282114883*^9}}],

Cell[CellGroupData[{

Cell["Compute Relative Rotation", "Subsubsection",
 CellChangeTimes->{{3.587904504014819*^9, 3.587904508868449*^9}, 
   3.587918519668853*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Nuuutemp1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Nuuutemp2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Nuuutemp3", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Nrrr", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "9"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Nuuutemp1", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "1"}], "]"}], "]"}], "=", 
     RowBox[{"uuNf", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "1"}], ")"}], "*", "6"}], "+", "3", "+", "i"}], 
        ",", "1"}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "3"}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Nuuutemp2", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "1"}], "]"}], "]"}], "=", 
     RowBox[{"uuNf", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"2", "-", "1"}], ")"}], "*", "6"}], "+", "3", "+", "i"}], 
        ",", "1"}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "3"}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Nuuutemp3", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "1"}], "]"}], "]"}], "=", 
     RowBox[{"uuNf", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"3", "-", "1"}], ")"}], "*", "6"}], "+", "3", "+", "i"}], 
        ",", "1"}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "3"}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Nrrrtemp1", "=", 
   RowBox[{"CrvCompose1", "[", 
    RowBox[{
     RowBox[{"Nuuutemp1", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{"Nuuutemp1", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{"Nuuutemp1", "[", 
      RowBox[{"[", 
       RowBox[{"3", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{"Nuuutemp1", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{"Nuuutemp1", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{"Nuuutemp1", "[", 
      RowBox[{"[", 
       RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Nrrrtemp2", "=", 
   RowBox[{"CrvCompose1", "[", 
    RowBox[{
     RowBox[{"Nuuutemp1", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{"Nuuutemp1", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{"Nuuutemp1", "[", 
      RowBox[{"[", 
       RowBox[{"3", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{"Nuuutemp2", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{"Nuuutemp2", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{"Nuuutemp2", "[", 
      RowBox[{"[", 
       RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Nrrrtemp3", "=", 
   RowBox[{"CrvCompose1", "[", 
    RowBox[{
     RowBox[{"Nuuutemp1", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{"Nuuutemp1", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{"Nuuutemp1", "[", 
      RowBox[{"[", 
       RowBox[{"3", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{"Nuuutemp3", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{"Nuuutemp3", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{"Nuuutemp3", "[", 
      RowBox[{"[", 
       RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Nrrr", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "1"}], "]"}], "]"}], "=", 
     RowBox[{"Nrrrtemp1", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "3"}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Nrrr", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"3", "+", "i"}], ",", "1"}], "]"}], "]"}], "=", 
     RowBox[{"Nrrrtemp2", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "3"}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Nrrr", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"6", "+", "i"}], ",", "1"}], "]"}], "]"}], "=", 
     RowBox[{"Nrrrtemp3", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "3"}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Nrrr", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.587904533971443*^9, 3.5879045391809196`*^9}, {
   3.5879045699430437`*^9, 3.587904609739019*^9}, {3.587904644373497*^9, 
   3.587904674235034*^9}, {3.587906040035295*^9, 3.587906174650429*^9}, {
   3.587906207314035*^9, 3.587906657572687*^9}, {3.587906689051874*^9, 
   3.587906880979817*^9}, 3.587918519671279*^9, {3.5879191964397697`*^9, 
   3.587919232004583*^9}, {3.5879192635091867`*^9, 3.587919268370551*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Compute kapa", "Subsection",
 CellChangeTimes->{{3.587908410938456*^9, 3.587908414399622*^9}}],

Cell[CellGroupData[{

Cell["Compute Relative H", "Subsubsection",
 CellChangeTimes->{{3.587919985159912*^9, 3.587919990613364*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"tempHN1", " ", "=", " ", 
   RowBox[{"CrvMatrixH", "[", 
    RowBox[{
     RowBox[{"Nrrr", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", " ", 
     RowBox[{"Nrrr", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", " ", "\n", "    ", 
     RowBox[{"Nrrr", "[", 
      RowBox[{"[", 
       RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"tempHN2", " ", "=", " ", 
   RowBox[{"CrvMatrixH", "[", 
    RowBox[{
     RowBox[{"Nrrr", "[", 
      RowBox[{"[", 
       RowBox[{"4", ",", "1"}], "]"}], "]"}], ",", " ", 
     RowBox[{"Nrrr", "[", 
      RowBox[{"[", 
       RowBox[{"5", ",", "1"}], "]"}], "]"}], ",", " ", "\n", "    ", 
     RowBox[{"Nrrr", "[", 
      RowBox[{"[", 
       RowBox[{"6", ",", "1"}], "]"}], "]"}]}], "]"}]}], " ", ";"}], "\n", 
 RowBox[{
  RowBox[{"tempHN3", " ", "=", " ", 
   RowBox[{"CrvMatrixH", "[", 
    RowBox[{
     RowBox[{"Nrrr", "[", 
      RowBox[{"[", 
       RowBox[{"7", ",", "1"}], "]"}], "]"}], ",", " ", 
     RowBox[{"Nrrr", "[", 
      RowBox[{"[", 
       RowBox[{"8", ",", "1"}], "]"}], "]"}], ",", " ", "\n", "    ", 
     RowBox[{"Nrrr", "[", 
      RowBox[{"[", 
       RowBox[{"9", ",", "1"}], "]"}], "]"}]}], "]"}]}], " ", ";"}]}], "Input",\

 CellChangeTimes->{{3.5882938278988333`*^9, 3.588293833624609*^9}, {
  3.588293966327643*^9, 3.5882939677424107`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Compute Derivative of Relative Rotation", "Subsubsection",
 CellChangeTimes->{3.5879200143650312`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"rrpN1", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", " ", 
     RowBox[{"{", 
      RowBox[{"i", ",", " ", "1", ",", " ", "3"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"j", ",", " ", "1"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"rrpN1", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", " ", "1"}], "]"}], "]"}], " ", "=", " ", 
    RowBox[{
     RowBox[{"rrpN1", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", " ", "1"}], "]"}], "]"}], " ", "+", " ", 
     RowBox[{
      RowBox[{"hhp", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", " ", "1"}], "]"}], "]"}], "*", 
      RowBox[{"Nrrr", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"i", " ", "-", " ", "1"}], ")"}], "*", "3"}], " ", "+", 
          " ", "1"}], ",", " ", "1"}], "]"}], "]"}]}]}]}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"i", ",", " ", "3"}], "}"}]}], "]"}], "\n", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"rrpN1", "[", 
     RowBox[{"[", 
      RowBox[{"2", ",", " ", "1"}], "]"}], "]"}], " ", "=", " ", 
    RowBox[{
     RowBox[{"rrpN1", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", " ", "1"}], "]"}], "]"}], " ", "+", " ", 
     RowBox[{
      RowBox[{"hhp", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", " ", "1"}], "]"}], "]"}], "*", 
      RowBox[{"Nrrr", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"i", " ", "-", " ", "1"}], ")"}], "*", "3"}], " ", "+", 
          " ", "2"}], ",", " ", "1"}], "]"}], "]"}]}]}]}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"i", ",", " ", "3"}], "}"}]}], "]"}], "\n", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"rrpN1", "[", 
     RowBox[{"[", 
      RowBox[{"3", ",", " ", "1"}], "]"}], "]"}], " ", "=", " ", 
    RowBox[{
     RowBox[{"rrpN1", "[", 
      RowBox[{"[", 
       RowBox[{"3", ",", " ", "1"}], "]"}], "]"}], " ", "+", " ", 
     RowBox[{
      RowBox[{"hhp", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", " ", "1"}], "]"}], "]"}], "*", 
      RowBox[{"Nrrr", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"i", " ", "-", " ", "1"}], ")"}], "*", "3"}], " ", "+", 
          " ", "3"}], ",", " ", "1"}], "]"}], "]"}]}]}]}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"i", ",", " ", "3"}], "}"}]}], "]"}], "\n", 
 RowBox[{
  RowBox[{"rrpN2", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", " ", 
     RowBox[{"{", 
      RowBox[{"i", ",", " ", "1", ",", " ", "3"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"j", ",", " ", "1"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"rrpN2", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", " ", "1"}], "]"}], "]"}], " ", "=", " ", 
    RowBox[{
     RowBox[{"rrpN2", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", " ", "1"}], "]"}], "]"}], " ", "+", " ", 
     RowBox[{
      RowBox[{"hhp", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", " ", "2"}], "]"}], "]"}], "*", 
      RowBox[{"Nrrr", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"i", " ", "-", " ", "1"}], ")"}], "*", "3"}], " ", "+", 
          " ", "1"}], ",", " ", "1"}], "]"}], "]"}]}]}]}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"i", ",", " ", "3"}], "}"}]}], "]"}], "\n", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"rrpN2", "[", 
     RowBox[{"[", 
      RowBox[{"2", ",", " ", "1"}], "]"}], "]"}], " ", "=", " ", 
    RowBox[{
     RowBox[{"rrpN2", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", " ", "1"}], "]"}], "]"}], " ", "+", " ", 
     RowBox[{
      RowBox[{"hhp", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", " ", "2"}], "]"}], "]"}], "*", 
      RowBox[{"Nrrr", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"i", " ", "-", " ", "1"}], ")"}], "*", "3"}], " ", "+", 
          " ", "2"}], ",", " ", "1"}], "]"}], "]"}]}]}]}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"i", ",", " ", "3"}], "}"}]}], "]"}], "\n", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"rrpN2", "[", 
     RowBox[{"[", 
      RowBox[{"3", ",", " ", "1"}], "]"}], "]"}], " ", "=", " ", 
    RowBox[{
     RowBox[{"rrpN2", "[", 
      RowBox[{"[", 
       RowBox[{"3", ",", " ", "1"}], "]"}], "]"}], " ", "+", " ", 
     RowBox[{
      RowBox[{"hhp", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", " ", "2"}], "]"}], "]"}], "*", 
      RowBox[{"Nrrr", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"i", " ", "-", " ", "1"}], ")"}], "*", "3"}], " ", "+", 
          " ", "3"}], ",", " ", "1"}], "]"}], "]"}]}]}]}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"i", ",", " ", "3"}], "}"}]}], "]"}], "\n", 
 RowBox[{
  RowBox[{"rrpN3", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", " ", 
     RowBox[{"{", 
      RowBox[{"i", ",", " ", "1", ",", " ", "3"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"j", ",", " ", "1"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"rrpN3", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", " ", "1"}], "]"}], "]"}], " ", "=", " ", 
    RowBox[{
     RowBox[{"rrpN3", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", " ", "1"}], "]"}], "]"}], " ", "+", " ", 
     RowBox[{
      RowBox[{"hhp", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", " ", "3"}], "]"}], "]"}], "*", 
      RowBox[{"Nrrr", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"i", " ", "-", " ", "1"}], ")"}], "*", "3"}], " ", "+", 
          " ", "1"}], ",", " ", "1"}], "]"}], "]"}]}]}]}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"i", ",", " ", "3"}], "}"}]}], "]"}], "\n", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"rrpN3", "[", 
     RowBox[{"[", 
      RowBox[{"2", ",", " ", "1"}], "]"}], "]"}], " ", "=", " ", 
    RowBox[{
     RowBox[{"rrpN3", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", " ", "1"}], "]"}], "]"}], " ", "+", " ", 
     RowBox[{
      RowBox[{"hhp", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", " ", "3"}], "]"}], "]"}], "*", 
      RowBox[{"Nrrr", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"i", " ", "-", " ", "1"}], ")"}], "*", "3"}], " ", "+", 
          " ", "2"}], ",", " ", "1"}], "]"}], "]"}]}]}]}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"i", ",", " ", "3"}], "}"}]}], "]"}], "\n", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"rrpN3", "[", 
     RowBox[{"[", 
      RowBox[{"3", ",", " ", "1"}], "]"}], "]"}], " ", "=", " ", 
    RowBox[{
     RowBox[{"rrpN3", "[", 
      RowBox[{"[", 
       RowBox[{"3", ",", " ", "1"}], "]"}], "]"}], " ", "+", " ", 
     RowBox[{
      RowBox[{"hhp", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", " ", "3"}], "]"}], "]"}], "*", 
      RowBox[{"Nrrr", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"i", " ", "-", " ", "1"}], ")"}], "*", "3"}], " ", "+", 
          " ", "3"}], ",", " ", "1"}], "]"}], "]"}]}]}]}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"i", ",", " ", "3"}], "}"}]}], "]"}], "\n", 
 RowBox[{
  RowBox[{"rrpN1", "=", 
   RowBox[{"rrpN1", "/", "Jaco"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rrpN2", "=", 
   RowBox[{"rrpN2", "/", "Jaco"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rrpN3", "=", 
   RowBox[{"rrpN3", "/", "Jaco"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"rrpN1", " ", "//", " ", "MatrixForm"}], "\n", 
 RowBox[{"rrpN2", " ", "//", " ", "MatrixForm"}], "\n", 
 RowBox[{"rrpN3", " ", "//", " ", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.587920023121694*^9, 3.587920023123228*^9}, {
  3.588041332193749*^9, 3.588041349045936*^9}, {3.5882939877869787`*^9, 
  3.588293989417725*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Interpolate", " ", "E1", " ", "to", " ", "Gauss", " ", "Points", " ", 
     "at"}], " ", "+", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"Sqrt", "[", "3", "]"}]}], "/", "3"}], " ", "to", " ", 
     "compare", " ", "with", " ", "Dymore"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"rrpv2GL", "[", "s_", "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"hh1", "[", "s", "]"}], "*", 
       RowBox[{"rrpN1", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"hh2", "[", "s", "]"}], "*", 
       RowBox[{"rrpN2", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"hh3", "[", "s", "]"}], "*", 
       RowBox[{"rrpN3", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "1"}], "]"}], "]"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"rrpv2GL", "[", "GL1", "]"}], "\[IndentingNewLine]", 
   RowBox[{"rrpv2GL", "[", "GL2", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.588294058634149*^9, 3.5882940654723663`*^9}, {
  3.588294821520587*^9, 3.5882948375907393`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Compute temp cc", "Subsubsection",
 CellChangeTimes->{{3.587920036032868*^9, 3.5879200390369797`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"tempccN1", " ", "=", " ", 
   RowBox[{"tempHN1", ".", "rrpN1"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"tempccN2", " ", "=", " ", 
   RowBox[{"tempHN2", ".", "rrpN2"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"tempccN3", " ", "=", " ", 
   RowBox[{"tempHN2", ".", "rrpN3"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.587920045421794*^9, 3.58792004542385*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Compute Crv Matrix R with c at Node 1", "Subsubsection",
 CellChangeTimes->{{3.587920050713484*^9, 3.5879200599866447`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"tempRN1", " ", "=", " ", 
   RowBox[{"CrvMatrixR", "[", 
    RowBox[{
     RowBox[{"uuNf", "[", 
      RowBox[{"[", 
       RowBox[{"4", ",", " ", "1"}], "]"}], "]"}], ",", " ", 
     RowBox[{"uuNf", "[", 
      RowBox[{"[", 
       RowBox[{"5", ",", " ", "1"}], "]"}], "]"}], ",", " ", 
     RowBox[{"uuNf", "[", 
      RowBox[{"[", 
       RowBox[{"6", ",", " ", "1"}], "]"}], "]"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"tempRN1", " ", "//", " ", "MatrixForm"}], ";"}]}], "Input",
 CellChangeTimes->{{3.587920067330834*^9, 3.587920067332903*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Compute kapa", "Subsubsection",
 CellChangeTimes->{{3.587920073069566*^9, 3.587920075371022*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"kapaN1", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", " ", 
     RowBox[{"{", 
      RowBox[{"i", ",", " ", "1", ",", " ", "3"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"j", ",", " ", "1"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"kapaN1", " ", "=", " ", 
   RowBox[{"tempRN1", ".", "tempccN1"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"kapaN2", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", " ", 
     RowBox[{"{", 
      RowBox[{"i", ",", " ", "1", ",", " ", "3"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"j", ",", " ", "1"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"kapaN2", " ", "=", " ", 
   RowBox[{"tempRN1", ".", "tempccN2"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"kapaN3", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", " ", 
     RowBox[{"{", 
      RowBox[{"i", ",", " ", "1", ",", " ", "3"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"j", ",", " ", "1"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"kapaN3", " ", "=", " ", 
   RowBox[{"tempRN1", ".", "tempccN3"}]}], ";"}], "\n", 
 RowBox[{"kapaN1", " ", "//", " ", "MatrixForm"}], "\n", 
 RowBox[{"kapaN2", " ", "//", " ", "MatrixForm"}], "\n", 
 RowBox[{"kapaN3", " ", "//", " ", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.587920084334147*^9, 3.587920084335631*^9}, 
   3.5879203634776707`*^9, 3.587920402420949*^9, {3.5882956741850147`*^9, 
   3.5882956767576427`*^9}}]
}, Open  ]]
}, Open  ]],

Cell["(*END Compute Nodal Values: E1, RR0, Stif, cet, kapa*)", "Subsection",
 CellChangeTimes->{{3.587920493101604*^9, 3.5879205108350143`*^9}, {
  3.587922065368395*^9, 3.587922066694962*^9}}],

Cell["(*Compute Elastic Forces: Fc, Fd, Oe, Pe, Qe*)", "Subsection",
 CellChangeTimes->{{3.587920425135985*^9, 3.587920441733261*^9}, {
  3.5879308691754103`*^9, 3.58793087762665*^9}}],

Cell[CellGroupData[{

Cell["Compute Elastic Force Fc and Fd", "Subsection",
 CellChangeTimes->{{3.587920597615859*^9, 3.5879206474071703`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"eeeN1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eeeN2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eeeN3", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"eeeN1", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", "1"}], "]"}], "]"}], "=", 
    RowBox[{
     RowBox[{"E1N1", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "1"}], "]"}], "]"}], "-", 
     RowBox[{"RR0N1", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "1"}], "]"}], "]"}]}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"eeeN1", "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"i", "+", "3"}], ",", "1"}], "]"}], "]"}], "=", 
    RowBox[{"kapaN1", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"eeeN2", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", "1"}], "]"}], "]"}], "=", 
    RowBox[{
     RowBox[{"E1N2", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "1"}], "]"}], "]"}], "-", 
     RowBox[{"RR0N2", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "1"}], "]"}], "]"}]}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"eeeN2", "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"i", "+", "3"}], ",", "1"}], "]"}], "]"}], "=", 
    RowBox[{"kapaN2", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"eeeN3", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", "1"}], "]"}], "]"}], "=", 
    RowBox[{
     RowBox[{"E1N3", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "1"}], "]"}], "]"}], "-", 
     RowBox[{"RR0N3", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "1"}], "]"}], "]"}]}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"eeeN3", "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"i", "+", "3"}], ",", "1"}], "]"}], "]"}], "=", 
    RowBox[{"kapaN3", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tempSN1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tempSN2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tempSN3", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tempKN1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tempKN2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tempKN3", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"tempSN1", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", "1"}], "]"}], "]"}], "=", 
    RowBox[{"eeeN1", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"tempSN2", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", "1"}], "]"}], "]"}], "=", 
    RowBox[{"eeeN2", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"tempSN3", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", "1"}], "]"}], "]"}], "=", 
    RowBox[{"eeeN3", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"tempKN1", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", "1"}], "]"}], "]"}], "=", 
    RowBox[{"eeeN1", "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"i", "+", "3"}], ",", "1"}], "]"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"tempKN2", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", "1"}], "]"}], "]"}], "=", 
    RowBox[{"eeeN2", "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"i", "+", "3"}], ",", "1"}], "]"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"tempKN3", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", "1"}], "]"}], "]"}], "=", 
    RowBox[{"eeeN3", "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"i", "+", "3"}], ",", "1"}], "]"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fffN1", "=", 
   RowBox[{"StifN1", ".", "eeeN1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fffN2", "=", 
   RowBox[{"StifN2", ".", "eeeN2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fffN3", "=", 
   RowBox[{"StifN3", ".", "eeeN3"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Wrk31", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Wrk31", "=", 
   RowBox[{
    RowBox[{"Transpose", "[", "RR0N1", "]"}], ".", "tempSN1"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"e1sN1", "=", 
   RowBox[{"Wrk31", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Wrk31", "=", 
   RowBox[{
    RowBox[{"Transpose", "[", "RR0N2", "]"}], ".", "tempSN2"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"e1sN2", "=", 
   RowBox[{"Wrk31", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Wrk31", "=", 
   RowBox[{
    RowBox[{"Transpose", "[", "RR0N3", "]"}], ".", "tempSN3"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"e1sN3", "=", 
   RowBox[{"Wrk31", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Wrk31", "=", 
   RowBox[{
    RowBox[{"Transpose", "[", "RR0N1", "]"}], ".", "tempKN1"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"k1sN1", "=", 
   RowBox[{"Wrk31", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Wrk31", "=", 
   RowBox[{
    RowBox[{"Transpose", "[", "RR0N2", "]"}], ".", "tempKN2"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"k1sN2", "=", 
   RowBox[{"Wrk31", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Wrk31", "=", 
   RowBox[{
    RowBox[{"Transpose", "[", "RR0N3", "]"}], ".", "tempKN3"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"k1sN3", "=", 
   RowBox[{"Wrk31", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"fffN1", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", "1"}], "]"}], "]"}], "=", 
    RowBox[{
     RowBox[{"fffN1", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "1"}], "]"}], "]"}], "+", 
     RowBox[{"0.5", "*", "cet", "*", "k1sN1", "*", "k1sN1", "*", 
      RowBox[{"RR0N1", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "1"}], "]"}], "]"}]}]}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"fffN1", "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"i", "+", "3"}], ",", "1"}], "]"}], "]"}], "=", 
    RowBox[{
     RowBox[{"fffN1", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"i", "+", "3"}], ",", "1"}], "]"}], "]"}], "+", 
     RowBox[{"cet", "*", "e1sN1", "*", "k1sN1", "*", 
      RowBox[{"RR0N1", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "1"}], "]"}], "]"}]}]}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"fffN2", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", "1"}], "]"}], "]"}], "=", 
    RowBox[{
     RowBox[{"fffN2", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "1"}], "]"}], "]"}], "+", 
     RowBox[{"0.5", "*", "cet", "*", "k1sN2", "*", "k1sN2", "*", 
      RowBox[{"RR0N2", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "1"}], "]"}], "]"}]}]}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"fffN2", "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"i", "+", "3"}], ",", "1"}], "]"}], "]"}], "=", 
    RowBox[{
     RowBox[{"fffN2", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"i", "+", "3"}], ",", "1"}], "]"}], "]"}], "+", 
     RowBox[{"cet", "*", "e1sN2", "*", "k1sN2", "*", 
      RowBox[{"RR0N2", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "1"}], "]"}], "]"}]}]}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"fffN3", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", "1"}], "]"}], "]"}], "=", 
    RowBox[{
     RowBox[{"fffN3", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "1"}], "]"}], "]"}], "+", 
     RowBox[{"0.5", "*", "cet", "*", "k1sN3", "*", "k1sN3", "*", 
      RowBox[{"RR0N3", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "1"}], "]"}], "]"}]}]}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"fffN3", "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"i", "+", "3"}], ",", "1"}], "]"}], "]"}], "=", 
    RowBox[{
     RowBox[{"fffN3", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"i", "+", "3"}], ",", "1"}], "]"}], "]"}], "+", 
     RowBox[{"cet", "*", "e1sN3", "*", "k1sN3", "*", 
      RowBox[{"RR0N3", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "1"}], "]"}], "]"}]}]}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FcN1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FcN2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FcN3", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FcN1", "=", "fffN1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FcN2", "=", "fffN2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FcN3", "=", "fffN3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FdN1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FdN2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FdN3", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Wrk31", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", "1"}], "]"}], "]"}], "=", 
    RowBox[{"fffN1", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"temp", "=", 
    RowBox[{
     RowBox[{"Transpose", "[", 
      RowBox[{"Tilde", "[", 
       RowBox[{
        RowBox[{"E1N1", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
        RowBox[{"E1N1", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
        RowBox[{"E1N1", "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "]"}], "]"}], ".", 
     "Wrk31"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"Tilde", "[", 
      RowBox[{
       RowBox[{"Wrk31", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"Wrk31", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"Wrk31", "[", 
        RowBox[{"[", 
         RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "]"}], ".", "E1N1"}], ";"}],
    "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"FdN1", "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"i", "+", "3"}], ",", "1"}], "]"}], "]"}], "=", 
    RowBox[{"temp", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Wrk31", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", "1"}], "]"}], "]"}], "=", 
    RowBox[{"fffN2", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"temp", "=", 
    RowBox[{
     RowBox[{"Transpose", "[", 
      RowBox[{"Tilde", "[", 
       RowBox[{
        RowBox[{"E1N2", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
        RowBox[{"E1N2", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
        RowBox[{"E1N2", "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "]"}], "]"}], ".", 
     "Wrk31"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"Tilde", "[", 
      RowBox[{
       RowBox[{"Wrk31", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"Wrk31", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"Wrk31", "[", 
        RowBox[{"[", 
         RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "]"}], ".", "E1N2"}], ";"}],
    "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"FdN2", "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"i", "+", "3"}], ",", "1"}], "]"}], "]"}], "=", 
    RowBox[{"temp", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Wrk31", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", "1"}], "]"}], "]"}], "=", 
    RowBox[{"fffN3", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"temp", "=", 
    RowBox[{
     RowBox[{"Transpose", "[", 
      RowBox[{"Tilde", "[", 
       RowBox[{
        RowBox[{"E1N3", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
        RowBox[{"E1N3", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
        RowBox[{"E1N3", "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "]"}], "]"}], ".", 
     "Wrk31"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"Tilde", "[", 
      RowBox[{
       RowBox[{"Wrk31", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"Wrk31", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"Wrk31", "[", 
        RowBox[{"[", 
         RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "]"}], ".", "E1N3"}], ";"}],
    "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"FdN3", "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"i", "+", "3"}], ",", "1"}], "]"}], "]"}], "=", 
    RowBox[{"temp", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"FcN1", "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{"FcN2", "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{"FcN3", "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{"FdN1", "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{"FdN2", "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{"FdN3", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.5879206584972677`*^9, 3.5879206691019*^9}, {
  3.587920707683364*^9, 3.587920970346223*^9}, {3.587921055648239*^9, 
  3.587921223635993*^9}, {3.587921298294036*^9, 3.587921393336591*^9}, {
  3.587921439759502*^9, 3.58792158843277*^9}, {3.58792166415532*^9, 
  3.5879218645421267`*^9}, {3.587922034825398*^9, 3.587922051233824*^9}, {
  3.5879221367754383`*^9, 3.587922383708789*^9}, {3.587923573616172*^9, 
  3.58792366191226*^9}, {3.5879239782637033`*^9, 3.587924049455968*^9}, {
  3.587924232418064*^9, 3.587924498722577*^9}, {3.587928074663891*^9, 
  3.587928284911957*^9}, {3.58829600672316*^9, 3.5882960077715797`*^9}, {
  3.588296583621811*^9, 3.588296585968686*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Interpolate", " ", "Fc", " ", "and", " ", "Fd", " ", "to", " ", "Gauss", 
     " ", "Points", " ", "at"}], " ", "+", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"Sqrt", "[", "3", "]"}]}], "/", "3"}], " ", "to", " ", 
     "compare", " ", "with", " ", "Dymore"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Fcv1GL", "[", "s_", "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"hh1", "[", "s", "]"}], "*", 
       RowBox[{"FdN1", "[", 
        RowBox[{"[", 
         RowBox[{"5", ",", "1"}], "]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"hh2", "[", "s", "]"}], "*", 
       RowBox[{"FdN2", "[", 
        RowBox[{"[", 
         RowBox[{"5", ",", "1"}], "]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"hh3", "[", "s", "]"}], "*", 
       RowBox[{"FdN3", "[", 
        RowBox[{"[", 
         RowBox[{"5", ",", "1"}], "]"}], "]"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Fcv1GL", "[", "GL1", "]"}], "\[IndentingNewLine]", 
   RowBox[{"Fcv1GL", "[", "GL2", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.588296247444418*^9, 3.588296365831245*^9}, {
  3.5882964062995577`*^9, 3.588296464870055*^9}, {3.5882965971791277`*^9, 
  3.588296617597636*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Compute Elastic Matrix Oe, Pe, Qe", "Subsection",
 CellChangeTimes->{{3.587925328397952*^9, 3.587925344995552*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"C11N1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "3"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"C11N2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "3"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"C11N3", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "3"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"C12N1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "3"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"C12N2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "3"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"C12N3", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "3"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"C21N1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "3"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"C21N2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "3"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"C21N3", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "3"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"C22N1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "3"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"C22N2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "3"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"C22N3", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "3"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"C11N1", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
    RowBox[{"StifN1", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"C11N2", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
    RowBox[{"StifN2", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"C11N3", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
    RowBox[{"StifN3", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"C12N1", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
    RowBox[{"StifN1", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", 
       RowBox[{"j", "+", "3"}]}], "]"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"C12N2", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
    RowBox[{"StifN2", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", 
       RowBox[{"j", "+", "3"}]}], "]"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"C12N3", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
    RowBox[{"StifN3", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", 
       RowBox[{"j", "+", "3"}]}], "]"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"C21N1", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
    RowBox[{"StifN1", "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"i", "+", "3"}], ",", "j"}], "]"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"C21N2", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
    RowBox[{"StifN2", "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"i", "+", "3"}], ",", "j"}], "]"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"C21N3", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
    RowBox[{"StifN3", "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"i", "+", "3"}], ",", "j"}], "]"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"C22N1", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
    RowBox[{"StifN1", "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"i", "+", "3"}], ",", 
       RowBox[{"j", "+", "3"}]}], "]"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"C22N2", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
    RowBox[{"StifN2", "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"i", "+", "3"}], ",", 
       RowBox[{"j", "+", "3"}]}], "]"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"C22N3", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
     RowBox[{"StifN3", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"i", "+", "3"}], ",", 
        RowBox[{"j", "+", "3"}]}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Modify", " ", 
     RowBox[{"C", "/", "S"}], " ", "stiffness", " ", "matrix", " ", "due", 
     " ", "to", " ", "tension"}], "-", 
    RowBox[{"twist", " ", "coupling"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Wrk31", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", "1"}], "]"}], "]"}], "=", 
    RowBox[{"RR0N1", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Wrk33", "=", 
   RowBox[{"Outer", "[", 
    RowBox[{"Times", ",", 
     RowBox[{"Flatten", "[", "Wrk31", "]"}], ",", 
     RowBox[{"Flatten", "[", "Wrk31", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"C12N1", "=", 
   RowBox[{"C12N1", "+", 
    RowBox[{"cet", "*", "k1sN1", "*", "Wrk33"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"C21N1", "=", 
   RowBox[{"C21N1", "+", 
    RowBox[{"cet", "*", "k1sN1", "*", "Wrk33"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"C22N1", "=", 
   RowBox[{"C22N1", "+", 
    RowBox[{"cet", "*", "e1sN1", "*", "Wrk33"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Wrk31", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", "1"}], "]"}], "]"}], "=", 
    RowBox[{"RR0N2", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Wrk33", "=", 
   RowBox[{"Outer", "[", 
    RowBox[{"Times", ",", 
     RowBox[{"Flatten", "[", "Wrk31", "]"}], ",", 
     RowBox[{"Flatten", "[", "Wrk31", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"C12N2", "=", 
   RowBox[{"C12N2", "+", 
    RowBox[{"cet", "*", "k1sN2", "*", "Wrk33"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"C21N2", "=", 
   RowBox[{"C21N2", "+", 
    RowBox[{"cet", "*", "k1sN2", "*", "Wrk33"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"C22N2", "=", 
   RowBox[{"C22N2", "+", 
    RowBox[{"cet", "*", "e1sN2", "*", "Wrk33"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Wrk31", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", "1"}], "]"}], "]"}], "=", 
    RowBox[{"RR0N3", "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Wrk33", "=", 
   RowBox[{"Outer", "[", 
    RowBox[{"Times", ",", 
     RowBox[{"Flatten", "[", "Wrk31", "]"}], ",", 
     RowBox[{"Flatten", "[", "Wrk31", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"C12N3", "=", 
   RowBox[{"C12N3", "+", 
    RowBox[{"cet", "*", "k1sN3", "*", "Wrk33"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"C21N3", "=", 
   RowBox[{"C21N3", "+", 
    RowBox[{"cet", "*", "k1sN3", "*", "Wrk33"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"C22N3", "=", 
    RowBox[{"C22N3", "+", 
     RowBox[{"cet", "*", "e1sN3", "*", "Wrk33"}]}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Compute", " ", "Oe"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"epsiN1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "3"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"epsiN2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "3"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"epsiN3", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "3"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"muN1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "3"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"muN2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "3"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"muN3", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "3"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"epsiN1", "=", 
   RowBox[{"C11N1", ".", 
    RowBox[{"Tilde", "[", 
     RowBox[{
      RowBox[{"E1N1", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
      RowBox[{"E1N1", "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
      RowBox[{"E1N1", "[", 
       RowBox[{"[", 
        RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"epsiN2", "=", 
   RowBox[{"C11N2", ".", 
    RowBox[{"Tilde", "[", 
     RowBox[{
      RowBox[{"E1N2", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
      RowBox[{"E1N2", "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
      RowBox[{"E1N2", "[", 
       RowBox[{"[", 
        RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"epsiN3", "=", 
   RowBox[{"C11N3", ".", 
    RowBox[{"Tilde", "[", 
     RowBox[{
      RowBox[{"E1N3", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
      RowBox[{"E1N3", "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
      RowBox[{"E1N3", "[", 
       RowBox[{"[", 
        RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"muN1", "=", 
   RowBox[{"C21N1", ".", 
    RowBox[{"Tilde", "[", 
     RowBox[{
      RowBox[{"E1N1", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
      RowBox[{"E1N1", "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
      RowBox[{"E1N1", "[", 
       RowBox[{"[", 
        RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"muN2", "=", 
   RowBox[{"C21N2", ".", 
    RowBox[{"Tilde", "[", 
     RowBox[{
      RowBox[{"E1N2", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
      RowBox[{"E1N2", "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
      RowBox[{"E1N2", "[", 
       RowBox[{"[", 
        RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"muN3", "=", 
   RowBox[{"C21N3", ".", 
    RowBox[{"Tilde", "[", 
     RowBox[{
      RowBox[{"E1N3", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
      RowBox[{"E1N3", "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
      RowBox[{"E1N3", "[", 
       RowBox[{"[", 
        RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"OeN1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "6"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"OeN2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "6"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"OeN3", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "6"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"OeN1", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", 
        RowBox[{"j", "+", "3"}]}], "]"}], "]"}], "=", 
     RowBox[{
      RowBox[{"epsiN1", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j"}], "]"}], "]"}], "-", 
      RowBox[{
       RowBox[{"Tilde", "[", 
        RowBox[{
         RowBox[{"fffN1", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"fffN1", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"fffN1", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j"}], "]"}], "]"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "3"}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"OeN1", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"i", "+", "3"}], ",", 
        RowBox[{"j", "+", "3"}]}], "]"}], "]"}], "=", 
     RowBox[{
      RowBox[{"muN1", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j"}], "]"}], "]"}], "-", 
      RowBox[{
       RowBox[{"Tilde", "[", 
        RowBox[{
         RowBox[{"fffN1", "[", 
          RowBox[{"[", 
           RowBox[{"4", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"fffN1", "[", 
          RowBox[{"[", 
           RowBox[{"5", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"fffN1", "[", 
          RowBox[{"[", 
           RowBox[{"6", ",", "1"}], "]"}], "]"}]}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j"}], "]"}], "]"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "3"}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"OeN2", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", 
        RowBox[{"j", "+", "3"}]}], "]"}], "]"}], "=", 
     RowBox[{
      RowBox[{"epsiN2", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j"}], "]"}], "]"}], "-", 
      RowBox[{
       RowBox[{"Tilde", "[", 
        RowBox[{
         RowBox[{"fffN2", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"fffN2", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"fffN2", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j"}], "]"}], "]"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "3"}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"OeN2", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"i", "+", "3"}], ",", 
        RowBox[{"j", "+", "3"}]}], "]"}], "]"}], "=", 
     RowBox[{
      RowBox[{"muN2", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j"}], "]"}], "]"}], "-", 
      RowBox[{
       RowBox[{"Tilde", "[", 
        RowBox[{
         RowBox[{"fffN2", "[", 
          RowBox[{"[", 
           RowBox[{"4", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"fffN2", "[", 
          RowBox[{"[", 
           RowBox[{"5", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"fffN2", "[", 
          RowBox[{"[", 
           RowBox[{"6", ",", "1"}], "]"}], "]"}]}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j"}], "]"}], "]"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "3"}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"OeN3", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", 
        RowBox[{"j", "+", "3"}]}], "]"}], "]"}], "=", 
     RowBox[{
      RowBox[{"epsiN3", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j"}], "]"}], "]"}], "-", 
      RowBox[{
       RowBox[{"Tilde", "[", 
        RowBox[{
         RowBox[{"fffN3", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"fffN3", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"fffN3", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j"}], "]"}], "]"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "3"}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"OeN3", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"i", "+", "3"}], ",", 
         RowBox[{"j", "+", "3"}]}], "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{"muN3", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "j"}], "]"}], "]"}], "-", 
       RowBox[{
        RowBox[{"Tilde", "[", 
         RowBox[{
          RowBox[{"fffN3", "[", 
           RowBox[{"[", 
            RowBox[{"4", ",", "1"}], "]"}], "]"}], ",", 
          RowBox[{"fffN3", "[", 
           RowBox[{"[", 
            RowBox[{"5", ",", "1"}], "]"}], "]"}], ",", 
          RowBox[{"fffN3", "[", 
           RowBox[{"[", 
            RowBox[{"6", ",", "1"}], "]"}], "]"}]}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "j"}], "]"}], "]"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "3"}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Compute", " ", "Pe"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PeN1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "6"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PeN2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "6"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PeN3", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "6"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"PeN1", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"i", "+", "3"}], ",", "j"}], "]"}], "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Transpose", "[", "epsiN1", "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j"}], "]"}], "]"}], "+", 
      RowBox[{
       RowBox[{"Tilde", "[", 
        RowBox[{
         RowBox[{"fffN1", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"fffN1", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"fffN1", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j"}], "]"}], "]"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "3"}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"PeN1", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"i", "+", "3"}], ",", 
        RowBox[{"j", "+", "3"}]}], "]"}], "]"}], "=", 
     RowBox[{
      RowBox[{"Transpose", "[", "muN1", "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "3"}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"PeN2", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"i", "+", "3"}], ",", "j"}], "]"}], "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Transpose", "[", "epsiN2", "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j"}], "]"}], "]"}], "+", 
      RowBox[{
       RowBox[{"Tilde", "[", 
        RowBox[{
         RowBox[{"fffN2", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"fffN2", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"fffN2", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j"}], "]"}], "]"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "3"}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"PeN2", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"i", "+", "3"}], ",", 
        RowBox[{"j", "+", "3"}]}], "]"}], "]"}], "=", 
     RowBox[{
      RowBox[{"Transpose", "[", "muN2", "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "3"}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"PeN3", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"i", "+", "3"}], ",", "j"}], "]"}], "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Transpose", "[", "epsiN3", "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j"}], "]"}], "]"}], "+", 
      RowBox[{
       RowBox[{"Tilde", "[", 
        RowBox[{
         RowBox[{"fffN3", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"fffN3", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"fffN3", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j"}], "]"}], "]"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "3"}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PeN3", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"i", "+", "3"}], ",", 
         RowBox[{"j", "+", "3"}]}], "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{"Transpose", "[", "muN3", "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "3"}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Compute", " ", "Qe"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"QeN1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "6"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"QeN2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "6"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"QeN3", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "6"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tempO12", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "3"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"tempO12", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
     RowBox[{"OeN1", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", 
        RowBox[{"j", "+", "3"}]}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "3"}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"temp", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "3"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"temp", "=", 
   RowBox[{
    RowBox[{"Transpose", "[", 
     RowBox[{"Tilde", "[", 
      RowBox[{
       RowBox[{"E1N1", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"E1N1", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"E1N1", "[", 
        RowBox[{"[", 
         RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "]"}], "]"}], ".", 
    "tempO12"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"QeN1", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"i", "+", "3"}], ",", 
        RowBox[{"j", "+", "3"}]}], "]"}], "]"}], "=", 
     RowBox[{"temp", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "3"}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"tempO12", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
     RowBox[{"OeN2", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", 
        RowBox[{"j", "+", "3"}]}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "3"}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"temp", "=", 
   RowBox[{
    RowBox[{"Transpose", "[", 
     RowBox[{"Tilde", "[", 
      RowBox[{
       RowBox[{"E1N2", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"E1N2", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"E1N2", "[", 
        RowBox[{"[", 
         RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "]"}], "]"}], ".", 
    "tempO12"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"QeN2", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"i", "+", "3"}], ",", 
        RowBox[{"j", "+", "3"}]}], "]"}], "]"}], "=", 
     RowBox[{"temp", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "3"}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"tempO12", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
     RowBox[{"OeN3", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", 
        RowBox[{"j", "+", "3"}]}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "3"}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"temp", "=", 
   RowBox[{
    RowBox[{"Transpose", "[", 
     RowBox[{"Tilde", "[", 
      RowBox[{
       RowBox[{"E1N3", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"E1N3", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"E1N3", "[", 
        RowBox[{"[", 
         RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "]"}], "]"}], ".", 
    "tempO12"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"QeN3", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"i", "+", "3"}], ",", 
        RowBox[{"j", "+", "3"}]}], "]"}], "]"}], "=", 
     RowBox[{"temp", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "3"}], "}"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.587929320869298*^9, 3.587929351203936*^9}, {
  3.587929396050127*^9, 3.5879294326626453`*^9}, {3.5879294707822866`*^9, 
  3.587929578460314*^9}, {3.5879299716545763`*^9, 3.587929995436585*^9}, {
  3.587930091351926*^9, 3.587930107172978*^9}, {3.587930166594445*^9, 
  3.5879301697681704`*^9}, {3.587930530160406*^9, 3.5879305422730017`*^9}, {
  3.5879306165633717`*^9, 3.587930627711714*^9}, {3.58795664799866*^9, 
  3.587956873348321*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Check", " ", "Output"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"QeN3", "//", "MatrixForm"}]}]], "Input",
 CellChangeTimes->{{3.587930642306645*^9, 3.5879306577861423`*^9}, {
  3.587930715272203*^9, 3.587930725007863*^9}, {3.587995014700252*^9, 
  3.587995014912945*^9}, {3.5880018267032413`*^9, 3.588001832962028*^9}, {
  3.588002284755405*^9, 3.5880022850661583`*^9}, {3.588002456150976*^9, 
  3.5880024564110403`*^9}, {3.588002494188361*^9, 3.588002498072041*^9}, {
  3.588098273207406*^9, 3.588098275196954*^9}, {3.5880986527964*^9, 
  3.5880986570256977`*^9}, {3.588098776635257*^9, 3.588098802960738*^9}, {
  3.588098901289872*^9, 3.5880989335595083`*^9}}]
}, Open  ]],

Cell["(*END Compute Elastic Forces: Fc, Fd, Oe, Pe, Qe*)", "Subsection",
 CellChangeTimes->{{3.587930854121129*^9, 3.5879308607551003`*^9}, 
   3.5879309052892113`*^9}],

Cell[CellGroupData[{

Cell["(*Compute Elemental Matrices: elk,elf*)", "Subsection",
 CellChangeTimes->{{3.587945678551869*^9, 3.5879456827472963`*^9}, {
  3.587945748339109*^9, 3.587945757998966*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"elk", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "18"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "18"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.587945764965375*^9, 3.5879458139177856`*^9}, {
  3.5880326090372057`*^9, 3.5880326100305*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"temp66", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "6"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"temp66", "=", 
   RowBox[{
    RowBox[{"wj", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "1"}], "]"}], "]"}], "*", "Jaco", "*", "QeN1"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"elk", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
     RowBox[{
      RowBox[{"elk", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j"}], "]"}], "]"}], "+", 
      RowBox[{"temp66", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j"}], "]"}], "]"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "6"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "6"}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"temp66", "=", 
   RowBox[{
    RowBox[{"wj", "[", 
     RowBox[{"[", 
      RowBox[{"2", ",", "1"}], "]"}], "]"}], "*", "Jaco", "*", "QeN2"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"elk", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"i", "+", "6"}], ",", 
        RowBox[{"j", "+", "6"}]}], "]"}], "]"}], "=", 
     RowBox[{
      RowBox[{"elk", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"i", "+", "6"}], ",", 
         RowBox[{"j", "+", "6"}]}], "]"}], "]"}], "+", 
      RowBox[{"temp66", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j"}], "]"}], "]"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "6"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "6"}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"temp66", "=", 
   RowBox[{
    RowBox[{"wj", "[", 
     RowBox[{"[", 
      RowBox[{"3", ",", "1"}], "]"}], "]"}], "*", "Jaco", "*", "QeN3"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"elk", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"i", "+", "12"}], ",", 
        RowBox[{"j", "+", "12"}]}], "]"}], "]"}], "=", 
     RowBox[{
      RowBox[{"elk", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"i", "+", "12"}], ",", 
         RowBox[{"j", "+", "12"}]}], "]"}], "]"}], "+", 
      RowBox[{"temp66", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j"}], "]"}], "]"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "6"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "6"}], "}"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.587945838925054*^9, 3.587945902664487*^9}, {
  3.5879461810639067`*^9, 3.587946444589766*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "\[LessEqual]", "6"}], ",", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"j", "=", "1"}], ",", 
        RowBox[{"j", "\[LessEqual]", "3"}], ",", 
        RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"k", "=", "1"}], ",", 
            RowBox[{"k", "\[LessEqual]", "6"}], ",", 
            RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"elk", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"j", "-", "1"}], ")"}], "*", "6"}], "+", "k"}]}], 
                 "]"}], "]"}], "=", 
               RowBox[{
                RowBox[{"elk", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"j", "-", "1"}], ")"}], "*", "6"}], "+", "k"}]}], 
                  "]"}], "]"}], "+", 
                RowBox[{
                 RowBox[{"wj", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", "1"}], "]"}], "]"}], "*", 
                 RowBox[{"PeN1", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "k"}], "]"}], "]"}], "*", 
                 RowBox[{"hhp", "[", 
                  RowBox[{"[", 
                   RowBox[{"j", ",", "1"}], "]"}], "]"}]}]}]}], ";"}], 
             "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", "}"}]}], "]"}], 
      ";"}], "\[IndentingNewLine]", "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "7"}], ",", 
    RowBox[{"i", "\[LessEqual]", "12"}], ",", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"j", "=", "1"}], ",", 
        RowBox[{"j", "\[LessEqual]", "3"}], ",", 
        RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"k", "=", "1"}], ",", 
            RowBox[{"k", "\[LessEqual]", "6"}], ",", 
            RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"elk", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"j", "-", "1"}], ")"}], "*", "6"}], "+", "k"}]}], 
                 "]"}], "]"}], "=", 
               RowBox[{
                RowBox[{"elk", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"j", "-", "1"}], ")"}], "*", "6"}], "+", "k"}]}], 
                  "]"}], "]"}], "+", 
                RowBox[{
                 RowBox[{"wj", "[", 
                  RowBox[{"[", 
                   RowBox[{"2", ",", "1"}], "]"}], "]"}], "*", 
                 RowBox[{"PeN2", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"i", "-", "6"}], ",", "k"}], "]"}], "]"}], "*", 
                 RowBox[{"hhp", "[", 
                  RowBox[{"[", 
                   RowBox[{"j", ",", "2"}], "]"}], "]"}]}]}]}], ";"}], 
             "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", "}"}]}], "]"}], 
      ";"}], "\[IndentingNewLine]", "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "13"}], ",", 
    RowBox[{"i", "\[LessEqual]", "18"}], ",", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"j", "=", "1"}], ",", 
        RowBox[{"j", "\[LessEqual]", "3"}], ",", 
        RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"k", "=", "1"}], ",", 
            RowBox[{"k", "\[LessEqual]", "6"}], ",", 
            RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"elk", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"j", "-", "1"}], ")"}], "*", "6"}], "+", "k"}]}], 
                 "]"}], "]"}], "=", 
               RowBox[{
                RowBox[{"elk", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"j", "-", "1"}], ")"}], "*", "6"}], "+", "k"}]}], 
                  "]"}], "]"}], "+", 
                RowBox[{
                 RowBox[{"wj", "[", 
                  RowBox[{"[", 
                   RowBox[{"3", ",", "1"}], "]"}], "]"}], "*", 
                 RowBox[{"PeN3", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"i", "-", "12"}], ",", "k"}], "]"}], "]"}], "*", 
                 RowBox[{"hhp", "[", 
                  RowBox[{"[", 
                   RowBox[{"j", ",", "3"}], "]"}], "]"}]}]}]}], ";"}], 
             "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", "}"}]}], "]"}], 
      ";"}], "\[IndentingNewLine]", "}"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.5879469824169817`*^9, 3.587946986295197*^9}, {
  3.5879473248471537`*^9, 3.587947349083579*^9}, {3.587947413494095*^9, 
  3.5879474547025547`*^9}, {3.5879474867823277`*^9, 3.5879476525518436`*^9}, {
  3.5879476983275127`*^9, 3.587947698784689*^9}, {3.58794773684647*^9, 
  3.5879477682084837`*^9}, {3.587953132635401*^9, 3.587953160814477*^9}, {
  3.58795376728957*^9, 3.587953864392796*^9}, {3.587953895295532*^9, 
  3.587954006798662*^9}, {3.587955382211265*^9, 3.5879554293337727`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "\[LessEqual]", "6"}], ",", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"j", "=", "1"}], ",", 
        RowBox[{"j", "\[LessEqual]", "3"}], ",", 
        RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"k", "=", "1"}], ",", 
            RowBox[{"k", "\[LessEqual]", "6"}], ",", 
            RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"elk", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"j", "-", "1"}], ")"}], "*", "6"}], "+", "k"}], 
                  ",", "i"}], "]"}], "]"}], "=", 
               RowBox[{
                RowBox[{"elk", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"j", "-", "1"}], ")"}], "*", "6"}], "+", "k"}], 
                   ",", "i"}], "]"}], "]"}], "+", 
                RowBox[{
                 RowBox[{"wj", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", "1"}], "]"}], "]"}], "*", 
                 RowBox[{"OeN1", "[", 
                  RowBox[{"[", 
                   RowBox[{"k", ",", "i"}], "]"}], "]"}], "*", 
                 RowBox[{"hhp", "[", 
                  RowBox[{"[", 
                   RowBox[{"j", ",", "1"}], "]"}], "]"}]}]}]}], ";"}], 
             "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", "}"}]}], "]"}], 
      ";"}], "\[IndentingNewLine]", "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "7"}], ",", 
    RowBox[{"i", "\[LessEqual]", "12"}], ",", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"j", "=", "1"}], ",", 
        RowBox[{"j", "\[LessEqual]", "3"}], ",", 
        RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"k", "=", "1"}], ",", 
            RowBox[{"k", "\[LessEqual]", "6"}], ",", 
            RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"elk", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"j", "-", "1"}], ")"}], "*", "6"}], "+", "k"}], 
                  ",", "i"}], "]"}], "]"}], "=", 
               RowBox[{
                RowBox[{"elk", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"j", "-", "1"}], ")"}], "*", "6"}], "+", "k"}], 
                   ",", "i"}], "]"}], "]"}], "+", 
                RowBox[{
                 RowBox[{"wj", "[", 
                  RowBox[{"[", 
                   RowBox[{"2", ",", "1"}], "]"}], "]"}], "*", 
                 RowBox[{"OeN2", "[", 
                  RowBox[{"[", 
                   RowBox[{"k", ",", 
                    RowBox[{"i", "-", "6"}]}], "]"}], "]"}], "*", 
                 RowBox[{"hhp", "[", 
                  RowBox[{"[", 
                   RowBox[{"j", ",", "2"}], "]"}], "]"}]}]}]}], ";"}], 
             "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", "}"}]}], "]"}], 
      ";"}], "\[IndentingNewLine]", "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "13"}], ",", 
    RowBox[{"i", "\[LessEqual]", "18"}], ",", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"j", "=", "1"}], ",", 
        RowBox[{"j", "\[LessEqual]", "3"}], ",", 
        RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"k", "=", "1"}], ",", 
            RowBox[{"k", "\[LessEqual]", "6"}], ",", 
            RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"elk", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"j", "-", "1"}], ")"}], "*", "6"}], "+", "k"}], 
                  ",", "i"}], "]"}], "]"}], "=", 
               RowBox[{
                RowBox[{"elk", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"j", "-", "1"}], ")"}], "*", "6"}], "+", "k"}], 
                   ",", "i"}], "]"}], "]"}], "+", 
                RowBox[{
                 RowBox[{"wj", "[", 
                  RowBox[{"[", 
                   RowBox[{"3", ",", "1"}], "]"}], "]"}], "*", 
                 RowBox[{"OeN3", "[", 
                  RowBox[{"[", 
                   RowBox[{"k", ",", 
                    RowBox[{"i", "-", "12"}]}], "]"}], "]"}], "*", 
                 RowBox[{"hhp", "[", 
                  RowBox[{"[", 
                   RowBox[{"j", ",", "3"}], "]"}], "]"}]}]}]}], ";"}], 
             "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", "}"}]}], "]"}], 
      ";"}], "\[IndentingNewLine]", "}"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.587954356962047*^9, 3.5879543700669193`*^9}, {
  3.587954414141038*^9, 3.587954414451758*^9}, {3.5879544573390207`*^9, 
  3.587954459137031*^9}, {3.587954614436022*^9, 3.587954701219331*^9}, {
  3.5879554362702436`*^9, 3.58795543962208*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "\[LessEqual]", "3"}], ",", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"j", "=", "1"}], ",", 
        RowBox[{"j", "\[LessEqual]", "3"}], ",", 
        RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"k", "=", "1"}], ",", 
            RowBox[{"k", "\[LessEqual]", "6"}], ",", 
            RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"m", "=", "1"}], ",", 
                RowBox[{"m", "\[LessEqual]", "6"}], ",", 
                RowBox[{"m", "++"}], ",", "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"elk", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"i", "-", "1"}], ")"}], "*", "6"}], "+", "k"}], 
                    ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"j", "-", "1"}], ")"}], "*", "6"}], "+", "m"}]}], 
                    "]"}], "]"}], "=", 
                   RowBox[{
                    RowBox[{"elk", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"i", "-", "1"}], ")"}], "*", "6"}], "+", "k"}], 
                    ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"j", "-", "1"}], ")"}], "*", "6"}], "+", "m"}]}], 
                    "]"}], "]"}], "+", 
                    RowBox[{
                    RowBox[{"wj", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], "*", 
                    RowBox[{"hhp", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}], "*", 
                    RowBox[{"StifN1", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "m"}], "]"}], "]"}], "*", 
                    RowBox[{
                    RowBox[{"hhp", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "1"}], "]"}], "]"}], "/", "Jaco"}]}], 
                    "+", 
                    RowBox[{
                    RowBox[{"wj", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}], "*", 
                    RowBox[{"hhp", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], "*", 
                    RowBox[{"StifN2", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "m"}], "]"}], "]"}], "*", 
                    RowBox[{
                    RowBox[{"hhp", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "2"}], "]"}], "]"}], "/", "Jaco"}]}], 
                    "+", 
                    RowBox[{
                    RowBox[{"wj", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", "1"}], "]"}], "]"}], "*", 
                    RowBox[{"hhp", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "3"}], "]"}], "]"}], "*", 
                    RowBox[{"StifN3", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "m"}], "]"}], "]"}], "*", 
                    RowBox[{
                    RowBox[{"hhp", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "3"}], "]"}], "]"}], "/", 
                    "Jaco"}]}]}]}], ";"}], "\[IndentingNewLine]", "}"}]}], 
               "]"}], ";"}], "\[IndentingNewLine]", "}"}]}], "]"}], ";"}], 
         "\[IndentingNewLine]", "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
     "}"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.587955575440631*^9, 3.587955643583229*^9}, {
  3.587955676574108*^9, 3.5879558351905613`*^9}, {3.5879558706569767`*^9, 
  3.587956115668538*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Check", " ", "Output", " ", "elk"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"elk", "//", "MatrixForm"}]}]], "Input",
 CellChangeTimes->{{3.587956130925693*^9, 3.587956143249234*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Compute", " ", "RHS", " ", "Force", " ", "Vector", " ", "elf"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"elf", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "18"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"temp61", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "6"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"temp61", "=", 
     RowBox[{
      RowBox[{"wj", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}], "*", "Jaco", "*", "FdN1"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"elf", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "1"}], "]"}], "]"}], "=", 
       RowBox[{
        RowBox[{"elf", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "1"}], "]"}], "]"}], "+", 
        RowBox[{"temp61", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "1"}], "]"}], "]"}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "6"}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"temp61", "=", 
     RowBox[{
      RowBox[{"wj", "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "1"}], "]"}], "]"}], "*", "Jaco", "*", "FdN2"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"elf", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"i", "+", "6"}], ",", "1"}], "]"}], "]"}], "=", 
       RowBox[{
        RowBox[{"elf", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"i", "+", "6"}], ",", "1"}], "]"}], "]"}], "+", 
        RowBox[{"temp61", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "1"}], "]"}], "]"}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "6"}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"temp61", "=", 
     RowBox[{
      RowBox[{"wj", "[", 
       RowBox[{"[", 
        RowBox[{"3", ",", "1"}], "]"}], "]"}], "*", "Jaco", "*", "FdN3"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"elf", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"i", "+", "12"}], ",", "1"}], "]"}], "]"}], "=", 
       RowBox[{
        RowBox[{"elf", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"i", "+", "12"}], ",", "1"}], "]"}], "]"}], "+", 
        RowBox[{"temp61", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "1"}], "]"}], "]"}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "6"}], "}"}]}], "]"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.588030868412489*^9, 3.58803088295326*^9}, {
   3.588031054262599*^9, 3.588031065510819*^9}, 3.588031108890665*^9, {
   3.588031155993059*^9, 3.5880313159574757`*^9}, {3.588032616823866*^9, 
   3.58803261736913*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "\[LessEqual]", "6"}], ",", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"elf", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "1"}], "]"}], "]"}], "=", 
       RowBox[{
        RowBox[{"elf", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "1"}], "]"}], "]"}], "+", 
        RowBox[{
         RowBox[{"wj", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], "*", 
         RowBox[{"hhp", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], "*", 
         RowBox[{"FcN1", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "1"}], "]"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"wj", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "1"}], "]"}], "]"}], "*", 
         RowBox[{"hhp", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "2"}], "]"}], "]"}], "*", 
         RowBox[{"FcN2", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "1"}], "]"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"wj", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "1"}], "]"}], "]"}], "*", 
         RowBox[{"hhp", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "3"}], "]"}], "]"}], "*", 
         RowBox[{"FcN3", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "1"}], "]"}], "]"}]}]}]}], "}"}], ";"}]}], "]"}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "7"}], ",", 
    RowBox[{"i", "\[LessEqual]", "12"}], ",", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"elf", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "1"}], "]"}], "]"}], "=", 
       RowBox[{
        RowBox[{"elf", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "1"}], "]"}], "]"}], "+", 
        RowBox[{
         RowBox[{"wj", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], "*", 
         RowBox[{"hhp", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "1"}], "]"}], "]"}], "*", 
         RowBox[{"FcN1", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"i", "-", "6"}], ",", "1"}], "]"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"wj", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "1"}], "]"}], "]"}], "*", 
         RowBox[{"hhp", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "2"}], "]"}], "]"}], "*", 
         RowBox[{"FcN2", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"i", "-", "6"}], ",", "1"}], "]"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"wj", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "1"}], "]"}], "]"}], "*", 
         RowBox[{"hhp", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "3"}], "]"}], "]"}], "*", 
         RowBox[{"FcN3", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"i", "-", "6"}], ",", "1"}], "]"}], "]"}]}]}]}], "}"}], 
     ";"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "13"}], ",", 
    RowBox[{"i", "\[LessEqual]", "18"}], ",", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"elf", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "1"}], "]"}], "]"}], "=", 
       RowBox[{
        RowBox[{"elf", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "1"}], "]"}], "]"}], "+", 
        RowBox[{
         RowBox[{"wj", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], "*", 
         RowBox[{"hhp", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "1"}], "]"}], "]"}], "*", 
         RowBox[{"FcN1", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"i", "-", "12"}], ",", "1"}], "]"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"wj", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "1"}], "]"}], "]"}], "*", 
         RowBox[{"hhp", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "2"}], "]"}], "]"}], "*", 
         RowBox[{"FcN2", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"i", "-", "12"}], ",", "1"}], "]"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"wj", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "1"}], "]"}], "]"}], "*", 
         RowBox[{"hhp", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "3"}], "]"}], "]"}], "*", 
         RowBox[{"FcN3", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"i", "-", "12"}], ",", "1"}], "]"}], "]"}]}]}]}], "}"}], 
     ";"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"elf", "=", 
   RowBox[{"-", "elf"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.5880313624990673`*^9, 3.588031380207995*^9}, {
  3.588031418127784*^9, 3.588031597352096*^9}, {3.588031632293249*^9, 
  3.588031665448867*^9}, {3.5880317454121523`*^9, 3.588031902605197*^9}, {
  3.588033410369708*^9, 3.588033415564231*^9}}],

Cell[BoxData[
 RowBox[{"elf", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.588032420631913*^9, 3.588032424227192*^9}}]
}, Open  ]],

Cell["(*END Compute Elemental Matrices: elk,elf*)", "Subsection",
 CellChangeTimes->{{3.58803419482736*^9, 3.588034235833897*^9}}],

Cell[CellGroupData[{

Cell["(* Solve Linear System *)", "Subsection",
 CellChangeTimes->{{3.5880342481027184`*^9, 3.588034258847475*^9}}],

Cell[CellGroupData[{

Cell["Include BC condition into elk, elf", "Subsubsection",
 CellChangeTimes->{{3.588034268795136*^9, 3.588034281554613*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "\[LessEqual]", "6"}], ",", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"j", "=", "1"}], ",", 
       RowBox[{"j", "\[LessEqual]", "18"}], ",", 
       RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"elk", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", "0"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "\[LessEqual]", "18"}], ",", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"j", "=", "1"}], ",", 
       RowBox[{"j", "\[LessEqual]", "6"}], ",", 
       RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"elk", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", "0"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "\[LessEqual]", "6"}], ",", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"elk", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "i"}], "]"}], "]"}], "=", "1"}], ";"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"elk", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.588034300659892*^9, 3.5880343567790213`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "\[LessEqual]", "6"}], ",", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"elf", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "1"}], "]"}], "]"}], "=", "0.0"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"elf", "=", 
   RowBox[{"elf", "+", "Fext"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"elf", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.588034404192913*^9, 3.588034413161859*^9}, {
  3.588212017661673*^9, 3.588212074043458*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Solve elk.x=elf", "Subsubsection",
 CellChangeTimes->{{3.588034464541416*^9, 3.58803447330228*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ui", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "18"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ui", "=", 
   RowBox[{
    RowBox[{"Inverse", "[", "elk", "]"}], ".", "elf"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ui", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.588034482854357*^9, 3.588034492718092*^9}, {
  3.588034645671698*^9, 3.588034702503128*^9}}]
}, Open  ]]
}, Open  ]],

Cell["(*END Solve Linear System*)", "Subsection",
 CellChangeTimes->{{3.588172152146029*^9, 3.588172162871367*^9}}],

Cell[CellGroupData[{

Cell["(* Update Configuration*)", "Subsection",
 CellChangeTimes->{{3.588172165951775*^9, 3.588172179559247*^9}}],

Cell[CellGroupData[{

Cell["Update Nodal Displacement", "Subsubsection",
 CellChangeTimes->{{3.588172184856985*^9, 3.58817219479946*^9}, {
  3.588172379780287*^9, 3.5881723805792503`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "\[LessEqual]", "3"}], ",", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"j", "=", "1"}], ",", 
        RowBox[{"j", "\[LessEqual]", "3"}], ",", 
        RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"uuNf", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"i", "-", "1"}], ")"}], "*", "6"}], "+", "j"}], ",", 
              "1"}], "]"}], "]"}], "=", 
           RowBox[{"ui", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"i", "-", "1"}], ")"}], "*", "6"}], "+", "j"}], ",", 
              "1"}], "]"}], "]"}]}], ";"}], "}"}]}], "]"}], ";"}], 
     "\[IndentingNewLine]", "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"uuNf", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.5881722085444202`*^9, 3.588172359786334*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Update Nodal Rotation", "Subsubsection",
 CellChangeTimes->{{3.588172369329556*^9, 3.588172383914003*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"temp31", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "\[LessEqual]", "3"}], ",", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"temp31", "=", 
       RowBox[{"CrvCompose0", "[", 
        RowBox[{
         RowBox[{"ui", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"i", "-", "1"}], ")"}], "*", "6"}], "+", "4"}], ",", 
            "1"}], "]"}], "]"}], ",", 
         RowBox[{"ui", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"i", "-", "1"}], ")"}], "*", "6"}], "+", "5"}], ",", 
            "1"}], "]"}], "]"}], ",", 
         RowBox[{"ui", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"i", "-", "1"}], ")"}], "*", "6"}], "+", "6"}], ",", 
            "1"}], "]"}], "]"}], ",", 
         RowBox[{"uuNf", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"i", "-", "1"}], ")"}], "*", "6"}], "+", "4"}], ",", 
            "1"}], "]"}], "]"}], ",", 
         RowBox[{"uuNf", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"i", "-", "1"}], ")"}], "*", "6"}], "+", "5"}], ",", 
            "1"}], "]"}], "]"}], ",", 
         RowBox[{"uuNf", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"i", "-", "1"}], ")"}], "*", "6"}], "+", "6"}], ",", 
            "1"}], "]"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"j", "=", "1"}], ",", 
        RowBox[{"j", "\[LessEqual]", "3"}], ",", 
        RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"uuNf", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"i", "-", "1"}], ")"}], "*", "6"}], "+", "3", "+", 
               "j"}], ",", "1"}], "]"}], "]"}], "=", 
           RowBox[{"temp31", "[", 
            RowBox[{"[", 
             RowBox[{"j", ",", "1"}], "]"}], "]"}]}], ";"}], "}"}]}], 
       "\[IndentingNewLine]", "]"}], ";"}], "}"}]}], "\[IndentingNewLine]", 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"uuNf", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.588172453219942*^9, 3.588172852176779*^9}}]
}, Open  ]]
}, Open  ]]
}, Closed]]
},
WindowSize->{1280, 778},
WindowMargins->{{Automatic, -1280}, {-193, Automatic}},
FrontEndVersion->"8.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (October 5, \
2011)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 186, 3, 67, "Section"],
Cell[CellGroupData[{
Cell[790, 29, 118, 1, 34, "Subsection"],
Cell[911, 32, 576, 18, 80, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1524, 55, 102, 1, 34, "Subsection"],
Cell[1629, 58, 262, 10, 61, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1928, 73, 176, 2, 34, "Subsection"],
Cell[2107, 77, 3460, 108, 398, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5604, 190, 114, 1, 34, "Subsection"],
Cell[5721, 193, 7911, 220, 196, "Input"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[13681, 419, 98, 1, 37, "Section"],
Cell[13782, 422, 1151, 31, 88, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14970, 458, 100, 1, 67, "Section"],
Cell[CellGroupData[{
Cell[15095, 463, 152, 2, 34, "Subsection"],
Cell[15250, 467, 3923, 102, 193, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19210, 574, 103, 1, 34, "Subsection"],
Cell[19316, 577, 3599, 100, 193, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22952, 682, 100, 1, 34, "Subsection"],
Cell[23055, 685, 3802, 110, 223, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26894, 800, 99, 1, 34, "Subsection"],
Cell[26996, 803, 3214, 87, 283, "Input"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[30259, 896, 103, 1, 37, "Section"],
Cell[CellGroupData[{
Cell[30387, 901, 4930, 153, 318, "Input"],
Cell[35320, 1056, 17582, 296, 70, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[52951, 1358, 134, 3, 37, "Section"],
Cell[53088, 1363, 142, 3, 27, "Input"],
Cell[53233, 1368, 779, 25, 91, "Input"],
Cell[54015, 1395, 248, 6, 46, "Input"],
Cell[54266, 1403, 2902, 97, 238, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[57205, 1505, 100, 1, 37, "Section"],
Cell[CellGroupData[{
Cell[57330, 1510, 108, 1, 34, "Subsection"],
Cell[57441, 1513, 7046, 217, 223, "Input"]
}, Open  ]],
Cell[64502, 1733, 112, 1, 34, "Subsection"],
Cell[64617, 1736, 193, 2, 26, "Subsection"],
Cell[CellGroupData[{
Cell[64835, 1742, 147, 2, 26, "Subsection"],
Cell[64985, 1746, 8116, 262, 283, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[73138, 2013, 196, 3, 34, "Subsection"],
Cell[73337, 2018, 8247, 270, 313, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[81621, 2293, 101, 1, 34, "Subsection"],
Cell[CellGroupData[{
Cell[81747, 2298, 158, 2, 24, "Subsubsection"],
Cell[81908, 2302, 2360, 71, 58, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[84305, 2378, 111, 1, 24, "Subsubsection"],
Cell[84419, 2381, 1802, 53, 103, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[86270, 2440, 166, 2, 34, "Subsection"],
Cell[86439, 2444, 4767, 155, 223, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[91243, 2604, 113, 1, 34, "Subsection"],
Cell[CellGroupData[{
Cell[91381, 2609, 142, 2, 24, "Subsubsection"],
Cell[91526, 2613, 6445, 199, 223, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[98020, 2818, 100, 1, 34, "Subsection"],
Cell[CellGroupData[{
Cell[98145, 2823, 109, 1, 24, "Subsubsection"],
Cell[98257, 2826, 1406, 45, 103, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[99700, 2876, 108, 1, 24, "Subsubsection"],
Cell[99811, 2879, 8266, 257, 283, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[108114, 3141, 108, 1, 24, "Subsubsection"],
Cell[108225, 3144, 389, 10, 58, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[108651, 3159, 130, 1, 24, "Subsubsection"],
Cell[108784, 3162, 593, 16, 43, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[109414, 3183, 103, 1, 24, "Subsubsection"],
Cell[109520, 3186, 1496, 41, 148, "Input"]
}, Open  ]]
}, Open  ]],
Cell[111043, 3231, 193, 2, 34, "Subsection"],
Cell[111239, 3235, 184, 2, 26, "Subsection"],
Cell[CellGroupData[{
Cell[111448, 3241, 121, 1, 26, "Subsection"],
Cell[111572, 3244, 20041, 641, 1048, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[131650, 3890, 121, 1, 34, "Subsection"],
Cell[131774, 3893, 33347, 1080, 1318, "Input"],
Cell[CellGroupData[{
Cell[165146, 4977, 799, 13, 43, "Input"],
Cell[165948, 4992, 899, 23, 127, "Output"]
}, Open  ]]
}, Open  ]],
Cell[166874, 5019, 168, 2, 34, "Subsection"],
Cell[CellGroupData[{
Cell[167067, 5025, 135, 3, 26, "Subsection"],
Cell[167205, 5030, 4108, 128, 253, "Input"]
}, Open  ]],
Cell[171328, 5161, 141, 3, 34, "Subsection"],
Cell[CellGroupData[{
Cell[171494, 5168, 139, 3, 26, "Subsection"],
Cell[171636, 5173, 7761, 253, 373, "Input"],
Cell[179400, 5428, 14247, 459, 598, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[193684, 5892, 178, 2, 34, "Subsection"],
Cell[193865, 5896, 362, 10, 27, "Input"],
Cell[194230, 5908, 2807, 93, 118, "Input"],
Cell[197040, 6003, 6488, 167, 283, "Input"],
Cell[203531, 6172, 6246, 164, 283, "Input"],
Cell[209780, 6338, 4446, 108, 163, "Input"],
Cell[214229, 6448, 286, 8, 43, "Input"],
Cell[214518, 6458, 3217, 102, 148, "Input"],
Cell[217738, 6562, 5233, 154, 118, "Input"],
Cell[222974, 6718, 3413, 106, 148, "Input"],
Cell[226390, 6826, 171, 4, 27, "Input"]
}, Open  ]],
Cell[226576, 6833, 130, 1, 34, "Subsection"],
Cell[CellGroupData[{
Cell[226731, 6838, 115, 1, 26, "Subsection"],
Cell[CellGroupData[{
Cell[226871, 6843, 125, 1, 24, "Subsubsection"],
Cell[226999, 6846, 1789, 54, 178, "Input"],
Cell[228791, 6902, 708, 19, 88, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[229536, 6926, 105, 1, 24, "Subsubsection"],
Cell[229644, 6929, 598, 17, 58, "Input"]
}, Open  ]]
}, Open  ]],
Cell[230269, 6950, 115, 1, 34, "Subsection"],
Cell[CellGroupData[{
Cell[230409, 6955, 113, 1, 26, "Subsection"],
Cell[CellGroupData[{
Cell[230547, 6960, 166, 2, 24, "Subsubsection"],
Cell[230716, 6964, 1235, 35, 73, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[231988, 7004, 112, 1, 24, "Subsubsection"],
Cell[232103, 7007, 3060, 90, 163, "Input"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[235224, 7104, 152, 2, 67, "Section"],
Cell[235379, 7108, 193, 2, 34, "Subsection"],
Cell[CellGroupData[{
Cell[235597, 7114, 147, 2, 26, "Subsection"],
Cell[235747, 7118, 8168, 263, 283, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[243952, 7386, 196, 3, 34, "Subsection"],
Cell[244151, 7391, 8145, 267, 313, "Input"],
Cell[252299, 7660, 1181, 35, 73, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[253517, 7700, 101, 1, 34, "Subsection"],
Cell[CellGroupData[{
Cell[253643, 7705, 158, 2, 24, "Subsubsection"],
Cell[253804, 7709, 2342, 69, 58, "Input"],
Cell[256149, 7780, 1183, 35, 73, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[257369, 7820, 111, 1, 24, "Subsubsection"],
Cell[257483, 7823, 1699, 49, 103, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[259231, 7878, 166, 2, 34, "Subsection"],
Cell[259400, 7882, 5010, 159, 268, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[264447, 8046, 113, 1, 34, "Subsection"],
Cell[CellGroupData[{
Cell[264585, 8051, 142, 2, 24, "Subsubsection"],
Cell[264730, 8055, 6401, 197, 268, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[271180, 8258, 100, 1, 34, "Subsection"],
Cell[CellGroupData[{
Cell[271305, 8263, 109, 1, 24, "Subsubsection"],
Cell[271417, 8266, 1442, 42, 103, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[272896, 8313, 108, 1, 24, "Subsubsection"],
Cell[273007, 8316, 8263, 255, 283, "Input"],
Cell[281273, 8573, 1238, 36, 73, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[282548, 8614, 108, 1, 24, "Subsubsection"],
Cell[282659, 8617, 389, 10, 58, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[283085, 8632, 130, 1, 24, "Subsubsection"],
Cell[283218, 8635, 593, 16, 43, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[283848, 8656, 103, 1, 24, "Subsubsection"],
Cell[283954, 8659, 1496, 39, 148, "Input"]
}, Open  ]]
}, Open  ]],
Cell[285477, 8702, 193, 2, 34, "Subsection"],
Cell[285673, 8706, 184, 2, 26, "Subsection"],
Cell[CellGroupData[{
Cell[285882, 8712, 121, 1, 26, "Subsection"],
Cell[286006, 8715, 20029, 636, 1063, "Input"],
Cell[306038, 9353, 1304, 37, 73, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[307379, 9395, 121, 1, 34, "Subsection"],
Cell[307503, 9398, 33347, 1080, 1318, "Input"],
Cell[340853, 10480, 718, 12, 43, "Input"]
}, Open  ]],
Cell[341586, 10495, 168, 2, 34, "Subsection"],
Cell[CellGroupData[{
Cell[341779, 10501, 178, 2, 26, "Subsection"],
Cell[341960, 10505, 362, 10, 27, "Input"],
Cell[342325, 10517, 2807, 93, 118, "Input"],
Cell[345135, 10612, 6488, 167, 283, "Input"],
Cell[351626, 10781, 6246, 164, 283, "Input"],
Cell[357875, 10947, 4446, 108, 178, "Input"],
Cell[362324, 11057, 241, 6, 43, "Input"],
Cell[362568, 11065, 3217, 102, 148, "Input"],
Cell[365788, 11169, 5233, 154, 163, "Input"],
Cell[371024, 11325, 127, 2, 27, "Input"]
}, Open  ]],
Cell[371166, 11330, 130, 1, 34, "Subsection"],
Cell[CellGroupData[{
Cell[371321, 11335, 115, 1, 26, "Subsection"],
Cell[CellGroupData[{
Cell[371461, 11340, 125, 1, 24, "Subsubsection"],
Cell[371589, 11343, 1743, 52, 178, "Input"],
Cell[373335, 11397, 667, 18, 88, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[374039, 11420, 105, 1, 24, "Subsubsection"],
Cell[374147, 11423, 557, 16, 58, "Input"]
}, Open  ]]
}, Open  ]],
Cell[374731, 11443, 115, 1, 35, "Subsection"],
Cell[CellGroupData[{
Cell[374871, 11448, 113, 1, 27, "Subsection"],
Cell[CellGroupData[{
Cell[375009, 11453, 166, 2, 24, "Subsubsection"],
Cell[375178, 11457, 1249, 35, 88, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[376464, 11497, 112, 1, 24, "Subsubsection"],
Cell[376579, 11500, 3060, 90, 148, "Input"]
}, Open  ]]
}, Open  ]]
}, Closed]]
}
]
*)

(* End of internal cache information *)
