%&LaTeX
\subsection{Example 1: Static bending of a cantilever beam}

The first example is a common benchmark problem for geometrically nonlinear
analysis of beams\cite{Simo1985,Xiao-Zhong:2012}. We calculate the static
deflection of a cantilever beam that is subjected at its free end to
a constant moment about the $x_2$ axis, $M_2$; a system schematic is shown in Figure~\ref{E1Sketch}.  The length of the beam $L$ is $10$ inches and the cross-sectional stiffness 
matrix is 
\begin{equation}
    \label{StifE1}
    C^* = 10^3 \times \begin{bmatrix}
	1770 & 0    & 0    & 0    & 0    & 0   \\
	 0    & 1770 & 0    & 0    & 0    & 0   \\
	 0   &   0   & 1770 & 0    & 0    & 0   \\
	 0   &   0   &  0    & 8.16 & 0    & 0   \\
	 0   &   0   &  0    &  0    & 86.9 & 0   \\
	 0   &   0   &  0    &  0    &   0   & 215
\end{bmatrix}
\end{equation}
which has units of $C_{ij}^*$ (lb), $C_{i,j+3}^*$ (lb.in), and
$C_{i+3,j+3}^*$ (lb.in$^2$) for $i,j = 1,2,3$; these units apply to all
subsequent stiffness matrices. It is pointed out that the term with an
asterisk denotes that it is resolved in the material coordinate system. 

\begin{figure}
    \centering \includegraphics[width=0.5\textwidth]{\directory
E1Sketch.eps} \caption{Schematic of a cantilever beam with tip moment,
which was used in BeamDyn verification and performance studies.}
    \label{E1Sketch}
\end{figure} 

The load applied at the tip is given by 
\begin{equation}
    \label{E1Load}
    M_2 = \lambda \bar{M}_2
\end{equation}
where $\bar{M}_2 = \pi \frac{EI_2}{L}$; and the parameter $\lambda$ will vary between $0$ and $2$. In 
this case, the beam is discretized with two $5^{th}$-order Legendre
spectral FEs. The
static deformations of the beam obtained from BeamDyn are shown in
Figure~\ref{E1Deform} for six different tip moments.
The calculated tip displacements are compared with the analytical solution,
which can be found in Mayo et al.\cite{Mayo-etal:2004} as
\begin{equation}
    \label{E1Analytical}
    u_1 = \rho \sin \left( \frac{x_1}{\rho} \right) - x_1~~~~~u_3 = \rho
\left(1-\cos\left(\frac{x_1}{\rho}\right) \right)
\end{equation}
Analytical and BeamDyn-calculated results can be found in Table~\ref{E1u1}
and \ref{E1u3}. At this discretization level, BeamDyn results are virtually
identical to those of the analytical solution.

\begin{figure}
    \centering
    \includegraphics[width=0.5\textwidth]{\directory E1Deform.eps}

    \caption{Static deflection of a cantilever beam under six constant
bending moments as calculated with two 5$^{th}$-order Legendre spectral
FEs in BeamDyn.}

    \label{E1Deform}
\end{figure}

\begin{table}[tbp]
\centering 
\caption{Comparison of analytical and BeamDyn-calculated tip axial displacement
$u_1$ of a cantilever beam subject to a constant moment (in inches); the BeamDyn
model was composed of two 5$^{th}$-order LSFEs.}
\label{E1u1} 
	\begin{tabular}{| l | l | l | }
    	\hline
    	$\lambda$ & Analytical & BeamDyn  \\ \hline
    	0.4       & -2.4317    & -2.4317  \\ \hline
    	0.8       & -7.6613    & -7.6613  \\ \hline
    	1.2       & -11.5591   & -11.5591 \\ \hline
    	1.6       & -11.8921   & -11.8921 \\ \hline
    	2.0       & -10.0000   & -10.0000 \\ \hline
    \end{tabular}
\end{table}

\begin{table}[tbp]
\centering 
\caption{Comparison of analytical and BeamDyn-calculated tip vertical displacement
$u_3$ of a cantilever beam subject to a constant moment (in inches); the BeamDyn
model was composed of two 5$^{th}$-order LSFEs.}
\label{E1u3} 
	\begin{tabular}{| l | l | l | }
    	\hline
    	$\lambda$ & Analytical & BeamDyn  \\ \hline
    	0.4       & 5.4987     & 5.4987   \\ \hline
    	0.8       & 7.1978     & 7.1979   \\ \hline
    	1.2       & 4.7986     & 4.7986   \\ \hline
    	1.6       & 1.3747     & 1.3747   \\ \hline
    	2.0       & 0.0000     & 0.0000   \\ \hline
    \end{tabular}
 \end{table}

The rotation parameter $p_2$ at each node along beam axis $x_1$ obtained from BeamDyn are plotted in Figure~\ref{E1Rot} for $\lambda = 0.8$ and $\lambda = 2.0$, respectively. A rescaling can be observed from this figure for the case $\lambda = 2.0$.
\begin{figure}
    \centering
    \includegraphics[width=3.0in]{\directory E1Rot.eps}
    \caption{Wiener-Milenkovi\'c rotation parameters along beam axis $x_1$
as calculated by BeamDyn for two tip moments. \mas{It would be great if
there was a dashed vertical line showing boundary between the two elements.
Also, this figure tells me that the rotation parameter is discontinuous in
Element 1 -- is that true, or is it multi-valued at the element interface?}}
    \label{E1Rot}
\end{figure}

Finally, we conduct a convergence study of the BeamDyn LSFEs. The
convergence rate is compared with conventional quadratic elements used in
Dymore \cite{Dymore:2013}\mas{REFERENCE? Manual or soemething?}, which is a finite-element
based multibody dynamics code for the comprehensive modeling of flexible
multibody systems. 
%It is pointed out that user can choose element up to
%$3^rd$ order in Dymore. 
Figure~\ref{E1Conv} shows the normalized error
$\epsilon(u)$, where $u$ is the calculated tip displacement (at $x=L$), as a function
of the number of model nodes for the calculation with Dymore quadratic finite
elements (QFE) and a single Legendre spectral element finite (LSFE), where
\begin{equation}
    \label{E1Error}
    \epsilon(u) = \left| \frac{u-u^a}{u^a} \right|
\end{equation}
and where $u^a$ is the analytical solution.  The parameter $\lambda$ is set
to $1.0$ for this case. The Legendre spectral elements (with $p$-refinement)
exhibit highly desirable exponential convergence to machine-precision error,
whereas the conventional quadratic elements are limited to algebraic
convergence.    For a given model size, an LSFE model can be orders of magnitude
more accurate than its QFE counterpart.

\begin{figure}
    \centering
    \psfrag{xaxis}[][]{Number of Nodes}
    \begin{tabular}{c}
    \subfloat[$u_1$]{\label{E1Conv:u1}\includegraphics[width=3.0 in]{\directory  E1Convu1.eps}} \qquad
\subfloat[$u_3$]{\label{E1Conv:u3}\includegraphics[width=3.0in]{\directory  E1Convu3.eps}}\\
\end{tabular}
\caption{Normalized error of the (a) $u_1$ and (b) $u_3$ tip displacements
of a cantiler beam (Figure~\ref{E1Sketch}) under constant tip
moment ($\lambda = 1.0$) as a function of the total number of nodes. Results were calculated
with BeamDyn (LSFE) and Dymore (QFE).  LSFE model refinement was accomplished
by increasing polynomial order and QFE model refinement was accomplished by
increasing the number of elements.  }
\label{E1Conv}
\end{figure}

