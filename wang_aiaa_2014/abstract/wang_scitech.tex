\documentclass{aiaa-tc}

\usepackage{color}
\usepackage{amsmath}
%\usepackage{overcite}
\usepackage{graphicx}
\usepackage{subfig}
\usepackage{authblk}

\input basic.ltx
\def\directory{EPSF/}

%------------------------------------------------------------------------------
% MAS Additions
\newcommand{\mas}[1]{\textcolor{magenta}{#1}}
\newcommand{\qw}[1]{\textcolor{blue}{#1}}
%useful for showing deleted text
\renewcommand{\kill}[1]{\textcolor{red}{\sout{#1}}}                             

\usepackage[normalem]{ulem}  % mas addition
\newcommand{\uvec}[1]{\bar{#1}}
\newcommand{\tens}[1]{\underline{\underline{#1}}}
\renewcommand{\vec}[1]{\underline{#1}}
\renewcommand{\skew}[1]{\widetilde{#1}}
%------------------------------------------------------------------------------

%\title{A Efficient High-Fidelity Beam Solver in FAST Modularization Framework}
\title{Nonlinear Legendre Spectral Finite Elements for \\
Wind Turbine Blade Dynamics}

%{Rotation parameterization for analysis of geometrically nonlinear deformation of beams}

%{Structural Dynamics Analysis of Geometric Nonlinear Composite Beams}

% typeset with pdflatex, bibtex, pdflatex, pdflatex


%\author{Qi Wang%
 %        \thanks{Postdoctoral Research Fellow, AIAA Member.}\\
 %        \normalsize\itshape
 %        National Renewable Energy Laboratory, Golden, CO 80020}



 \author[1]{Qi Wang\thanks{Research Engineer, National Wind Technology Center, AIAA Member. Email: Qi.Wang2@nrel.gov}}
 \author[1]{Michael A. Sprague\thanks{Senior Research Scientist, Scientific Computing Center.}}
 \author[1]{Jason Jonkman\thanks{Senior Engineer, National Wind Technology Center.}}
 \affil[1]{National Renewable Energy Laboratory, Golden, CO 80401-3305}
 
 \renewcommand\Authands{ and }

\begin{document}

\maketitle

\begin{abstract}
{ This paper presenA Efficient High-Fidelity Beam Solver in FAST Modularization Framework}ts a numerical implementation of Geometrically Exact Beam Theory (GEBT) based on a high-order spectral finite element method. The theoretical foundation of the present work is detailed first. The coupling effects which usually exist in composite structures  and geometric nonlinearity are taken into consideration in this theory. Then the major technical barrier, the interpolation of the three-dimensional rotation field, is discussed. It is shown by a numerical example that the high-order spectral finite elements along with nodal quadrature do not suffer from a drawback exists in traditional finite elements at where the tangent stiffness matrix is calculated. Moreover, the current code is implemented in accordance to the FAST Modularization Framework, **** {\color{red}  Need one sentence to describe the FAST Modularization Framework}. Numerical examples for validation purpose will be provided in the final full paper}     
\end{abstract}

%\section*{Nomenclature}

 %\begin{tabbing}
  %XXX \= \kill % first line sets tab stop
  %$J$ \> Jacobian Matrix \\
  %$f$ \> Residual value vector \\
  %$x$ \> Variable value vector \\
  %$F$ \> Force, N \\
  %$m$ \> Mass, kg \\
  %$\Delta x$ \> Variable displacement vector \\
  %$\alpha$ \> Acceleration, m/s\textsuperscript{2} \\[5pt]
  %\textit{Subscript}\\
  %$i$ \> Variable number \\
 %\end{tabbing}

\section{Introduction}
Wind power is becoming one of the most important renewable energy sources in the United States as demonstrated by the fact that the electricity produced from wind amounted to 3.56\% of all generated electrical energy for the 12 months until March 2013 \cite{WindWiki}. In the recent years, the size of wind turbine has been increasing immensely to lower the cost, which also leads to highly flexible turbine blades. This huge electromechanical system poses a significant challenge for engineering design and analysis. Although it is possible with super computers nowadays, direct three-dimensional (3D) structural analysis is so computationally expensive that engineers are always seeking for efficient high-fidelity simplified models.

Beam is a widely used simplified engineering structure which has one of its dimensions much larger than the other two. Many engineering components can be idealized as beams: bridges in civil engineering, joists and lever arms in heavy machine industries, and helicopter rotor blades in aeronautics. The blades, tower, and shaft in a wind turbine system can be considered as beams. In the weight-critical applications of beam structure, like high aspect ration wings in aerospace and wind energy engineering, composite materials are more attractive than the traditional metal materials due to their superior weight-to-strength and weight-to stiffness ratios. However, the analysis of structures made of composite materials is more difficult than their isotropic counterparts due to the coupling effects. The Geometrically Exact Beam Theory (GEBT), which was first proposed by Ressiner in 1973 \cite{Ressiner1973}, is a method that is proven powerful for analysis of highly flexible composite beams in helicopter society. During the past several decades, a lot of effort has been invested in this area. Simo \cite{Simo1985} and Simo and Vu-Quoc \cite{Simo1986} extended Reissner's work to deal with three-dimensional (3D) dynamic problems. Jeleni\'c and Crisfield \cite{Crisfield1999} implemented this theory using finite element method where a new approach for interpolating rotation field was proposed to preserve the geometric exactness. Betsch and Steinmann \cite{Betsch2002} circumvented the interpolation of rotation by introducing a reparameterization of the weak form corresponding to the equations of motion of GEBT. It is noted that Ibrahimbegovi\'c and his colleagues implemented this theory for static \cite{Ibrahim1995} and dynamic \cite{Ibrahim1998} analysis. In contrast to the displacement-based implementations, the geometric exact beam theory has also
been formulated by mixed finite elements where both the primary and dual field are independently interpolated \cite{CookFEM}. In the mixed
formulation, all the necessary ingredients, including Hamilton's principle and the kinematic equations, are combined in a single variational
formulation statement with Lagrange multipliers, and the motion variables, generalized strains, forces and moments, linear and angular momenta, and displacement and rotation variables are considered as independent quantities. Yu etal \cite{YuGEBT} presented the implementation of GEBT in a mixed formulation; various rotation parameters are investigated and the code is validated against analytical and numerical solutions. The readers are referred to a textbook by Hodges \cite{HodgesBeamBook}, where comprehensive derivations and discussions on nonlinear composite beam theories can be found.

In this paper, we will present a displacement-based implementation of geometrically exact beam theory using spectral finite element. The theoretical foundation, the geometrically exact beam theory, is introduced first. Then the interpolation of 3D rotation field by spectral finite element is discussed along with a simple numerical example. Finally, validation examples are provided to show the accuracy and efficiency of the present model. The code implemented in this work is in accordance to FAST Modularization Framework ***** {\color{red} Some sentences are needed here to introduce the benefit of Modularization Framework}.  

\section{Geometric Exact Beam Theory}
This section reviews the geometric exact beam theory and linearization process of the governing equations for completeness of this paper. The content of this section can be found in many other papers and textbooks.
Figure~\ref{Kinematics} shows a beam in its initial undeformed
and deformed states. A reference frame $\mathbf{b}_i$ is introduced along the
beam axis for the undeformed state; a frame $\mathbf{B}_i$ is introduced
along each point of the deformed beam axis. Curvilinear coordinate $x_1$ defines the intrinsic parameterization of the reference line.
\begin{figure}
\centering
\includegraphics[width=5.0in]{\directory Kinematics.eps}
\caption{Schematic of beam deformation} \label{Kinematics}
\end{figure}
In this paper, we use matrix notation to denote vectorial or vectorial-like quantities. For example, we use a underline to denote a vector $\underline{u}$, a bar to denote unit vector $\bar{n}$, and double underline to denote a tensor $\underline{\underline{\Delta}}$. Note that sometimes the underlines only denote the dimension of the corresponding matrix. The governing equations of motion for geometric exact beam theory can be written as \cite{Bauchau:2010}
\begin{align}
	\label{GovernGEBT-1}
	\dot{\underline{h}} - \underline{F}^\prime &= \underline{f} \\
	\label{GovernGEBT-2}
	\dot{\underline{g}} + \dot{\tilde{u}} \underline{h} - \underline{M}^\prime - (\tilde{x}_0^\prime + \tilde{u}^\prime) \underline{F} &= \underline{m}
\end{align}
where $\vec{h}$ and $\vec{g}$ are the linear and angular momenta resolved in the inertial coordinate system, respectively; $\vec{F}$ and $\vec{M}$ are the beam's sectional forces and moments, respectively; $\vec{u}$ is the 1D displacement of the reference line; $\vec{x}_0$ is the position vector of a point along the beam's reference line; $\vec{f}$ and $\vec{m}$ are the distributed force and moment applied to the beam structure.  Notation $(\bullet)^\prime$ indicates a derivative with respect to the beam axis $x_1$ and $\dot{(\bullet)}$ indicates a derivative with respect to time. The tilde operator $(\skew{\bullet})$ defines a second-order, skew-symmetric tensor corresponding to the given vector. In the literature, it is also termed as "cross-product matrix". For example,
\[
	\skew{n} = 
	     		\begin{bmatrix}
			0 & -n_3 & n_2 \\
			n_3 & 0 & -n_1 \\
			-n_2 & n_1 & 0\\
			\end{bmatrix}	
\]
The constitutive equations relate the velocities to the momenta and the one-dimensional strain measures to the sectional resultants as
\begin{align}
	\label{ConstitutiveMass}
	\begin{Bmatrix}
	\underline{h} \\
	\underline{g}
	\end{Bmatrix}
	= \underline{\underline{\mathcal{M}}} \begin{Bmatrix}
	\dot{\underline{u}} \\
	\underline{\omega}
	\end{Bmatrix} \\
	\label{ConstitutiveStiff}
	\begin{Bmatrix}
	\underline{F} \\
	\underline{M}
	\end{Bmatrix}
	= \underline{\underline{\mathcal{C}}} \begin{Bmatrix}
	\underline{\epsilon} \\
	\underline{\kappa}
	\end{Bmatrix}
\end{align}
where $\underline{\underline{\mathcal{M}}}$ and $\underline{\underline{\mathcal{C}}}$ are the $6 \times 6$ sectional mass and stiffness matrices,respectively, note that they are not really tensors; $\underline{\epsilon}$ and $\underline{\kappa}$ are the 1D strains and curvatures, respectively. $\underline{\omega}$ is the angular velocity vector that is defined by the rotation tensor $\underline{\underline{R}}$ as $\underline{\omega} = axial(\dot{\underline{\underline{R}}}~\underline{\underline{R}})$.

For a displacement-based finite element implementation, there are six degree-of-freedoms(DoFs) at each node: 3 displacement components and 3 rotation components. Here we use $\vec{q}$ to denote the elemental displacement array as $\underline{q}=\left[ \underline{u}^T~~\underline{p}^T\right]$ where $\vec{u}$ is the 1D displacement and $\vec{p}$ is the rotation parameter vector. The acceleration array can thus be defined as $\underline{a}=\left[ \ddot{\underline{u}}^T~~ \ddot{\underline{p}}^T \right]$. For nonlinear finite element analysis, the discretized and incremental forms of displacement, velocity, and acceleration array are written as
\begin{align}
	\label{Discretized}
	\underline{q} (x_1) &= \underline{\underline{N}} ~\hat{\underline{q}}~~~~\Delta \underline{q}^T = \left[ \Delta \underline{u}^T~~\Delta \underline{p}^T \right] \\
	\underline{v}(x_1) &= \underline{\underline{N}}~\hat{\underline{v}}~~~~\Delta \underline{\dot{q}}^T = \left[\Delta \underline{\dot{u}}^T~~\Delta \underline{\dot{p}}^T \right] \\
%	\label{Incremental}
	\underline{a}(x_1) &= \underline{\underline{N}}~ \hat{\underline{a}}~~~~\Delta \underline{\ddot{q}}^T = \left[ \Delta \ddot{\underline{u}}^T~~\Delta \ddot{\underline{p}}^T \right]	
\end{align}
where $\tens{N}$ is the shape function matrix and $(\hat{\bullet})$ denotes a column matrix of nodal values.
The governing equations for beams are highly nonlinear so that a linearization process is needed. According to Ref.\cite{Bauchau:2010}, the linearized governing equations in Eq.~\eqref{GovernGEBT-1} and \eqref{GovernGEBT-2} are in the form of
\begin{equation}
	\label{LinearizedEqn}
	\hat{\underline{\underline{M}}} \Delta \hat{\underline{a}} +\hat{\underline{\underline{G}}} \Delta \hat{\underline{v}}+ \hat{\underline{\underline{K}}} \Delta \hat{\underline{q}} = \hat{\underline{F}}^{ext} - \hat{\underline{F}}
\end{equation} 
where the $\hat{\tens{M}}$, $\hat{\tens{G}}$, and $\hat{\tens{K}}$ are the elemental mass, gyroscopic, and stiffness matrices, respectively; $\hat{\vec{F}}$ and $\hat{\vec{F}}^{ext}$ are the elemental forces and externally applied loads, respectively. They are defined as follows
\begin{align}
	\label{hatM} 
	\hat{\tens{M}}&= \int_0^l \underline{\underline{N}}^T \mathcal{\underline{\underline{M}}} ~\underline{\underline{N}} dx_1 \\
	\label{hatG}
	\hat{\tens{G}} &= \int_0^l \tens{N}^T \tens{\mathcal{G}}^I~\tens{N} dx_1\\ 
	\label{hatK}
	\hat{\tens{K}}&=\int_0^l \left[ \tens{N}^T (\tens{\mathcal{K}}^I + \mathcal{\tens{Q}})~ \tens{N} + \tens{N}^T \mathcal{\tens{P}}~ \tens{N}^\prime + \tens{N}^{\prime T} \mathcal{\tens{S}}~ \tens{N}^\prime + \tens{N}^{\prime T} \mathcal{\tens{O}}~ \tens{N} \right] d x_1 \\	
	\label{hatF}
	\hat{\vec{F}} &= \int_0^l (\tens{N}^T \vec{\mathcal{F}}^I + \tens{N}^T \mathcal{\vec{F}}^D + \tens{N}^{\prime T} \mathcal{\vec{F}}^C)dx_1 \\
	\label{hatFext}
	\hat{\vec{F}}^{ext}& = \int_0^l \tens{N}^T \mathcal{\vec{F}}^{ext} dx_1 
\end{align}
The new matrix notations in Eq.~\eqref{hatM} to \eqref{hatFext} are briefly introduced here. $\mathcal{\tens{M}}$ is the sectional mass matrix resolved in inertial system; $\mathcal{\vec{F}}^C$ and $\mathcal{\vec{F}}^D$ are elastic forces obtained from Eq.~\eqref{GovernGEBT-1} and \eqref{GovernGEBT-2} as
\begin{align}
	\label{FC}
	\mathcal{\vec{F}}^C &= \begin{Bmatrix}
         \vec{F} \\
	\vec{M}
	\end{Bmatrix} = \tens{\mathcal{C}} \begin{Bmatrix}
	\vec{\epsilon} \\
	\vec{\kappa}
	\end{Bmatrix} \\
	\label{FD}
	\mathcal{\vec{F}}^D & = \begin{bmatrix}
	\underline{\underline{0}} & \underline{\underline{0}}\\
	(\tilde{x}_0^\prime+\tilde{u}^\prime)^T & \underline{\underline{0}}
	\end{bmatrix}
	\mathcal{\vec{F}}^C \equiv \tens{\Upsilon}~ \mathcal{\vec{F}}^C
\end{align}
where $\underline{\underline{0}}$ denotes a $3 \times 3$ null matrix. The $\tens{\mathcal{G}}^I$, $\tens{\mathcal{K}}^I$, $\mathcal{\tens{S}}$, $\mathcal{\tens{O}}$, $\mathcal{\tens{P}}$, $\mathcal{\tens{Q}}$, and $\vec{\mathcal{F}}^I$ in Eq.~\eqref{hatG}, Eq.~\eqref{hatK}, and Eq.~\eqref{hatF} are defined as
\begin{align}
        \label{mathcalG}
        \tens{\mathcal{G}}^I &= \begin{bmatrix}
        \tens{0} & 2m\tilde{\eta}^T \dot{\tens{H}}-2 \tilde{\beta} \tens{H}  \\
        \tens{0} & 2 \tens{\varrho} \tens{\dot{H}} + \tens{\varepsilon} \tens{H}
        \end{bmatrix} \\
        \label{mathcalK}
        \tens{\mathcal{K}}^I &= \begin{bmatrix}
        \tens{0} & m \tilde{\eta}^T \ddot{\tens{H}} - 2 \tilde{\beta} \tens{\dot{H}} - \tilde{\alpha} \tens{H} \\
        \tens{0} & \tens{\varrho} \ddot{\tens{H}} + \tens{\varepsilon} \dot{\tens{H}} + (\ddot{\tilde{u}} m \tilde{\eta}-\tilde{\gamma}) \tens{H}
        \end{bmatrix}\\
	\label{mathcalS}
	\mathcal{\tens{S}} &= \tens{\mathcal{C}} \begin{bmatrix}
	\underline{\underline{I}} & \underline{\underline{0}} \\
	\underline{\underline{0}} & \tens{H}
	\end{bmatrix} \\
	\label{mathcalO}
	\mathcal{\tens{O}} &= \begin{bmatrix}
	\underline{\underline{0}} & \tilde{F}^T \tens{H} \\
	\underline{\underline{0}}& \tilde{M}^T \tens{H}
	\end{bmatrix} + \tens{\mathcal{C}} \begin{bmatrix}
	\underline{\underline{0}} & (\tilde{x}^\prime_0 + \tilde{u}^\prime) \tens{H} \\
	\underline{\underline{0}} & \tens{H}^\prime
	\end{bmatrix} \\
	\label{mathcalP}
	\mathcal{\tens{P}} &= \begin{bmatrix}
	\underline{\underline{0}} & \underline{\underline{0}} \\
	\tilde{F} & \underline{\underline{0}}
	\end{bmatrix} + \tens{\Upsilon}~ \mathcal{\tens{S}} \\
	\label{mathcalQ}
	\mathcal{\tens{Q}} &= \tens{\Upsilon}~ \mathcal{\tens{O}} \\
	\label{mathcalF}
	\vec{\mathcal{F}}^I &= \begin{Bmatrix}
	m \ddot{\vec{u}} + \vec{\alpha} \\
	m \tilde{\eta} \ddot{\vec{u}} + \vec{\gamma}
	\end{Bmatrix}
\end{align}
where $\tens{I}$ a $3 \times 3$ identity matrix; operator $\tens{H}$ is the tangent tensor which relates the angular velocity vector $\vec{\omega}$ and the rotation parameter vector $\vec{p}$ as
\begin{equation}
	\label{operatorH}
	\vec{\omega} = \tens{H}(\vec{p}) \dot{\vec{p}}
\end{equation}
The following notations were introduced to simply the writing of the above expressions $\vec{\alpha} = (\dot{\tilde{\omega}} + \tilde{\omega} \tilde{\omega} ) m \vec{\eta}$, $\vec{\beta} = \tilde{\omega} m \vec{\eta}$, $\vec{\gamma} = \tens{\varrho} \dot{\vec{\omega}} + \tilde{\omega} \tens{\varrho} \vec{\omega}$, and $\tens{\varepsilon} = \tilde{\omega} \tens{\varrho} + (\tilde{\omega} \tens{\varrho})^T - \widetilde{\tens{\varrho} \vec{\omega}}$.   
The derivation and linearization of governing equations of geometrically exact beam theory can be found in a recent textbook by Bauchau \cite{Bauchau:2010}.

\section{Interpolation of Rotation Field by Spectral Finite Element}
The displacement fields in a element can be interpolated as
\begin{align}
    \label{InterpolateDisp}
    \vec{u}(s) &= h^k(s) \vec{\hat{u}}^k \\
    \label{InterpolateDispp}
    \vec{u}^\prime(s) &= h^{k\prime}(s) \vec{\hat{u}}^k
\end{align}
where $\vec{u}$ is the displacement field, $h^k(s), k=1,2,...n$ are the shape functions from first to the $n^{th}$ node; $\vec{\hat{u}}$ is the nodal values of the displacement field. However, as discussed in Ref.~\cite{Bauchau:2010}, the three-dimensional rotation field cannot be simply interpolated as the displacement field in the form of
\begin{align}
    \label{InterpolateRot}
    \vec{c}(s) &= h^k(s) \vec{\hat{c}}^k \\
    \label{InterpolateRotp}
    \vec{c}^\prime(s) &= h^{k \prime}(s) \vec{\hat{c}}^k 
\end{align}    
where $\vec{c}$ is the rotation field in a element and $\vec{\hat{c}}^k$ is the nodal value at the $k^{th}$ node, for three reasons: 1) rotations do not form a linear space so that they have to be composed instead of added; 2) rescaling operation is needed to eliminate the singularity existing in the vectorial rotation parameters; 3) it is lack of objectivity, which is defined by Crisfield and Jeleni\'c in Ref.~\cite{Crisfield1999} and refers to the invariance of strain measures computed through interpolation to the addition of a rigid body motion. Therefore, we adopt a more robust interpolation approach proposed by Crisfield and jeleni\'c \cite{Crisfield1999} to deal with the finite rotations.
\begin{description}
    \item[Step 1:] Compute the nodal relative rotations, $\vec{\hat{r}}^k$ by removing the rigid body rotation, $\vec{\hat{c}}^1$, from the finite rotation at each node, $\vec{\hat{r}}^k = \vec{\hat{c}}^{1-} \oplus \vec{\hat{c}}^k$.
    \item[Step 2:] Interpolate the relative rotation field: $\vec{r}(s) = h^k(s) \vec{\hat{r}}^k$ and $\vec{r}^\prime(s) = h^{k \prime}(s) \vec{\hat{r}}^k$. Find the curvature field $\vec{\kappa}(s) = R(\vec{\hat{c}}^1)H(\vec{r}) \vec{r}^\prime$.
    \item[Step 3:] Restore the rigid body rotation removed in Step 1: $\vec{c}(s) = \vec{\hat{c}}^1 \oplus \vec{r}(s)$.
\end{description} 

 
 \section{Content of Full Paper}
In the full paper, we will provide more details of the theoretical
derivations along with various numerical examples. A demonstration example will be provided in Section III to show the advantage of nodal quadrature using spectral finite elements in interpolating the rotation field over the traditional method. Static and dynamic examples will be presented to show the accuracy and capability of the newly developed beam solver. Moreover, we will briefly introduce the format of the current code, which is in accordance to the FAST modularization framework. 
%\section{Conclusion}

%After much typing, the paper can now conclude.
%Four rocks were next to the channel.
%This caused a few standing waves during the rip that one could ride on
%the way in or jump on the way out.

%\section*{Appendix}

%An appendix, if needed, it should appear before the acknowledgments.
%Use the 'starred' version of the \verb|\section| commands to avoid
%section numbering.

%\section*{Acknowledgments}

%A place to recognize others or simply thank Kleb and Wood for this template.

\bibliographystyle{aiaa}
\bibliography{references}

\end{document}
