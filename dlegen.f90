      function dlegen(n, x)
      
      integer n
      double precision dlegen, x


      dlegen = 0.d0
      if (n.gt.20) stop 'order too great for dlegen.f'
      if (n.eq.1) then
        dlegen = x
      else if (n.eq.2) then
        dlegen = (3.d0/2.d0)*x**2 - 0.5d0
      else if (n.eq.3) then
        dlegen = (-3.d0*x)/2.d0 + (5.d0*x**3)/2.d0
      else if (n.eq.4) then
        dlegen = 0.375d0 - (15.d0*x**2)/4.d0 + (35.d0*x**4)/8.d0
      else if (n.eq.5) then
        dlegen = (15.d0*x)/8.d0 - (35.d0*x**3)/4.d0& 
             &+ (63.d0*x**5)/8.d0
      else if (n.eq.6) then
        dlegen = -0.3125d0 + (105.d0*x**2)/16.d0& 
             &- (315.d0*x**4)/16.d0 + (231.d0*x**6)/16.d0
      else if (n.eq.7) then
        dlegen = (-35.d0*x)/16.d0 + (315.d0*x**3)/16.d0& 
             &- (693.d0*x**5)/16.d0 + (429.d0*x**7)/16.d0
      else if (n.eq.8) then
        dlegen = 0.2734375d0 - (315.d0*x**2)/32.d0& 
             &+ (3465.d0*x**4)/64.d0&   
             &- (3003.d0*x**6)/32.d0 + (6435.d0*x**8)/128.d0
      else if (n.eq.9) then
        dlegen = (315.d0*x)/128.d0 - (1155.d0*x**3)/32.d0& 
             &+ (9009.d0*x**5)/64.d0&   
             &- (6435.d0*x**7)/32.d0 + (12155.d0*x**9)/128.d0
      else if (n.eq.10) then
        dlegen = -0.24609375d0+(3465.d0*x**2)/256.d0& 
             &- (15015.d0*x**4)/128.d0&  
             &+ (45045.d0*x**6)/128.d0& 
             &- (109395.d0*x**8)/256.d0& 
             &+ (46189.d0*x**10)/256.d0
      else if (n.eq.11) then
        dlegen = (-693.d0*x)/256.d0 + (15015.d0*x**3)/256.d0&
             &- (45045.d0*x**5)/128.d0& 
             &+ (109395.d0*x**7)/128.d0&
             &- (230945.d0*x**9)/256.d0 + (88179.d0*x**11)/256.d0
      else if (n.eq.12) then
        dlegen = 0.2255859375d0 - (9009.d0*x**2)/512.d0&
             &+ (225225.d0*x**4)/1024.d0 - (255255.d0*x**6)/256.d0&
             &+ (2078505.d0*x**8)/1024.d0 - (969969.d0*x**10)/512.d0&
             &+ (676039.d0*x**12)/1024.d0
      else if (n.eq.13) then
        dlegen = (3003.d0*x)/1024.d0 - (45045.d0*x ** 3)/512.d0&
             &+ (765765.d0*x ** 5)/ 1024.d0&
             &- (692835.d0*x ** 7)/256.d0+(4849845.d0*x**9)/1024.d0&
             &- (2028117.d0*x**11)/ 512.d0&
             &+ (1300075.d0*x**13)/1024.d0
      else if (n.eq.14) then
        dlegen = -0.20947265625d0 + (45045.d0*x**2)/2048.d0&
             &- (765765.d0*x**4)/ 2048.d0+(4849845.d0*x**6)/2048.d0&
             &- (14549535.d0*x**8)/2048.d0+(22309287.d0*x**10)/2048.d0& 
             &- (16900975.d0*x**12)/2048.d0+(5014575.d0*x**14)/2048.d0
      else if (n.eq.15) then
        dlegen = (-6435.d0*x)/2048.d0+(255255.d0*x**3)/2048.d0&
             &- (2909907.d0*x**5)/2048.d0+(14549535.d0*x**7)/2048.d0&
             &- (37182145.d0*x**9)/2048.d0+(50702925.d0*x**11)/2048.d0& 
             &- (35102025.d0*x**13)/2048.d0+(9694845.d0*x**15)/2048.d0
      else if (n.eq.16) then
        dlegen = 0.196380615234375d0-(109395.d0*x**2)/4096.d0& 
             &+ (4849845.d0*x**4)/8192.d0-(20369349.d0*x**6)/4096.d0&
             &+ (334639305.d0*x**8)/16384.d0&
             &- (185910725.d0*x**10)/4096.d0& 
             &+ (456326325.d0*x**12)/8192.d0&
             &- (145422675.d0*x**14)/4096.d0& 
             &+ (300540195.d0*x**16)/32768.d0
      else if (n.eq.17) then
       dlegen = 3.338470458984375d0*x - 169.149169921875d0*x**3 +& 
     &2486.4927978515625d0*x**5 - 16339.809814453125d0*x**7 +& 
       &56735.450744628906d0*x**9 -& 
       &111407.79418945312d0*x**11 +& 
       &124262.53967285156d0*x**13 -& 
       &73374.07104492188d0*x**15 + 17804.002532958984d0*x**17
      else if (n.eq.18) then
       dlegen = -0.1854705810546875d0 + 31.715469360351562d0*x**2 -& 
       &888.0331420898438d0*x**4 + 9531.555725097656d0*x**6 -& 
       &51061.905670166016d0*x**8 +& 
       &153185.71701049805d0*x**10 -& 
       &269235.5026245117d0*x**12 +& 
       &275152.76641845703d0*x**14 -& 
       &151334.02153015137d0*x**16 + 34618.893814086914d0*x**18
      else if (n.eq.19) then
       dlegen =  -3.5239410400390625d0*x + 222.00828552246094d0*x**3 -& 
       &4084.9524536132812d0*x**5 + 34041.270446777344d0*x**7 -& 
       &153185.71701049805d0*x**9 + 403853.2539367676d0*x**11 -& 
       &642023.1216430664d0*x**13 + 605336.0861206055d0*x**15 -& 
       &311570.0443267822d0*x**17 + 67415.74058532715d0*x**19
      end if
      return
      end
