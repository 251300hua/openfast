\documentclass{aiaa-tc}

\usepackage{color}
\usepackage{amsmath}
%\usepackage{overcite}
\usepackage{graphicx}
\usepackage{subfig}
\usepackage{authblk}
\usepackage{amsfonts}

\input basic.ltx
\def\directory{EPSF/}

%------------------------------------------------------------------------------
% MAS Additions
\newcommand{\mas}[1]{\textcolor{magenta}{#1}}
\newcommand{\qw}[1]{\textcolor{blue}{#1}}
%useful for showing deleted text
\renewcommand{\kill}[1]{\textcolor{red}{\sout{#1}}}                             

\usepackage[normalem]{ulem}  % mas addition
\newcommand{\uvec}[1]{\bar{#1}}
\newcommand{\tens}[1]{\underline{\underline{#1}}}
\renewcommand{\vec}[1]{\underline{#1}}
\renewcommand{\skew}[1]{\widetilde{#1}}
%------------------------------------------------------------------------------

\title{BeamDyn: A High-Fidelity Wind Turbine Blade Solver in the FAST
Modular Framework}


\author[1]{Qi Wang\thanks{Research Engineer, National Wind Technology Center, AIAA Member. Email: Qi.Wang2@nrel.gov}}
\author[2]{Nick Johnson\thanks{Graduate Research Assistant, Department of
Mechanical Engineering.}}
 \author[1]{Michael A. Sprague\thanks{Senior Research Scientist, 
Computational Science Center.}}
 \author[1]{Jason Jonkman\thanks{Senior Engineer, National Wind Technology Center, AIAA Professional Member.}}
 \affil[1]{National Renewable Energy Laboratory, Golden, CO 80401}
 \affil[2]{Colorado School of Mines, Golden, CO 80401}
 
 \renewcommand\Authands{, and }

\begin{document}

\maketitle

\begin{abstract}
{BeamDyn, a Legendre-spectral-finite-element implementation of geometrically
exact beam theory (GEBT), was developed to meet the design challenges
associated with highly flexible composite wind turbine blades. In this
paper, the governing equations of GEBT are reformulated into a nonlinear
state-space form to support its coupling within the
modular framework of the FAST wind turbine
computer-aided engineering (CAE) tool. Different time integration
schemes (implicit and explicit) were implemented and examined for wind
turbine analysis.  Numerical examples are presented to demonstrate the capability of this new beam solver. An example analysis of a realistic wind turbine blade CX-100 is also presented as validation.}     
\end{abstract}

\section{Introduction} In recent years, wind power installations in the United States have exceeded 60
gigawatts in generation capacity, and have become an increasingly important part of the overall energy
portfolio. Simultaneously, the size of wind turbines has also increased in
the quest for economies of scale.   To ensure the performance and
reliability of wind turbines, it is crucial to use computer-aided engineering (CAE) tools that are capable of analyzing wind
turbine blades accurately and efficiently. Although modern
computers enable three-dimensional (3D) analysis
of a fully resolved blade, such analyses are too
expensive for iterative and probabilistic design. However, composite wind
turbine blades are well represented as nonlinear beam models, which can
capture the deformation response under realistic
operating conditions with high fidelity, and in a small fraction of the time required by a
fully resolved 3D simulation. 

Beam models are widely used to analyze structures in which one dimension is much larger than the other two.  Many engineering
structures such as  bridges, joists, and helicopter
rotor blades may be modeled as beams.  Similarly, beam models are well suited for analyzing wind turbine blades, towers, and shafts.  Most wind turbine
blades are constructed of composite materials, which are more complicated than isotropic beams to analyze because of elastic coupling
effects.  The geometrically exact beam theory (GEBT), first proposed by
Reissner\cite{Ressiner1973}, is a beam-deformation model useful in efficient analysis of highly flexible composite structures.
For instance, GEBT has demonstrated efficacy in helicopter rotor analysis \cite{Hodges:2007}. 
Simo\cite{Simo1985} and Simo and Vu-Quoc\cite{Simo1986} extended Reissner's
work to include 3D dynamic problems. Jeleni\'c and
Crisfield\cite{Crisfield1999} derived a finite-element (FE) method that
interpolates the rotation field, thereby preserving the geometric exactness
of this theory. Notably, Ibrahimbegovi\'c and his colleagues
implemented this theory for static\cite{Ibrahim1995} and
dynamic\cite{Ibrahim1998} analysis. Readers are referred to
Hodges\cite{HodgesBeamBook}, in which comprehensive derivations and discussions
on nonlinear composite-beam theories can be found. Recently, a mixed
 FE formulation of GEBT along with the numerical implementation was presented by
Yu and Blair\cite{YuGEBT}.  

FAST is a CAE tool developed by the National Renewable Energy Laboratory
(NREL) for analyzing both land-based and
offshore wind turbines under realistic operating conditions.  The current
beam model in FAST is not capable of predictive analysis of highly flexible,
composite wind turbine blades.
Recently, FAST has been reformulated under a
new modularized framework that provides a rigorous means by which various
mathematical systems are implemented in distinct modules. These modules are interconnected
to solve for the globally coupled dynamic responses of wind turbines and wind
plants \cite{Jonkman:2013,website:FASTModularizationFramework}.

In this paper, a 3D displacement-based
implementation of geometrically exact beam theory using Legendre
spectral finite elements is presented. The theory is reformulated in a
nonlinear state-space form for the purpose of integrating with the FAST
framework, thereby introducing an optional high-fidelity beam model as an
alternative to the current beam model. Several first-order time integrators, including the explicit fourth-order Runge-Kutta (RK4) and implicit second-order Adams-Moulton (AM2), are examined. This work builds on previous efforts
that demonstrated the implementation of GEBT and spatial discretization using Legendre spectral finite elements
(LSFEs)\cite{Wang:GEBT2013,Wang:SFE2013,Wang:GEBT2014,Sprague:FAST2014} in analyzing composite wind turbine blades. The paper is organized as
follows.  First, the theoretical foundation of the geometrically exact beam
theory along with the reformulation of the governing equations into a
state-space form is introduced. Coupling to the FAST framework is then
discussed. Finally, numerical examples are
provided to verify and validate the accuracy and efficiency of the present model for
composite wind turbine blades. 

~

\section{Geometrically Exact Beam Theory}

This section briefly reviews the geometrically exact beam theory. Further details on the content of this section can be found in many other papers and textbooks \cite{HodgesBeamBook,Bauchau:2010,YuGEBT}.
Figure~\ref{Kinematics} shows a beam in its initial undeformed
and deformed states. A reference frame $\mathbf{b}_i$ is introduced along the
beam axis for the undeformed state and a frame $\mathbf{B}_i$ is introduced
along each point of the deformed beam axis. The curvilinear coordinate $x_1$ defines the intrinsic parameterization of the reference line.
\begin{figure}
\centering
\includegraphics[width=5.0in]{\directory Kinematics.eps}
\caption{A beam deformation schematic.} \label{Kinematics}
\end{figure}
In this paper, matrix notation is used to denote vectorial or vectorial-like quantities. For example, an underline denotes a vector $\underline{u}$, a bar denotes unit vector $\bar{n}$, and a double underline denotes a tensor $\underline{\underline{\Delta}}$. Note that sometimes the underlines only denote the dimension of the corresponding matrix. The governing equations of motion for geometrically exact beam theory can be written as \cite{Bauchau:2010}
\begin{align}
	\label{GovernGEBT-1}
	\dot{\underline{h}} - \underline{F}^\prime &= \underline{f} \\
	\label{GovernGEBT-2}
	\dot{\underline{g}} + \dot{\tilde{u}} \underline{h} - \underline{M}^\prime + (\tilde{x}_0^\prime + \tilde{u}^\prime)^T \underline{F} &= \underline{m}
\end{align}
where $\vec{h}$ and $\vec{g}$ are the linear and angular momenta resolved in the inertial coordinate system, respectively; $\vec{F}$ and $\vec{M}$ are the beam's sectional force and moment resultants, respectively; $\vec{u}$ is the one-dimensional (1D) displacement of a point on the reference line; $\vec{x}_0$ is the position vector of a point along the beam's reference line;  and $\vec{f}$ and $\vec{m}$ are the distributed force and moment applied to the beam structure.  The notation $(\bullet)^\prime$ indicates a derivative with respect to beam axis $x_1$ and $\dot{(\bullet)}$ indicates a derivative with respect to time. The tilde operator $(\skew{\bullet})$ defines a second-order, skew-symmetric tensor corresponding to the given vector. In the literature, it is also termed as ``cross-product matrix". For example,
\[
	\skew{n} = 
	     		\begin{bmatrix}
			0 & -n_3 & n_2 \\
			n_3 & 0 & -n_1 \\
			-n_2 & n_1 & 0\\
			\end{bmatrix}	
\]
The constitutive equations relate the velocities to the momenta and the 1D strain measures to the sectional resultants as
\begin{align}
	\label{ConstitutiveMass}
	\begin{Bmatrix}
	\underline{h} \\
	\underline{g}
	\end{Bmatrix}
	= \underline{\underline{\mathcal{M}}} \begin{Bmatrix}
	\dot{\underline{u}} \\
	\underline{\omega}
	\end{Bmatrix} \\
	\label{ConstitutiveStiff}
	\begin{Bmatrix}
	\underline{F} \\
	\underline{M}
	\end{Bmatrix}
	= \underline{\underline{\mathcal{C}}} \begin{Bmatrix}
	\underline{\epsilon} \\
	\underline{\kappa}
	\end{Bmatrix}
\end{align}
where $\underline{\underline{\mathcal{M}}}$ and
$\underline{\underline{\mathcal{C}}}$ are the $6 \times 6$ sectional mass
and stiffness matrices, respectively (note that they are not really tensors);
$\underline{\epsilon}$ and $\underline{\kappa}$ are the 1D strains and
curvatures, respectively; and, $\underline{\omega}$ is the angular velocity
vector that is defined by the rotation tensor $\underline{\underline{R}}$ as
$\underline{\omega} =
axial(\dot{\underline{\underline{R}}}~\underline{\underline{R}}^T)$. The axial vector $\vec{a}$ associated with a second-order tensor $\tens{A}$ is denoted $\vec{a}=axial(\tens{A})$ and its components are defined as
\begin{equation}
    \label{axial}
    \vec{a} = axial(\tens{A})=\begin{Bmatrix}
    a_1 \\
    a_2 \\
    a_3
    \end{Bmatrix}
    =\frac{1}{2}
    \begin{Bmatrix}
    A_{32}-A_{23} \\
    A_{13}-A_{31} \\
    A_{21}-A_{12}
    \end{Bmatrix}
\end{equation}
The 1D strain measures are defined as
\begin{equation}
    \label{1DStrain}
    \begin{Bmatrix}
        \vec{\epsilon} \\
        \vec{\kappa}
    \end{Bmatrix}
    =
    \begin{Bmatrix}
        \vec{x}^\prime_0 + \vec{u}^\prime - (\tens{R} ~\tens{R}_0) \bar{\imath}_1 \\
        \vec{k}
    \end{Bmatrix}
\end{equation}
where $\vec{k} = axial [(\tens{R R_0})^\prime (\tens{R R_0})^T]$ is the sectional
curvature vector resolved in the inertial basis and $\bar{\imath}_1$ is the unit
vector along $x_1$ direction in the inertial basis. Note that these
three sets of equations, including equations of motion
Eq.~\eqref{GovernGEBT-1} and \eqref{GovernGEBT-2}, constitutive equations
Eq.~\eqref{ConstitutiveMass} and \eqref{ConstitutiveStiff}, and kinematical
equations Eq.~\eqref{1DStrain}, provide a full mathematical description of elasticity problems. 

For a displacement-based finite-element implementation, there are six
degrees of freedom at each node: three displacement components and three
rotation components. Here, $\vec{q}$ denotes the elemental
displacement array as $\underline{q}^T=\left[
\underline{u}^T~~\underline{p}^T\right]$ where $\vec{u}$ is the
displacement and $\vec{p}$ is the rotation-parameter vector. The
acceleration array can thus be defined as $\underline{a}^T=\left[
\ddot{\underline{u}}^T~~ \dot{\underline{\omega}}^T \right]$. For nonlinear
finite-element analysis, the discretized forms of
displacement, velocity, and acceleration are written as
\begin{align}
	\label{DiscretizedDisp}
	\underline{q} (x_1) &= \underline{\underline{N}} ~\hat{\underline{q}}~~~~~~~~\underline{q}^T = \left[ \underline{u}^T~~\underline{p}^T \right] \\
	\label{DiscretizedVel}
	\underline{v}(x_1) &= \underline{\underline{N}}~\hat{\underline{v}}~~~~~~~~\underline{v}^T = \left[\underline{\dot{u}}^T~~\underline{\omega}^T \right] \\
	\label{DiscretizedAcc}
	\underline{a}(x_1) &= \underline{\underline{N}}~ \hat{\underline{a}}~~~~~~~~\underline{a}^T = \left[ \ddot{\underline{u}}^T~~\dot{\underline{\omega}}^T \right]	
\end{align}
where $\tens{N}$ is the shape function matrix and $(\hat{\cdot})$ denotes a
column matrix of nodal values.

\section{State-Space Formulation}
NREL has put considerable effort into improving the modularity of FAST.  The benefits of this modularization framework include, but are not limited to, improving numerical performance as well as robustness and enhancing the flexibility and expandability to enable further developments of functionality. The modules in the new framework are coupled in two ways in the time domain: loose and tight. In the loose coupling scheme, data are exchanged between the modules at each coupling step, but each module tracks its own states and integrates its own equations with its own solver. FAST  pre-v8.0 used this scheme. In a tightly coupled time-integration scheme, each module sets up its own equations, but the states are tracked and integrated by a solver common to all of the modules. FAST v8.0 modularization allows for both loose and tight coupling. More details on the FAST modularization framework and an initial assessment of the numerical stability, numerical accuracy, and computational performance of various coupling schemes can be found in \cite{Jonkman:2013,Sprague:2013,Sprague:FAST2014}. 

To accommodate the tight coupling scheme in the FAST modular framework, the governing equations 
\eqref{GovernGEBT-1} and \eqref{GovernGEBT-2} needed to be reformulated
into a state-space form. First, these equations are recast in compact form
as
\begin{equation}
    \label{CompactGovernGEBT}
    \underline{\mathcal{F}}^I - \underline{\mathcal{F}}^{C\prime} + \underline{\mathcal{F}}^D = \underline{\mathcal{F}}^{ext}
\end{equation}
where $\underline{\mathcal{F}}^I, \underline{\mathcal{F}}^C$ and $\underline{\mathcal{F}}^D$, and $\underline{\mathcal{F}}^{ext}$ are the inertial forces, elastic forces, and externally applied forces, respectively; their definitions are
\begin{align}
    \label{InertialForce}
    \underline{\mathcal{F}}^I &= \begin{Bmatrix}
    \dot{\underline{h}} \\
    \dot{\underline{g}}
    \end{Bmatrix}
    + \begin{bmatrix}
    \underline{\underline{0}} & \underline{\underline{0}} \\
    \dot{\tilde{u}}  &  \underline{\underline{0}}
    \end{bmatrix}
    \begin{Bmatrix}
    \vec{h} \\
    \vec{g}
    \end{Bmatrix} \\
    \label{ElasticForceFc}
     \underline{\mathcal{F}}^C &= \begin{Bmatrix}
    \underline{F} \\
    \underline{M}
    \end{Bmatrix} \\
    \label{ElasticForceFd}
    \underline{\mathcal{F}}^D &= \begin{Bmatrix}
    \underline{0} \\
    (\tilde{x}^\prime_0 + \tilde{u}^\prime)^T \underline{F}
    \end{Bmatrix} \\
    \label{AppliedForce}
    \underline{\mathcal{F}}^{ext} &= \begin{Bmatrix}
    \underline{f} \\
    \underline{m}
    \end{Bmatrix}
\end{align}   
Along with the constitutive equations \eqref{ConstitutiveMass} and \eqref{ConstitutiveStiff}, the inertial force $\underline{\mathcal{F}}^I$ can be written explicitly as
\begin{align}
    \underline{\mathcal{F}}^I &= \begin{Bmatrix}
    m \ddot{\underline{u}} + ( \dot{\tilde{\omega}} + \tilde{\omega} \tilde{\omega} ) m \underline{\eta} \\
    m \tilde{\eta} \ddot{\underline{u}} + \underline{\underline{\varrho}} \dot{\underline{\omega}} + \tilde{\omega}  \underline{\underline{\varrho}} \underline{\omega} 
    \end{Bmatrix} \nonumber \\
    \label{InertialForce2}
    &= \begin{bmatrix}
    m \underline{\underline{I}} & m \tilde{\eta}^T \\
    m \tilde{\eta} & \underline{\underline{\varrho}}
    \end{bmatrix}
    \begin{Bmatrix}
    \ddot{\underline{u}} \\
    \dot{\underline{\omega}}
    \end{Bmatrix} + 
    \begin{bmatrix}
    \underline{\underline{0}} & m \tilde{\omega} \tilde{\eta}^T \\
    \underline{\underline{0}} & \tilde{\omega}  \underline{\underline{\varrho}}
    \end{bmatrix}
    \begin{Bmatrix}
    \dot{\underline{u}} \\
    \underline{\omega}
    \end{Bmatrix} \\
    &  \equiv \tens{\mathfrak{M}} \underline{a} + \underline{\underline{\mathcal{G}}} \underline{v}  \nonumber     
\end{align}
where $m$ is the mass density per unit span; $\underline{\eta}$ is the
center of mass location;  $\underline{\underline{\varrho}}$ is the moment of
inertia; and $\tens{I}$ is the identity matrix. The definitions of the acceleration vector $\underline{a}$ and velocity vector $\underline{v}$ can be found in Eq.~\eqref{DiscretizedAcc} and \eqref{DiscretizedVel}, respectively. Using the newly introduced matrices, the compact form of the equations of motion can be rewritten as
\begin{equation}
    \label{CompactForm2}
    \underline{\underline{\mathfrak{M}}}~ \underline{a} + f(\underline{q},\underline{v},t) = 0
\end{equation}
where
\begin{equation}
    \label{CompactForm3}
    f(\underline{q},\underline{v},t) = \underline{\mathcal{F}}^F - \underline{\mathcal{F}}^{C\prime} + \underline{\mathcal{F}}^D - \underline{\mathcal{F}}^{ext}
\end{equation}
\begin{align}
    \underline{\mathcal{F}}^F &= \underline{\underline{\mathcal{G}}} \underline{v}  \nonumber \\
    \label{CompactForm4}
    &= \begin{bmatrix}
    \underline{\underline{0}} & m \tilde{\omega} \tilde{\eta}^T \\
    \underline{\underline{0}} & \tilde{\omega}  \underline{\underline{\varrho}}
    \end{bmatrix}
    \begin{Bmatrix}
    \dot{\underline{u}} \\
    \underline{\omega}
    \end{Bmatrix} 
\end{align}

A weighted residual formulation is used to enforce the dynamic equilibrium conditions in Eq.~\eqref{CompactForm2}
\begin{equation}
    \label{FEM-1}
    \int_0^l \tens{N}^T (\tens{\mathfrak{M}} \vec{a} + \vec{\mathcal{F}}^F - \vec{\mathcal{F}}^{C\prime} + \vec{\mathcal{F}}^D - \vec{\mathcal{F}}^{ext}) d x_1=0
\end{equation}
The above equation can be recast as
\begin{equation}
    \label{FEM-2}
    \tens{M} \hat{a} = F(\vec{q},\vec{v},t)
\end{equation}
where
\begin{align}
    \label{FEM-3}
    \tens{M} &= \int_0^l \tens{N}^T \tens{\mathfrak{M}}~ \tens{N}~dx_1 \\
    \label{FEM-4}
    \vec{F}(\vec{q},\vec{v},t) &= \int_0^l \tens{N}^T (-\vec{\mathcal{F}}^F + \vec{\mathcal{F}}^{C\prime} - \vec{\mathcal{F}}^D + \vec{\mathcal{F}}^{ext}) d x_1
\end{align}

To derive the state-space form of the governing equations,  $\vec{x}(t)$ is introduced as
\begin{equation}
    \label{StateSpaceX}
    \vec{x}(t) \equiv \begin{Bmatrix}
    \vec{q}(t) \\
    \vec{v}(t)
    \end{Bmatrix} 
\end{equation}
Note that the second component of $\vec{x}(t)$ is not $\vec{\dot{q}}$ but $\vec{v}$ because the angular velocity $\vec{\omega}$ cannot be calculated as the time derivative of the rotation parameter $\vec{p}$. The angular velocity is related to the rotation parameter by the tangent matrix as $\omega = \tens{H}(p) \dot{\vec{p}}$. Substituting the discretized quantities in Eqs.~\eqref{DiscretizedDisp} to \eqref{DiscretizedAcc} into Eq.~\eqref{StateSpaceX} and using the relation
\begin{equation}
    \label{AccVel}
    \vec{a} = \vec{\dot{v}} = \begin{Bmatrix}
    \vec{\ddot{u}} \\
    \vec{\dot{\omega}}
    \end{Bmatrix}
\end{equation}
The state-space form can be obtained as
\begin{align}
    \label{StateSpaceGov-1}
    \tens{A} ~\dot{\hat{\vec{x}}}(t) &= \mathfrak{f}(\hat{\vec{x}}(t),t) \\
    \label{StateSpaceGov-2}
    \hat{\vec{x}}(0) &= \hat{\vec{x}}_0
\end{align}
where
\begin{align}
    \label{StateSpaceGov-3}
    \tens{A} (\hat{\vec{x}}(t)) &= \begin{bmatrix}
    \tens{D} & \tens{0} \\
    \tens{0} & \tens{M}
    \end{bmatrix}  \\
    \label{StateSpaceGov-4}
    \tens{D} (\hat{\vec{x}}(t)) &= \int_0^l \tens{N}^T \begin{bmatrix}
    \tens{I}_3 & \tens{0} \\
    \tens{0} & \tens{H}
    \end{bmatrix} 
    \tens{N}~dx_1 \\
    \label{StateSpaceGov-5}
    \mathfrak{f}(\hat{\vec{x}}(t),t) &=  \begin{Bmatrix}
    \int_0^l \tens{N}^T \vec{v}~dx_1 \\
    \vec{F}(\hat{\vec{x}}(t),t)
    \end{Bmatrix} \\
    \label{StateSpaceGov-7}
    \hat{\vec{x}}_0 &= \begin{Bmatrix}
    \hat{\vec{q}}_0 \\
    \hat{\vec{v}}_0
    \end{Bmatrix}
\end{align}
Note that the state-space form, in
Eq.~\eqref{StateSpaceGov-1} and \eqref{StateSpaceGov-2}, can be solved with
any number of first-order ordinary differential equations (ODE) integrators
for first-order-in-time systems. 

\section{Implementation of BeamDyn}
The state-space form of GEBT was numerically implemented into a beam solver, called BeamDyn. BeamDyn has two sources of input:  the users and FAST driver code. The inputs from the users are:
\begin{enumerate}
    \item Key points that defined the geometry of the beam
    \item Sectional constants for a 1D beam model
    \item Finite-element mesh information (order of element)
    \item Selection of static or dynamic analysis
    \item Time integrators: RK4, AM2, or Generalized-$\alpha$ (for loosing coupling only).
\end{enumerate}
Information that comes from FAST driver code include the gravity vector, time step size, initial conditions, and the externally applied loads.  For whole turbine analysis, the BeamDyn module will return kinematical quantities, displacements and rotation tensors, as well as reaction force and moment resultants to FAST for aeroelastic and control analysis.

The implementation of GEBT with RK4 is straightforward; however, for the AM2 scheme, a linearization is required because of its implicit nature. By applying the trapezoidal rule, the state-space form in Eq.~\eqref{StateSpaceGov-1} can be recast as
\begin{equation}
    \label{AM2-Govn}
    \tens{A}_{k+1} (\hat{\vec{x}}_{k+1}-\hat{\vec{x}}_{k})+\tens{A}_k \hat{\vec{x}}_{k+1} - \Delta t \mathfrak{f}(\hat{\vec{x}}_{k+1},t_{k+1}) = \tens{A}_k \hat{\vec{x}}_{k} + \Delta t \mathfrak{f}(\hat{\vec{x}}_{k},t_{k}) 
\end{equation}
where the footnote denotes the discretized time step in which the value is evaluated, and $\Delta t$ is the time step size. A linearization is needed to solve this nonlinear equation. The linearized equation is as follows
\begin{equation}
    \label{AM2-Linearized}
    \begin{bmatrix}
    \hat{\tens{K}}_1 & \hat{\tens{C}}_1 \\
    \hat{\tens{K}}_2 & \hat{\tens{C}}_2
    \end{bmatrix}
    \begin{Bmatrix}
    \Delta \hat{\vec{q}} \\
    \Delta \hat{\vec{v}}
    \end{Bmatrix}
    =
    \begin{Bmatrix}
    \hat{\vec{F}}_1 \\
    \hat{\vec{F}}_2
    \end{Bmatrix}
\end{equation}
The coefficient matrices are written as
\begin{align}
    \label{Linear-K1}
    \hat{\tens{K}}_1 &= \int_0^l \tens{N}^T\tens{K}_1~\tens{N}~dx_1 \\
    \label{Linear-C1} 
    \hat{\tens{C}}_1 &= \int_0^l \tens{N}^T\tens{C}_1~\tens{N}~dx_1 \\
    \label{Linear-K2}
    \hat{\tens{K}}_2 &= \int_0^l \left[ \tens{N}^T (\tens{A}_2 - \tens{A}_3 + \Delta t \tens{A}_5 + \Delta t \mathcal{Q}) \tens{N} + \tens{N}^T \Delta t \tens{\mathcal{P}}~ \tens{N}^\prime + \tens{N}^{\prime T} \Delta t \tens{\mathcal{S}}~ \tens{N}^\prime + \tens{N}^T \Delta t \tens{\mathcal{O}}~ \tens{N} \right]~dx_1 \\
    \label{Linear-C2}
    \hat{\tens{C}}_2 &= \int_0^l \tens{N}^T (\tens{\mathfrak{M}}+\tens{\mathfrak{M}}_k+\Delta t \tens{A}_4)~\tens{N}~dx_1
\end{align}
where the newly introduced matrices are
\begin{align}
   \label{K1}
   \tens{K}_1 &=
   \begin{bmatrix}
   2 \tens{I}_3 & \tens{0} \\
   \tens{0} & \tens{B} + \tens{H} - \tens{B}_k + \tens{H}_k
   \end{bmatrix} \\
   \label{C1}
   \tens{C}_1 &=
   \begin{bmatrix}
   \tens{I}_3 & \tens{0} \\
   \tens{0} & \tens{I}_3 
   \end{bmatrix} \\
   \label{A2}
   \tens{A}_2 &=
    \begin{bmatrix}
   \tens{0} & m \tilde{\omega} \tilde{\eta}^T \\
   \tens{0} & m \dot{\tilde{u}} \tilde{\eta}+\tens{\rho} \tilde{\omega}-\widetilde{\tens{\rho}\vec{\omega} }
   \end{bmatrix} \\
   \label{A3}
   \tens{A}_3 &=
    \begin{bmatrix}
   \tens{0} & m \tilde{\omega}_k \tilde{\eta}^T \\
   \tens{0} & m \dot{\tilde{u}}_k \tilde{\eta}+\tens{\rho} \tilde{\omega}_k-\widetilde{\tens{\rho}\vec{\omega}_k}
   \end{bmatrix} \\
   \label{A4}
   \tens{A}_4 &=
    \begin{bmatrix}
   \tens{0} & \widetilde{\tilde{\omega}m\vec{\eta}}^T+\tilde{\omega}m\tilde{\eta}^T \\
   \tens{0} & \widetilde{\tens{\rho}\vec{\omega}}^T+\tilde{\omega}\tens{\rho}
   \end{bmatrix} \\
   \label{A5}
   \tens{A}_5 &=
    \begin{bmatrix}
   \tens{0} & \tilde{\omega} \tilde{\omega} m \tilde{\eta}^T \\
   \tens{0} & \tilde{\omega} (\tens{\rho} \tilde{\omega} - \widetilde{\tens{\rho} \vec{\omega}}
   \end{bmatrix} 
\end{align}
The $\tens{\mathcal{O}}$, $\tens{\mathcal{P}}$, $\tens{\mathcal{Q}}$, and $\tens{\mathcal{S}}$ can be found in previous work by Want et al \cite{Wang:GEBT2014}. It is also noted that the $\tens{B}$ matrix is a linearization of the tangent matrix $\tens{H}$ defined as
\begin{equation}
    \label{Bmatrix}
    \tens{B}(\vec{p},\vec{a}) = \frac{\partial (\tens{H}(\vec{p})) \vec{a}}{\partial \vec{p}}
\end{equation}

One major difficulty in implementing geometrically nonlinear theory is the description of rotations in 3D space. As discussed in many articles \cite{Crisfield:1999,Bauchau:2010,Bottasso:1998}, there will be a singular point for any type of vectorial parameterization. To address this singular point, we implemented an algorithm proposed by Crisfield and Jeleni\'c \cite{Crisfield:1999}, in which the relative rotations are interpolated instead of the total rotations in one element. Although the magnitude of the total rotation may be large, it is reasonable to assume that the relative rotation in one finite element is smaller than $\pi$. In the time domain, all the nodes need to be rescaled at the same time so the highly nonlinear governing equations in Eq.~\eqref{GovernGEBT-1} and \eqref{GovernGEBT-2} are linearized about the correct point.

In summary, the newly developed BeamDyn has the following features: 
\begin{enumerate}
    \item It is based on the state-space form of geometrically exact beam theory, thus, it can be easily integrated into FAST as a structural module for tight-coupling scheme using first-order time integrators
    \item The spectral finite-element method is used to discretize the space domain; exponential convergence rate can be expected for smooth field
    \item It is compatible with the FAST modularization network. Variables are categorized into input, output, states, and parameters.
\end{enumerate}

\section{BeamDyn Verification and Validation}
In this section, several numerical cases to verify and validate BeamDyn against numerical solutions and experimental data are presented. As discussed in the introduction, modern wind turbine blade features include initial twists/curvatures, elastic coupling, and high flexibility. BeamDyn's capabilities in addressing these features are examined.

\subsection{Initially Twisted/Curved Beams}

An initially twisted beam was examined first. A straight beam ($k_2=k_3=0$) with an initial twist ($k_1\neq 0$) is shown in Figure~\ref{Twist1}. The beam is linearly twisted in the positive $\theta_1$ direction from 0 degrees at the root to 90 degrees at the tip.
\begin{figure}
\centering
\includegraphics[width=5.0in]{\directory twist_beam.eps}
\caption{Sketch of an initially twisted beam.} 
\label{Twist1}
\end{figure}
 Table~\ref{E1Property} shows the material properties for A36 steel, the beam geometry, and the force applied to the beam. The height and base values reported in the table are the height and base of the rectangular cross section. 
 \begin{table}
\caption{\label{E1Property} Properties of twisted beam}
\begin{center}
    \begin{tabular}{| l | l |}
    	\hline
    	Property               & Value   \\ \hline
    	Elastic Modulus                      & 200 gigapascals (GPa) \\ \hline
    	Shear Modulus                      & 79.3 GPa \\ \hline
    	Height                      & 0.5 meters (m)   \\ \hline
    	Base                      & 0.25 m  \\ \hline
    	Length                      & 10 m    \\ \hline
    	Force                      & 4000 kilonewtons (kN) \\ \hline
    \end{tabular}
\end{center}
\end{table}
The beam was discretized using a seventh-order LSFE. It is widely known that the well-refined 3D finite-element solution can be considered exact; here we use the 3D results as benchmark solutions. The results for the twisted beam are shown in Table~\ref{E1u} and compared to the baseline results obtained from 3D ANSYS analysis using SOLID186 elements. It can be seen that the percent errors of the two methods are very small.
\begin{table}
\caption{\label{E1u} Comparison of tip displacements of an initially twisted beam} 
\begin{center} 
    \begin{tabular}{| l | l | l | l | l | l | l |}
    	\hline
    	        & $u_1$ (m) & $u_2$ (m) & $u_3$ (m)  \\ \hline
    	BeamDyn  & -1.132727     & -1.715123       & -3.578671      \\  \hline
    	ANSYS   & -1.134192     & -1.714467      & -3.584232     \\ \hline
    	Percent Error   & 0.129     & 0.038      & 0.155     \\ \hline
    \end{tabular}
\end{center}
\end{table} 

Next, an initially curved beam was examined. It is clear that the initial curvature plays a major role in the distribution of the elastic forces within the beam. As such, it is very important to ensure that BeamDyn is capable of modeling this effect properly. A widely used benchmark problem for a curved beam is the case proposed by Bathe \cite{Bathe1979}, which was analyzed for verification. Figure~\ref{E1Curved} shows the configuration of the cantilevered curved beam being analyzed. The beam is in the $x_1$, $x_2$ plane, the positive $x_1$ direction and the negative $x_2$ direction. A force of 600 pounds is applied in the positive $x_3$ direction. The beam is defined by the 45-degree arc of a 100-inch radius centered at 100 inches in the negative $x_2$ direction.  The geometry of the cross section for the curved beam is square, and the material properties can be found in Ref.[20]. 
\begin{figure}
\centering
\includegraphics[width=2.5in]{\directory E1Curved.eps}
\caption{Sketch of an initially curved beam.} 
\label{E1Curved}
\end{figure}
The beam was discretized by a fifth-order LSFE. The results of this static analysis are shown in Table~\ref{E1CurvedDisp} and compared to the results published in Bathe \cite{Bathe1979}.

\begin{table}
\caption{\label{E1CurvedDisp} Comparison of tip displacements of an initially curved beam } 
\begin{center}
    \begin{tabular}{| l | l | l | l | l | l | l |}
    	\hline
    	        & $u_1$ (inches) & $u_2$ (inches) & $u_3$ (inches)  \\ \hline
    	BeamDyn (one LSFE) & -23.7     & 13.5       & 53.4      \\  \hline
    	Bathe-Bolourchi \cite{Bathe1979}   & -23.5     & 13.4       & 53.4     \\ \hline
    \end{tabular}
\end{center}
\end{table} 

It can be seen from these results that the simulations from BeamDyn for a initially curved beam match quite well with the published results. The results of these cases suggest that BeamDyn is capable of modeling beams with initial twist and curvatures.

\subsection{Static Analysis of CX-100 Blade}
The primary intended use of BeamDyn is analyzing anisotropic wind turbine blades, therefore, the CX-100 was chosen as a validation case. The CX-100 is a 9-m blade designed by Sandia National Laboratories \cite{paquette2006modeling}. It was chosen for this analysis because it is well characterized, with a wealth of publicly available data regarding its construction and material properties.

The cross-sectional properties for this beam were provided by D.J.\ Luscher of Los Alamos National Laboratory. These properties were provided at 40 points along the beam. A typical stiffness matrix is shown at 2.2 m along the span of the blade, and is given by
\begin{align*}
C =10^3 \times \begin{bmatrix}
	193,000 & -75.4   & 12.2   & -75.2  & -1970    & -3500    \\
	-75.4  & 19,500 & 4,760   & 62.6  & 67.3    & 11.3    \\
	12.2  & 4,760   & 7,210 & -450  & 17.0    & 2.68    \\
	-75.2  & 62.6   & -450   & 518 & 1.66    & -1.11    \\
	-1,970  & 67.3   & 17.0   & 1.66  & 2,280 & -879    \\
	-3,500  & 11.6   & 2.68   & -1.11  & -875    & 4,240
\end{bmatrix}
\end{align*}
where the units associated with stiffness values are $C_{ij}$ ($N$), $C_{i,j+3}$ ($N \cdot m$), and $C_{i+3,j+3}$ ($N \cdot m^2$) for $i,j = 1,2,3$.

Figure~\ref{CX100Sketch} \cite{paquette2006modeling} shows the various material layups and the geometry of the CX-100 blade. Each color represents a section with unique material properties. Figure~\ref{normalized1} shows the normalized bending stiffness along the length of the blade where sharp gradient in the beam axial direction can be observed. The graph shows that the bending stiffness jumped to about 10\% of its root value in under 10\% of the blade length.

\begin{figure}
\centering
\includegraphics[width=3.0in]{\directory CX100Sketch.eps}
\caption{Material layup and geometry of the CX-100 wind turbine blade\cite{paquette2006modeling}.} 
\label{CX100Sketch}
\end{figure}

\begin{figure}
\centering
\includegraphics[width=3.0in]{\directory normalized1.eps}
\caption{Normalized bending stiffness as a function of normalized blade length.} 
\label{normalized1}
\end{figure}

Figure~\ref{CX100Setup} \cite{paquette2006modeling} shows the test configuration for the static test performed at the National Wind Technology Center (NWTC) in Boulder, Colorado. The whiffle-tree configuration applied the load at 3.00 m, 5.81 m, and 7.26 m from the root of the blade to achieve a maximum root moment of 128.6 kN m. The loads and positions are given in Table~\ref{CX100Load} below.


\begin{figure}
\centering
\includegraphics[width=5.0in]{\directory CX100Setup.eps}
\caption{Test configuration for the static pull test conducted at the NWTC \cite{paquette2006modeling}.} 
\label{CX100Setup}
\end{figure}

\begin{table} 
\caption{\label{CX100Load}Positions and applied loads during the CX-100 static loads testing at the NWTC  } 
\begin{center}
    \begin{tabular}{| l | l |l |}
    	\hline
    	 Saddle \# &     Position (m) & Applied Load (kN)  \\ \hline
    1&	3.00 & 16.9         \\  \hline
    2&	5.81   & 5.47         \\ \hline
    3&	    	7.26   & 5.59         \\ \hline
    \end{tabular}
\end{center}
\end{table}

The displacements, $u_3$, at each of the load points were tracked for the experiment and are given in Table~\ref{CX100Results}. The BeamDyn simulation was completed using four seventh-order LSFEs and the results are given in Table~\ref{CX100Results}.

\begin{table}
\caption{\label{CX100Results}Experimental and BeamDyn simulation results for the CX-100 static test  } 
\begin{center}
    \begin{tabular}{| l | l | l | l |}
    	\hline
    	             & $u_3$ at saddle \#1 (m) & $u_3$ at saddle \#2 (m) & $u_3$ at saddle \#3 (m) \\ \hline
    	Experimental & 0.083530             & 0.381996               & 0.632460             \\ \hline
    	BeamDyn      & 0.072056               & 0.381074                & 0.698850           \\ \hline
    	    	Percent Error      &        13.74        & 0.24                & 10.5           \\ \hline
    \end{tabular}
\end{center}
\end{table} 
The displacements are plotted in Figure~\ref{CX100Disp} and are overall in good agreement. The maximum tip displacement in the experimental data was 1.03 m, whereas the maximum tip displacement in the BeamDyn simulation was 1.12 m. This discrepancy has previously been explained\cite{Luscher:2013} as a difference in the rigidity of the boundary conditions when calculating the two-dimensional (2D) sectional properties with VABS. Because this work uses the sectional properties of the previous publication, it was reasonable that this work has also found similar errors and effects. It should also be noted that the tip displacement was not directly measured in the experiment \cite{paquette2006modeling}, but was extrapolated based on the recoded data at 3.00 m, 5.81 m, and 7.26 m.

\begin{figure}
\centering
\includegraphics[width=3.0in]{\directory CX100Disp.eps}
\caption{Displacement $u_3$ along the length of the blade for experimental data and BeamDyn simulation.} 
\label{CX100Disp}
\end{figure}

Next, a convergence study of the tip displacements was completed for the CX-100 blade in BeamDyn. Figure~\ref{CX100conv3} shows the error as a function of the number of nodes. The percentage error was calculated against the experimental data in Table~\ref{CX100Results}. It can be seen that the convergence rate is not exponential as desired. This is likely a function of the sharp gradients in the sectional constants. For the next simulation, the blade was meshed such that the element boundaries coincide with the locations where the sectional properties are defined. As previously mentioned, the cross-sectional properties for the CX-100 blade were given at 40 locations along the length of the blade. To have an element coincide with each sectional property, 39 LSFEs were needed. Figure~\ref{CX100elem2} shows the results of this simulation. Each circle on the plot indicates an additional order of the LSFE, with the maximum being six. These results demonstrated that  exponential convergence was achieved with this simulation, albeit with many elements. It can therefore be stated that for composite beams with sharp gradients in the cross-sectional stiffness matrix, the spectral convergence is compromised. It should be noted here that although the convergence rate suffers as a result of sharp gradients in the cross-sectional stiffness matrix, the simulations still return reasonable results in comparison to the experiment data, suggesting that a lack of exponential convergence does not compromise the utility of BeamDyn.
  

\begin{figure}
\centering
\includegraphics[width=3.0in]{\directory CX100conv3.eps}
\caption{Error in $u_3$ as a function of the number of nodes.} 
\label{CX100conv3}
\end{figure}

\begin{figure}
\centering
\includegraphics[width=3.0in]{\directory CX100elem2.eps}
\caption{Error in $u_3$ compared to a highly refined solution in BeamDyn as a function of the number of nodes for 39 first- to sixth-order LSFEs, coincident with sectional properties.} 
\label{CX100elem2}
\end{figure}

\subsection{Dynamics of the CX-100 Blade}

The final test case illustrates that BeamDyn is capable of accurately analyzing dynamic movement. In this analysis, the CX-100 blade was given a constant rotational velocity while a gravity force load was applied. A boundary condition was specified such that the blade was allowed to rotate about the node located at its root. This test case was analyzed in both BeamDyn and Dymore, a finite-element-based multibody dynamics code based on the same beam theory. The beam was discretized by a eighth-order element in BeamDyn, and 40 third-order elements in Dymore. The angular velocity of the blade was $\frac{\pi}{3}$ rad/s. The time integrator for the dynamic case was a Runge-Kutta fourth-order method, and the time step size was $5 \times 10^{-5}$ s. The time integrator for Dymore was the generalized-alpha time integrator, with a time step size of $1 \times 10^{-3}$ s. The total simulation time in both BeamDyn and Dymore was 6 s so that the blade rotated a whole circle.

Figure~\ref{E3U} shows the time history for all displacements and rotations given by BeamDyn and Dymore. The displacements mostly agree, and the root-mean-square error for $u_3$ is 0.0335. The error was calculated using
\begin{equation}
\varepsilon_{RMS}=\sqrt{\frac{\sum_{k=0}^{n_{max}}[u_3^k-u_b(t^k)]^2}{\sum_{k=0}^{n_{max}}[u_b(t^k)]^2}}
\end{equation} 
where $u_b(t)$ is the benchmark solution as given by Dymore.
\begin{figure}
    \centering
    \begin{tabular}{c}
    \subfloat[$u_1$]{\label{E3U:u1}\includegraphics[width=3.0 in]{\directory  E3Tipu1.eps}} \qquad
\subfloat[$u_2$]{\label{E3U:u2}\includegraphics[width=3.0in]{\directory  E3Tipu2.eps}} \\
\subfloat[$u_3$]{\label{E3U:u3}\includegraphics[width=3.0 in]{\directory  E3Tipu3.eps}} \qquad
\subfloat[$p_1$]{\label{E3U:p1}\includegraphics[width=3.0 in]{\directory  E3Tipp1.eps}} \\
\subfloat[$p_2$]{\label{E3U:p2}\includegraphics[width=3.0 in]{\directory  E3Tipp2.eps}} \qquad
\subfloat[$p_3$]{\label{E3U:p3}\includegraphics[width=3.0 in]{\directory  E3Tipp3.eps}} \\
\end{tabular}
\caption{Tip displacement and rotation histories of a CX-100 blade rotating at a constant speed.}
\label{E3U}
\end{figure} 
Figure~\ref{E3RootM2} shows the root forces in the no-gravity-load-applied and gravity-load-applied cases. As expected, the root forces were higher for the case where the gravity force was applied.
\begin{figure}
\centering
\includegraphics[width=3.0in]{\directory E3RootM2.eps}
\caption{Root forces on the CX-100 blade in a BeamDyn dynamic simulation with and without gravity load.} 
\label{E3RootM2}
\end{figure}

 \section{Summary}
  This paper reported on the development of BeamDyn, a beam solver in the FAST modularization framework. Geometrically exact beam theory has been reformulated into the first-order state-space form so that first-order time integrators, as required by FAST framework for tight-coupling analysis, can be applied to discretize the problem in the time domain. Numerical examples are provided to validate the capability of BeamDyn in analyzing initially curved/twisted beams. A validation example is also presented where the numerical results are compared with experimental data. In all the cases, good agreement was observed. Finally, the dynamic behavior of the CX-100 wind turbine blade was studied by prescribing a rotation at its root. The convergence rate for analysis of realistic wind turbine blade is discussed. Future work includes the proposal of a practical approach to smooth the geometry and sectional constraints to help achieve the expected exponential convergence rate. In addition, this module will be coupled to FAST and verification and validation will be conducted on the full wind turbine system. 
  
\section*{Acknowledgments} 

This work was supported by the U.S. Department of Energy under Contract No.\
DE-AC36-08GO28308 with the National Renewable Energy Laboratory. Funding for the work was provided by the DOE Office of Energy Efficiency and Renewable Energy, Wind and Water Power Technologies Office. Support
was also provided through a laboratory directed research and development grant
\textit{High-Fidelity Computational Modeling of Wind-Turbine Structural
Dynamics}. The authors would also like to acknowledge D.J. Luscher for CX-100 sectional data.
  
  

\bibliographystyle{aiaa}
\bibliography{references}

\end{document}
