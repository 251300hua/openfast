
generate_f90_types(src/Registry_NWTC_Library_typedef_nomesh.txt
  NWTC_Library_Types.f90 -noextrap)

set(NWTCLIBS_SOURCES
  src/ModMesh.f90
  src/ModMesh_Mapping.f90
  src/ModMesh_Types.f90
  src/NWTC_Base.f90
  src/NWTC_IO.f90
  src/NWTC_Library.f90
  src/NWTC_Num.f90
  src/SingPrec.f90

  # NetLib sources
  src/NetLib/Dierckx_FitPack/dierckx_fitpack.f
  src/NetLib/fftpack/fftpack4.1.f
  src/NetLib/scalapack/dlasrt2.f
  src/NetLib/scalapack/slasrt2.f
  src/NetLib/Dierckx_FitPack/NWTC_FitPack.f90
  src/NetLib/fftpack/NWTC_FFTPACK.f90
  src/NetLib/lapack/NWTC_LAPACK.f90
  src/NetLib/scalapack/NWTC_ScaLAPACK.f90

  # Autogenerated files
  NWTC_Library_Types.f90
  )

get_filename_component(FCNAME ${CMAKE_Fortran_COMPILER} NAME)

if (APPLE OR UNIX)
  if (FCNAME MATCHES "gfortran.*")
    list(APPEND NWTCLIBS_SOURCES src/SysGnuLinux.f90)
  elseif (FCNAME MATCHES "ifort.*")
    list(APPEND NWTCLIBS_SOURCES src/SysIFL.f90)
  endif(FCNAME MATCHES "gfortran.*")
elseif(WIN32)
  if (FCNAME MATCHES "gfortran.*")
    list(APPEND NWTCLIBS_SOURCES src/SysGnuWin.f90)
  elseif (FCNAME MATCHES "ifort.*")
    list(APPEND NWTCLIBS_SOURCES src/SysIFV.f90)
  endif(FCNAME MATCHES "gfortran.*")
endif (APPLE OR UNIX)

add_library(nwtclibs ${NWTCLIBS_SOURCES})
target_link_libraries(nwtclibs ${LAPACK_LIBRARIES} ${CMAKE_DL_LIBS})

install(TARGETS nwtclibs
  LIBRARY DESTINATION "${CMAKE_INSTALL_PREFIX}/lib"
  ARCHIVE DESTINATION "${CMAKE_INSTALL_PREFIX}/lib")
