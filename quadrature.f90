      subroutine quadrature(n, xj, wj)

      integer n
      double precision xj(30),wj(30)


      integer i


      if (n.gt.22) stop 'problem in quadrature.f'
      do 11 i = 1, 30
       xj(i) = 0.d0 
       wj(i) = 0.d0 
11    continue
      if (n.eq.1) then
       xj(1) = -1.d0 
       xj(2) = +1.d0 
       wj(1) = 1.d0
       wj(2) = 1.d0
      else if (n.eq.2) then
       xj(1) = -1.d0
       xj(2) = +0.d0
       xj(3) = +1.d0
       wj(1) = 1.d0/3.d0
       wj(2) = 4.d0/3.d0 
       wj(3) = 1.d0/3.d0
      else if (n.eq.3) then
       xj(1) = -1.d0
       xj(2) = -0.447213595499957939281834733746d0
       xj(3) = -xj(2)
       xj(4) = +1.d0
       wj(1) = 1.d0/6.d0
       wj(2) = 5.d0/6.d0 
       wj(3) = 5.d0/6.d0
       wj(4) = 1.d0/6.d0
      else if (n.eq.4) then
       xj(1) = -1.d0
       xj(2) = -0.654653670707977143798292456247d0
       xj(3) =  0.d0
       xj(4) = +0.654653670707977143798292456247d0
       xj(5) = +1.d0
       wj(1) = 0.1d0
       wj(2) = 0.5444444444444444444444444444444d0
       wj(3) = 0.7111111111111111111111111111111d0
       wj(4) = 0.5444444444444444444444444444444d0
       wj(5) = 0.1d0
      else if (n.eq.5) then
       xj(1) = -1.d0
       xj(2) = -0.765055323929464692851002973959d0
       xj(3) = -0.285231516480645096314150994041d0
       xj(4) = -xj(3)
       xj(5) = -xj(2)
       xj(6) = -xj(1)
       wj(1) = 0.066666666666666666666666666667d0
       wj(2) = 0.378474956297846980316612808212d0
       wj(3) = 0.55485837703548635301672052512d0
       wj(4) = wj(3)
       wj(5) = wj(2)
       wj(6) = wj(1)
      else if (n.eq.6) then
       xj(1) = -1.d0
       xj(2) = -0.830223896278566929872032213967d0
       xj(3) = -0.468848793470714213803771881909d0
       xj(4) = +0.d0 
       xj(5) = -xj(3)
       xj(6) = -xj(2)
       xj(7) = -xj(1)
       wj(1) = 0.0476190476190476190476190476190d0
       wj(2) = 0.276826047361565948010700406290d0
       wj(3) = 0.431745381209862623417871022281d0
       wj(4) = 0.487619047619047619047619047619d0
       wj(5) = wj(3)
       wj(6) = wj(2)
       wj(7) = wj(1)
      else if (n.eq.7) then
       xj(1) = -1.d0
       xj(2) = -0.871740148509606615337445761221d0
       xj(3) = -0.591700181433142302144510731398d0
       xj(4) = -0.209299217902478868768657260345d0
       xj(5) = -xj(4)
       xj(6) = -xj(3)
       xj(7) = -xj(2)
       xj(8) = -xj(1)
       wj(1) = 0.0357142857142857142857142857143d0
       wj(2) = 0.210704227143506039382992065776d0
       wj(3) = 0.341122692483504364764240677108d0
       wj(4) = 0.412458794658703881567052971402d0
       wj(5) = wj(4)
       wj(6) = wj(3)
       wj(7) = wj(2)
       wj(8) = wj(1)
      else if (n.eq.8) then
       xj(1) = -1.d0
       xj(2) = -0.899757995411460157312345244418d0
       xj(3) = -0.677186279510737753445885427091d0
       xj(4) = -0.363117463826178158710752068709d0
       xj(5) =  0.d0
       xj(6) = -xj(4)
       xj(7) = -xj(3)
       xj(8) = -xj(2)
       xj(9) = -xj(1)
       wj(1) = 0.0277777777777777777777777777778d0
       wj(2) = 0.165495361560805525046339720029d0
       wj(3) = 0.274538712500161735280705618579d0
       wj(4) = 0.346428510973046345115131532140d0
       wj(5) = 0.371519274376417233560090702948d0
       wj(6) = wj(4)
       wj(7) = wj(3)
       wj(8) = wj(2)
       wj(9) = wj(1)
      else if (n.eq.9) then
       xj(1) = -1.d0
       xj(2) = -0.919533909495d0
       xj(3) = -0.738773866531d0
       xj(4) = -0.47792494981d0
       xj(5) = -0.165278957666d0
       xj(6) = +0.165278957666d0
       xj(7) = +0.47792494981d0
       xj(8) = +0.738773866531d0
       xj(9) = +0.919533909495d0
       xj(10) = +1.d0
       wj(1) = 0.0222222222222d0
       wj(2) = 0.133305990851d0
       wj(3) = 0.224889342063d0
       wj(4) = 0.29204268368d0
       wj(5) = 0.327539761184d0
       wj(6) = 0.327539761184d0
       wj(7) = 0.29204268368d0
       wj(8) = 0.224889342063d0
       wj(9) = 0.133305990851d0
       wj(10) = 0.0222222222222d0
      else if (n.eq.10) then
       xj(1) = -1.d0
       xj(2) = -0.934001431769d0
       xj(3) = -0.784483473676d0
       xj(4) = -0.565235326996d0
       xj(5) = -0.295758157496d0
       xj(6) =  0.0d0
       xj(7) = +0.295758157496d0
       xj(8) = +0.565235326996d0
       xj(9) = +0.784483473676d0
       xj(10) = +0.934001431769d0
       xj(11) = +1.d0
       wj(1) = 0.0181818181818d0
       wj(2) = 0.109612273267d0
       wj(3) = 0.18716988178d0
       wj(4) = 0.248048104264d0
       wj(5) = 0.286879124779d0
       wj(6) = 0.300217595456d0
       wj(7) = 0.286879124779d0
       wj(8) = 0.248048104264d0
       wj(9) = 0.18716988178d0
       wj(10) = 0.109612273267d0
       wj(11) = 0.0181818181818d0
      else if (n.eq.11) then
       xj(1) = -1.d0
       xj(2) = -0.944899273562d0
       xj(3) = -0.819279329634d0
       xj(4) = -0.632876153052d0
       xj(5) = -0.399530940965d0
       xj(6) = -0.136552937233d0
       xj(7) = +0.136552937233d0
       xj(8) = +0.399530940965d0
       xj(9) = +0.632876153052d0
       xj(10) = +0.819279329634d0
       xj(11) = +0.944899273562d0
       xj(12) = +1.d0
       wj(1) = 0.0151515151515d0
       wj(2) = 0.0916845174132d0
       wj(3) = 0.157974705564d0
       wj(4) = 0.212508417761d0
       wj(5) = 0.251275603199d0
       wj(6) = 0.271405240911d0
       wj(7) = 0.271405240911d0
       wj(8) = 0.251275603199d0
       wj(9) = 0.212508417761d0
       wj(10) = 0.157974705564d0
       wj(11) = 0.0916845174132d0
       wj(12) = 0.0151515151515d0
      else if (n.eq.12) then
       xj(1) = -1.d0
       xj(2) = -0.9533098466421863d0
       xj(3) = -0.846347564652234d0
       xj(4) = -0.6861884690818246d0
       xj(5) = -0.48290982350111433d0
       xj(6) = -0.24928693010627348d0
       xj(7) =  0.d0
       xj(8) = +0.24928693010627348d0
       xj(9) = +0.48290982350111433d0
       xj(10) = +0.6861884690818246d0
       xj(11) = +0.846347564652234d0
       xj(12) = +0.9533098466421863d0
       xj(13) = +1.d0
       wj(1) = 0.01282051282051282d0
       wj(2) = 0.07780168674685659d0
       wj(3) = 0.1349819266897795d0
       wj(4) = 0.183646865203576d0
       wj(5) = 0.22076779356610754d0
       wj(6) = 0.24401579030667636d0
       wj(7) = 0.2519308493334467d0
       wj(8) = 0.24401579030667636d0
       wj(9) = 0.22076779356610754d0
       wj(10) = 0.183646865203576d0
       wj(11) = 0.1349819266897795d0
       wj(12) = 0.07780168674685659d0
       wj(13) = 0.01282051282051282d0
      else if (n.eq.13) then
       xj(1)  = -1.d0
       xj(2)  = -0.9599350452672616d0
       xj(3)  = -0.8678010539501841d0
       xj(4)  = -0.7288685990913367d0
       xj(5)  = -0.5506394029286489d0
       xj(6)  = -0.342724013531143d0
       xj(7)  = -0.11633186888380677d0
       xj(8)  = +0.11633186888380677d0
       xj(9)  = +0.342724013531143d0
       xj(10) = +0.5506394029286489d0
       xj(11) = +0.7288685990913367d0
       xj(12) = +0.8678010539501841d0
       xj(13) = +0.9599350452672616d0
       xj(14) = +1.d0
       wj(1)  = 0.01098901098901099d0
       wj(2)  = 0.0668372844976565d0
       wj(3)  = 0.11658665589863608d0
       wj(4)  = 0.16002185176299588d0
       wj(5)  = 0.19482614937341378d0
       wj(6)  = 0.21912625300977065d0
       wj(7)  = 0.23161279446845703d0
       wj(8)  = 0.23161279446845703d0
       wj(9)  = 0.21912625300977065d0
       wj(10) = 0.19482614937341378d0
       wj(11) = 0.16002185176299588d0
       wj(12) = 0.11658665589863608d0
       wj(13) = 0.0668372844976565d0
       wj(14) = 0.01098901098901099d0
      else if (n.eq.14) then
       xj(1)  = -1.d0
       xj(2)  = -0.9652459265038368d0
       xj(3)  = -0.885082044496334d0
       xj(4)  = -0.7635196899518193d0
       xj(5)  = -0.6062532054698464d0
       xj(6)  = -0.42063805471556376d0
       xj(7)  = -0.21535395536379578d0
       xj(8)  =  0.d0
       xj(9)  = +0.21535395536379578d0
       xj(10) = +0.42063805471556376d0
       xj(11) = +0.6062532054698464d0
       xj(12) = +0.7635196899518193d0
       xj(13) = +0.885082044496334d0
       xj(14) = +0.9652459265038368d0
       xj(15) = +1.d0
       wj(1)  = 0.009523809523809525d0
       wj(2)  = 0.058029893028951667d0
       wj(3)  = 0.1016600703257195d0
       wj(4)  = 0.14051169980250242d0
       wj(5)  = 0.17278964725361956d0
       wj(6)  = 0.1969872359646118d0
       wj(7)  = 0.21197358592682092d0
       wj(8)  = 0.21704811634881566d0
       wj(9)  = 0.21197358592682092d0
       wj(10) = 0.1969872359646118d0
       wj(11) = 0.17278964725361956d0
       wj(12) = 0.14051169980250242d0
       wj(13) = 0.1016600703257195d0
       wj(14) = 0.058029893028951667d0
       wj(15) = 0.009523809523809525d0
      else if (n.eq.15) then
       xj(1)  = -1.d0
       xj(2)  = -0.9695680462702312d0
       xj(3)  = -0.8992005334092407d0
       xj(4)  = -0.7920082918618584d0
       xj(5)  = -0.6523887032004311d0
       xj(6)  = -0.4860594230193384d0
       xj(7)  = -0.2998304689007636d0
       xj(8)  = -0.10132627352201005d0
       xj(9)  = +0.10132627352201005d0
       xj(10) = +0.2998304689007636d0
       xj(11) = +0.4860594230193384d0
       xj(12) = +0.6523887032004311d0
       xj(13) = +0.7920082918618584d0
       xj(14) = +0.8992005334092407d0
       xj(15) = +0.9695680462702312d0
       xj(16) = +1.d0
       wj(1)  = 0.008333333333333333d0
       wj(2)  = 0.05085036100683484d0
       wj(3)  = 0.08939369732464422d0
       wj(4)  = 0.12425538213256201d0
       wj(5)  = 0.15402698080726057d0
       wj(6)  = 0.17749191339170944d0
       wj(7)  = 0.1936900238252024d0
       wj(8)  = 0.20195830817822982d0
       wj(9)  = 0.20195830817822982d0
       wj(10) = 0.1936900238252024d0
       wj(11) = 0.17749191339170944d0
       wj(12) = 0.15402698080726057d0
       wj(13) = 0.12425538213256201d0
       wj(14) = 0.08939369732464422d0
       wj(15) = 0.05085036100683484d0
       wj(16) = 0.008333333333333333d0
      else if (n.eq.16) then
       xj(1)  = -1.d0
       xj(2)  = -0.9731321766314424d0
       xj(3)  = -0.9108799959156316d0
       xj(4)  = -0.815696254243515d0
       xj(5)  = -0.6910289806276851d0
       xj(6)  = -0.5413853993301047d0
       xj(7)  = -0.37217443357349506d0
       xj(8)  = -0.18951197513310575d0
       xj(9)  =  0.d0
       xj(10) = +0.18951197513310575d0
       xj(11) = +0.37217443357349506d0
       xj(12) = +0.5413853993301047d0
       xj(13) = +0.6910289806276851d0
       xj(14) = +0.815696254243515d0
       xj(15) = +0.9108799959156316d0
       xj(16) = +0.9731321766314424d0
       xj(17) = +1.d0
       wj(1)  = 0.007352941176470588d0
       wj(2)  = 0.044921940542416154d0
       wj(3)  = 0.07919827050406547d0
       wj(4)  = 0.11059290900635102d0
       wj(5)  = 0.13798774620192222d0
       wj(6)  = 0.1603946619975777d0
       wj(7)  = 0.1770042535156563d0
       wj(8)  = 0.1872163396776194d0
       wj(9)  = 0.19066187475346943d0
       wj(10) = 0.1872163396776194d0
       wj(11) = 0.1770042535156563d0
       wj(12) = 0.1603946619975777d0
       wj(13) = 0.13798774620192222d0
       wj(14) = 0.11059290900635102d0
       wj(15) = 0.07919827050406547d0
       wj(16) = 0.044921940542416154d0
       wj(17) = 0.007352941176470588d0
      else if (n.eq.17) then
       xj(1)  = -1.d0
       xj(2)  = -0.9761055574148862d0
       xj(3)  = -0.9206491853474713d0
       xj(4)  = -0.8355935352183288d0
       xj(5)  = -0.7236793292832973d0
       xj(6)  = -0.5885048343824267d0
       xj(7)  = -0.4344150369719329d0
       xj(8)  = -0.2663626528783067d0
       xj(9)  = -0.08974909504969952d0
       xj(10) = +0.08974909504969952d0
       xj(11) = +0.2663626528783067d0
       xj(12) = +0.4344150369719329d0
       xj(13) = +0.5885048343824267d0
       xj(14) = +0.7236793292832973d0
       xj(15) = +0.8355935352183288d0
       xj(16) = +0.9206491853474713d0
       xj(17) = +0.9761055574148862d0
       xj(18) = +1.d0
       wj(1)  = 0.006535947712418301d0
       wj(2)  = 0.03997062881263249d0
       wj(3)  = 0.07063716688349635d0
       wj(4)  = 0.09901627171304131d0
       wj(5)  = 0.12421053313253438d0
       wj(6)  = 0.14541196157370573d0
       wj(7)  = 0.16193951723761899d0
       wj(8)  = 0.17326210948945509d0
       wj(9)  = 0.17901586343970335d0
       wj(10) = 0.17901586343970335d0
       wj(11) = 0.17326210948945509d0
       wj(12) = 0.16193951723761899d0
       wj(13) = 0.14541196157370573d0
       wj(14) = 0.12421053313253438d0
       wj(15) = 0.09901627171304131d0
       wj(16) = 0.07063716688349635d0
       wj(17) = 0.03997062881263249d0
       wj(18) = 0.006535947712418301d0
      else if (n.eq.18) then 
! STARTING FROM ACCURATE MATHEMATICA SOLUTIONS HERE 
       xj(1)  = -1.d0
       xj(2)  = -0.978611766222080095152634063110d0
       xj(3)  = -0.928901528152586243717940258797d0
       xj(4)  = -0.852460577796646093085955970041d0
       xj(5)  = -0.751494202552613014163637489634d0
       xj(6)  = -0.628908137265220497766832306229d0
       xj(7)  = -0.488229285680713502777909637625d0
       xj(8)  = -0.333504847824498610298500103845d0
       xj(9)  = -0.169186023409281571375154153445d0
       xj(10) = +0.d0
       xj(11) = -xj(09)
       xj(12) = -xj(08)
       xj(13) = -xj(07)
       xj(14) = -xj(06)
       xj(15) = -xj(05)
       xj(16) = -xj(04)
       xj(17) = -xj(03)
       xj(18) = -xj(02)
       xj(19) = -xj(01)
       wj(1)  =  0.0058479532163742690058479532164d0
       wj(2)  = 0.0357933651861764771154255690351d0
       wj(3)  = 0.063381891762629736851695690418d0
       wj(4)  = 0.089131757099207084448008790556d0
       wj(5)  = 0.112315341477305044070910015464d0
       wj(6)  = 0.132267280448750776926046733910d0
       wj(7)  = 0.148413942595938885009680643668d0
       wj(8)  = 0.160290924044061241979910968184d0
       wj(9)  = 0.167556584527142867270137277740d0
       wj(10) = 0.170001919284827234644672715617d0
       wj(11) = wj(09)
       wj(12) = wj(08)
       wj(13) = wj(07)
       wj(14) = wj(06)
       wj(15) = wj(05)
       wj(16) = wj(04)
       wj(17) = wj(03)
       wj(18) = wj(02)
       wj(19) = wj(01)
      else if (n.eq.19) then 
       xj(01) = -1.00000000000000000000000000000d0
       xj(02) = -0.980743704893914171925446438584d0
       xj(03) = -0.935934498812665435716181584931d0
       xj(04) = -0.866877978089950141309847214616d0
       xj(05) = -0.775368260952055870414317527595d0
       xj(06) = -0.663776402290311289846403322971d0
       xj(07) = -0.534992864031886261648135961829d0
       xj(08) = -0.392353183713909299386474703816d0
       xj(09) = -0.239551705922986495182401356927d0
       xj(10) = -0.0805459372388218379759445181596d0
       xj(11) = +0.0805459372388218379759445181596d0
       xj(12) = +0.239551705922986495182401356927d0
       xj(13) = +0.392353183713909299386474703816d0
       xj(14) = +0.534992864031886261648135961829d0
       xj(15) = +0.663776402290311289846403322971d0
       xj(16) = +0.775368260952055870414317527595d0
       xj(17) = +0.866877978089950141309847214616d0
       xj(18) = +0.935934498812665435716181584931d0
       xj(19) = +0.980743704893914171925446438584d0
       xj(20) = +1.00000000000000000000000000000d0

       wj(01) = 0.0052631578947368421052631578947d0
       wj(02) = 0.0322371231884889414916050281173d0
       wj(03) = 0.057181802127566826004753627173d0
       wj(04) = 0.080631763996119603144776846114d0
       wj(05) = 0.101991499699450815683781205733d0
       wj(06) = 0.120709227628674725099429705002d0
       wj(07) = 0.136300482358724184489780792989d0
       wj(08) = 0.148361554070916825814713013734d0
       wj(09) = 0.156580102647475487158169896794d0
       wj(10) = 0.160743286387845749007726726449d0
       wj(11) = 0.160743286387845749007726726449d0
       wj(12) = 0.156580102647475487158169896794d0
       wj(13) = 0.148361554070916825814713013734d0
       wj(14) = 0.136300482358724184489780792989d0
       wj(15) = 0.120709227628674725099429705002d0
       wj(16) = 0.101991499699450815683781205733d0
       wj(17) = 0.08063176399611960314477684611d0
       wj(18) = 0.057181802127566826004753627d0
       wj(19) = 0.0322371231884889414916050281d0
       wj(20) = 0.0052631578947368421052631578947d0
      else if (n.eq.20) then 
       xj(01) = -1.00000000000000000000000000000d0
       xj(02) = -0.982572296604548028234481276555d0
       xj(03) = -0.941976296959745534296102650661d0
       xj(04) = -0.879294755323590464451153596305d0
       xj(05) = -0.796001926077712404744312589660d0
       xj(06) = -0.694051026062223232627316393195d0
       xj(07) = -0.575831960261830686927021870338d0
       xj(08) = -0.444115783279002101194516349607d0
       xj(09) = -0.301989856508764887275351867859d0
       xj(10) = -0.152785515802185466006358328486d0
       xj(11) = 0.d0
       xj(12) = +0.152785515802185466006358328486d0 
       xj(13) = +0.301989856508764887275351867859d0
       xj(14) = +0.444115783279002101194516349607d0
       xj(15) = +0.575831960261830686927021870338d0
       xj(16) = +0.694051026062223232627316393195d0
       xj(17) = +0.796001926077712404744312589660d0
       xj(18) = +0.879294755323590464451153596305d0
       xj(19) = +0.941976296959745534296102650661d0
       xj(20) = +0.982572296604548028234481276555d0
       xj(21) = +1.00000000000000000000000000000d0

       wj(01) = 0.00476190476190476190476190476190d0
       wj(02) = 0.0291848400985054586094585436132d0
       wj(03) = 0.051843169000849625072722971853d0
       wj(04) = 0.073273918185074144252547861042d0
       wj(05) = 0.092985467957886065301137664149d0
       wj(06) = 0.110517083219123335267000486784d0
       wj(07) = 0.125458121190868948015157535708d0
       wj(08) = 0.137458462860041343580899617415d0
       wj(09) = 0.146236862447977459267270530634d0
       wj(10) = 0.151587575111681384453250681505d0
       wj(11) = 0.153385190332174948551584405068d0
       wj(12) = 0.151587575111681384453250681505d0
       wj(13) = 0.146236862447977459267270530634d0
       wj(14) = 0.137458462860041343580899617415d0
       wj(15) = 0.125458121190868948015157535708d0
       wj(16) = 0.110517083219123335267000486784d0
       wj(17) = 0.092985467957886065301137664149d0
       wj(18) = 0.073273918185074144252547861042d0
       wj(19) = 0.051843169000849625072722971853d0
       wj(20) = 0.0291848400985054586094585436132d0
       wj(21) = 0.00476190476190476190476190476190d0
      else if (n.eq.21) then 
       stop 'too great' 
      end if
      return
      end 
