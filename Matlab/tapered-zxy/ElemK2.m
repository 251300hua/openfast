function K = ElemK2(AA, BB, CC, DD, EE, FF, L, DirCos)
%ELEMK2 Summary of this function goes here
%   Detailed explanation goes here

K = zeros(18, 18);
a0 = AA(1); a1 = AA(2); a2 = AA(3);
b0 = BB(1); b1 = BB(2); b2 = BB(3);
c0 = CC(1); c1 = CC(2); c2 = CC(3);
d0 = DD(1); d1 = DD(2); d2 = DD(3); d3 = DD(4); d4 = DD(5);
e0 = EE(1); e1 = EE(2); e2 = EE(3); e3 = EE(4); e4 = EE(5);
f0 = FF(1); f1 = FF(2); f2 = FF(3); f3 = FF(4); f4 = FF(5);

K(1,1)=b1/2+(7*b0)/(3*L)+(b2*L)/5;
K(1,5)=b0/2+(b1*L)/15+(b2*L^2)/60;
K(5,1)=K(1,5);
K(1,7)=-((2*b1)/3)-(8*b0)/(3*L)-(2*b2*L)/5;
K(7,1)=K(1,7);
K(1,11)=(2*b0)/3+(b1*L)/5+(b2*L^2)/15;
K(11,1)=K(1,11);
K(1,13)=b1/6+b0/(3*L)+(b2*L)/5;
K(13,1)=K(1,13);
K(1,17)=-(b0/6)-(b1*L)/10-(b2*L^2)/12;
K(17,1)=K(1,17);
K(2,2)=c1/2+(7*c0)/(3*L)+(c2*L)/5;
K(2,4)=-(c0/2)-(c1*L)/15-(c2*L^2)/60;
K(4,2)=K(2,4);
K(2,8)=-((2*c1)/3)-(8*c0)/(3*L)-(2*c2*L)/5;
K(8,2)=K(2,8);
K(2,10)=-((2*c0)/3)-(c1*L)/5-(c2*L^2)/15;
K(10,2)=K(2,10);
K(2,14)=c1/6+c0/(3*L)+(c2*L)/5;
K(14,2)=K(2,14);
K(2,16)=c0/6+(c1*L)/10+(c2*L^2)/12;
K(16,2)=K(2,16);
K(3,3)=a1/2+(7*a0)/(3*L)+(a2*L)/5;
K(3,9)=-((2*a1)/3)-(8*a0)/(3*L)-(2*a2*L)/5;
K(9,3)=K(3,9);
K(3,15)=a1/6+a0/(3*L)+(a2*L)/5;
K(15,3)=K(3,15);
K(4,4)=e1/2+(7*e0)/(3*L)+(2*c0*L)/15+(e2*L)/5+(c1*L^2)/60+(7*e3*L^2)/60+(c2*L^3)/210+(3*e4*L^3)/35;
K(4,8)=(2*c0)/3+(2*c1*L)/15+(c2*L^2)/15;
K(8,4)=K(4,8);
K(4,10)=-((2*e1)/3)-(8*e0)/(3*L)+(c0*L)/15-(2*e2*L)/5-(e3*L^2)/3-(c2*L^3)/105-(32*e4*L^3)/105;
K(10,4)=K(4,10);
K(4,14)=-(c0/6)-(c1*L)/15-(c2*L^2)/20;
K(14,4)=K(4,14);
K(4,16)=e1/6+e0/(3*L)-(c0*L)/30+(e2*L)/5-(c1*L^2)/60+(13*e3*L^2)/60-(c2*L^3)/84+(23*e4*L^3)/105;
K(16,4)=K(4,16);
K(5,5)=f1/2+(7*f0)/(3*L)+(2*b0*L)/15+(f2*L)/5+(b1*L^2)/60+(7*f3*L^2)/60+(b2*L^3)/210+(3*f4*L^3)/35;
K(5,7)=-((2*b0)/3)-(2*b1*L)/15-(b2*L^2)/15;
K(7,5)=K(5,7);
K(5,11)=-((2*f1)/3)-(8*f0)/(3*L)+(b0*L)/15-(2*f2*L)/5-(f3*L^2)/3-(b2*L^3)/105-(32*f4*L^3)/105;
K(11,5)=K(5,11);
K(5,13)=b0/6+(b1*L)/15+(b2*L^2)/20;
K(13,5)=K(5,13);
K(5,17)=f1/6+f0/(3*L)-(b0*L)/30+(f2*L)/5-(b1*L^2)/60+(13*f3*L^2)/60-(b2*L^3)/84+(23*f4*L^3)/105;
K(17,5)=K(5,17);
K(6,6)=d1/2+(7*d0)/(3*L)+(d2*L)/5+(7*d3*L^2)/60+(3*d4*L^3)/35;
K(6,12)=-((2*d1)/3)-(8*d0)/(3*L)-(2*d2*L)/5-(d3*L^2)/3-(32*d4*L^3)/105;
K(12,6)=K(6,12);
K(6,18)=d1/6+d0/(3*L)+(d2*L)/5+(13*d3*L^2)/60+(23*d4*L^3)/105;
K(18,6)=K(6,18);
K(7,7)=(8*b1)/3+(16*b0)/(3*L)+(32*b2*L)/15;
K(7,11)=(4*b1*L)/15+(4*b2*L^2)/15;
K(11,7)=K(7,11);
K(7,13)=-2*b1-(8*b0)/(3*L)-(26*b2*L)/15;
K(13,7)=K(7,13);
K(7,17)=(2*b0)/3+(8*b1*L)/15+(7*b2*L^2)/15;
K(17,7)=K(7,17);
K(8,8)=(8*c1)/3+(16*c0)/(3*L)+(32*c2*L)/15;
K(8,10)=-((4*c1*L)/15)-(4*c2*L^2)/15;
K(10,8)=K(8,10);
K(8,14)=-2*c1-(8*c0)/(3*L)-(26*c2*L)/15;
K(14,8)=K(8,14);
K(8,16)=-((2*c0)/3)-(8*c1*L)/15-(7*c2*L^2)/15;
K(16,8)=K(8,16);
K(9,9)=(8*a1)/3+(16*a0)/(3*L)+(32*a2*L)/15;
K(9,15)=-2*a1-(8*a0)/(3*L)-(26*a2*L)/15;
K(15,9)=K(9,15);
K(10,10)=(8*e1)/3+(16*e0)/(3*L)+(8*c0*L)/15+(32*e2*L)/15+(4*c1*L^2)/15+(28*e3*L^2)/15+(16*c2*L^3)/105+(176*e4*L^3)/105;
K(10,14)=(2*c0)/3+(7*c1*L)/15+(c2*L^2)/3;
K(14,10)=K(10,14);
K(10,16)=-2*e1-(8*e0)/(3*L)+(c0*L)/15-(26*e2*L)/15+(c1*L^2)/15-(23*e3*L^2)/15+(2*c2*L^3)/35-(48*e4*L^3)/35;
K(16,10)=K(10,16);
K(11,11)=(8*f1)/3+(16*f0)/(3*L)+(8*b0*L)/15+(32*f2*L)/15+(4*b1*L^2)/15+(28*f3*L^2)/15+(16*b2*L^3)/105+(176*f4*L^3)/105;
K(11,13)=-((2*b0)/3)-(7*b1*L)/15-(b2*L^2)/3;
K(13,11)=K(11,13);
K(11,17)=-2*f1-(8*f0)/(3*L)+(b0*L)/15-(26*f2*L)/15+(b1*L^2)/15-(23*f3*L^2)/15+(2*b2*L^3)/35-(48*f4*L^3)/35;
K(17,11)=K(11,17);
K(12,12)=(8*d1)/3+(16*d0)/(3*L)+(32*d2*L)/15+(28*d3*L^2)/15+(176*d4*L^3)/105;
K(12,18)=-2*d1-(8*d0)/(3*L)-(26*d2*L)/15-(23*d3*L^2)/15-(48*d4*L^3)/35;
K(18,12)=K(12,18);
K(13,13)=(11*b1)/6+(7*b0)/(3*L)+(23*b2*L)/15;
K(13,17)=-(b0/2)-(13*b1*L)/30-(23*b2*L^2)/60;
K(17,13)=K(13,17);
K(14,14)=(11*c1)/6+(7*c0)/(3*L)+(23*c2*L)/15;
K(14,16)=c0/2+(13*c1*L)/30+(23*c2*L^2)/60;
K(16,14)=K(14,16);
K(15,15)=(11*a1)/6+(7*a0)/(3*L)+(23*a2*L)/15;
K(16,16)=(11*e1)/6+(7*e0)/(3*L)+(2*c0*L)/15+(23*e2*L)/15+(7*c1*L^2)/60+(79*e3*L^2)/60+(11*c2*L^3)/105+(121*e4*L^3)/105;
K(17,17)=(11*f1)/6+(7*f0)/(3*L)+(2*b0*L)/15+(23*f2*L)/15+(7*b1*L^2)/60+(79*f3*L^2)/60+(11*b2*L^3)/105+(121*f4*L^3)/105;
K(18,18)=(11*d1)/6+(7*d0)/(3*L)+(23*d2*L)/15+(79*d3*L^2)/60+(121*d4*L^3)/105;

DC = zeros(18, 18);

DC(1:3, 1:3) = DirCos;
DC(4:6, 4:6) = DirCos;
DC(7:9, 7:9) = DirCos;
DC(10:12, 10:12) = DirCos;
DC(13:15, 13:15) = DirCos;
DC(16:18, 16:18) = DirCos;


K = DC*K*DC';


end

