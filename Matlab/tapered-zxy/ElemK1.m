function K = ElemK1(AA, BB, CC, DD, EE, FF, L, DirCos)
%ELEMK2 Summary of this function goes here
%   Detailed explanation goes here

K = zeros(12, 12);
a0 = AA(1); a1 = AA(2); a2 = AA(3);
b0 = BB(1); b1 = BB(2); b2 = BB(3);
c0 = CC(1); c1 = CC(2); c2 = CC(3);
d0 = DD(1); d1 = DD(2); d2 = DD(3); d3 = DD(4); d4 = DD(5);
e0 = EE(1); e1 = EE(2); e2 = EE(3); e3 = EE(4); e4 = EE(5);
f0 = FF(1); f1 = FF(2); f2 = FF(3); f3 = FF(4); f4 = FF(5);

K(1,1)=b1/2+b0/L+(b2*L)/3;
K(1,5)=b0/2+(b1*L)/6+(b2*L^2)/12;
K(5,1)=K(1,5);
K(1,7)=-(b1/2)-b0/L-(b2*L)/3;
K(7,1)=K(1,7);
K(1,11)=b0/2+(b1*L)/3+(b2*L^2)/4;
K(11,1)=K(1,11);
K(2,2)=c1/2+c0/L+(c2*L)/3;
K(2,4)=-(c0/2)-(c1*L)/6-(c2*L^2)/12;
K(4,2)=K(2,4);
K(2,8)=-(c1/2)-c0/L-(c2*L)/3;
K(8,2)=K(2,8);
K(2,10)=-(c0/2)-(c1*L)/3-(c2*L^2)/4;
K(10,2)=K(2,10);
K(3,3)=a1/2+a0/L+(a2*L)/3;
K(3,9)=-(a1/2)-a0/L-(a2*L)/3;
K(9,3)=K(3,9);
K(4,4)=e1/2+e0/L+(c0*L)/3+(e2*L)/3+(c1*L^2)/12+(e3*L^2)/4+(c2*L^3)/30+(e4*L^3)/5;
K(4,8)=c0/2+(c1*L)/6+(c2*L^2)/12;
K(8,4)=K(4,8);
K(4,10)=-(e1/2)-e0/L+(c0*L)/6-(e2*L)/3+(c1*L^2)/12-(e3*L^2)/4+(c2*L^3)/20-(e4*L^3)/5;
K(10,4)=K(4,10);
K(5,5)=f1/2+f0/L+(b0*L)/3+(f2*L)/3+(b1*L^2)/12+(f3*L^2)/4+(b2*L^3)/30+(f4*L^3)/5;
K(5,7)=-(b0/2)-(b1*L)/6-(b2*L^2)/12;
K(7,5)=K(5,7);
K(5,11)=-(f1/2)-f0/L+(b0*L)/6-(f2*L)/3+(b1*L^2)/12-(f3*L^2)/4+(b2*L^3)/20-(f4*L^3)/5;
K(11,5)=K(5,11);
K(6,6)=d1/2+d0/L+(d2*L)/3+(d3*L^2)/4+(d4*L^3)/5;
K(6,12)=-(d1/2)-d0/L-(d2*L)/3-(d3*L^2)/4-(d4*L^3)/5;
K(12,6)=K(6,12);
K(7,7)=b1/2+b0/L+(b2*L)/3;
K(7,11)=-(b0/2)-(b1*L)/3-(b2*L^2)/4;
K(11,7)=K(7,11);
K(8,8)=c1/2+c0/L+(c2*L)/3;
K(8,10)=c0/2+(c1*L)/3+(c2*L^2)/4;
K(10,8)=K(8,10);
K(9,9)=a1/2+a0/L+(a2*L)/3;
K(10,10)=e1/2+e0/L+(c0*L)/3+(e2*L)/3+(c1*L^2)/4+(e3*L^2)/4+(c2*L^3)/5+(e4*L^3)/5;
K(11,11)=f1/2+f0/L+(b0*L)/3+(f2*L)/3+(b1*L^2)/4+(f3*L^2)/4+(b2*L^3)/5+(f4*L^3)/5;
K(12,12)=d1/2+d0/L+(d2*L)/3+(d3*L^2)/4+(d4*L^3)/5;

DC = zeros(12, 12);

DC(1:3, 1:3) = DirCos;
DC(4:6, 4:6) = DirCos;
DC(7:9, 7:9) = DirCos;
DC(10:12, 10:12) = DirCos;


K = DC*K*DC';


end

