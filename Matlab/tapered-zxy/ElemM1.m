function M = ElemM1(GG, HH, PP, L, DirCos)       
%ELEMM2 Summary of this function goes here
%   Detailed explanation goes here

M = zeros(12, 12);

g0 = GG(1); g1 = GG(2); g2 = GG(3);
h0 = HH(1); h1 = HH(2); h2 = HH(3); h3 = HH(4); h4 = HH(5);
p0 = PP(1); p1 = PP(2); p2 = PP(3); p3 = PP(4); p4 = PP(5);

M(1,1)=(g0*L)/3+(g1*L^2)/12+(g2*L^3)/30;
M(1,7)=(g0*L)/6+(g1*L^2)/12+(g2*L^3)/20;
M(7,1)=M(1,7);
M(2,2)=(g0*L)/3+(g1*L^2)/12+(g2*L^3)/30;
M(2,8)=(g0*L)/6+(g1*L^2)/12+(g2*L^3)/20;
M(8,2)=M(2,8);
M(3,3)=(g0*L)/3+(g1*L^2)/12+(g2*L^3)/30;
M(3,9)=(g0*L)/6+(g1*L^2)/12+(g2*L^3)/20;
M(9,3)=M(3,9);
M(4,4)=(L*p0)/3+(L^2*p1)/12+(L^3*p2)/30+(L^4*p3)/60+(L^5*p4)/105;
M(4,10)=(L*p0)/6+(L^2*p1)/12+(L^3*p2)/20+(L^4*p3)/30+(L^5*p4)/42;
M(10,4)=M(4,10);
M(5,5)=(L*p0)/3+(L^2*p1)/12+(L^3*p2)/30+(L^4*p3)/60+(L^5*p4)/105;
M(5,11)=(L*p0)/6+(L^2*p1)/12+(L^3*p2)/20+(L^4*p3)/30+(L^5*p4)/42;
M(11,5)=M(5,11);
M(6,6)=(h0*L)/3+(h1*L^2)/12+(h2*L^3)/30+(h3*L^4)/60+(h4*L^5)/105;
M(6,12)=(h0*L)/6+(h1*L^2)/12+(h2*L^3)/20+(h3*L^4)/30+(h4*L^5)/42;
M(12,6)=M(6,12);
M(7,7)=(g0*L)/3+(g1*L^2)/4+(g2*L^3)/5;
M(8,8)=(g0*L)/3+(g1*L^2)/4+(g2*L^3)/5;
M(9,9)=(g0*L)/3+(g1*L^2)/4+(g2*L^3)/5;
M(10,10)=(L*p0)/3+(L^2*p1)/4+(L^3*p2)/5+(L^4*p3)/6+(L^5*p4)/7;
M(11,11)=(L*p0)/3+(L^2*p1)/4+(L^3*p2)/5+(L^4*p3)/6+(L^5*p4)/7;
M(12,12)=(h0*L)/3+(h1*L^2)/4+(h2*L^3)/5+(h3*L^4)/6+(h4*L^5)/7;

DC = zeros(12, 12);

DC(1:3, 1:3) = DirCos;
DC(4:6, 4:6) = DirCos;
DC(7:9, 7:9) = DirCos;
DC(10:12, 10:12) = DirCos;


M = DC*M*DC';

end

