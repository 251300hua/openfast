function M = ElemM2(GG, HH, PP, L, DirCos)       
%ELEMM2 Summary of this function goes here
%   Detailed explanation goes here

M = zeros(18, 18);

g0 = GG(1); g1 = GG(2); g2 = GG(3);
h0 = HH(1); h1 = HH(2); h2 = HH(3); h3 = HH(4); h4 = HH(5);
p0 = PP(1); p1 = PP(2); p2 = PP(3); p3 = PP(4); p4 = PP(5);

M(1,1)=(2*g0*L)/15+(g1*L^2)/60+(g2*L^3)/210;
M(1,7)=(g0*L)/15-(g2*L^3)/105;
M(7,1)=M(1,7);
M(1,13)=-((g0*L)/30)-(g1*L^2)/60-(g2*L^3)/84;
M(13,1)=M(1,13);
M(2,2)=(2*g0*L)/15+(g1*L^2)/60+(g2*L^3)/210;
M(2,8)=(g0*L)/15-(g2*L^3)/105;
M(8,2)=M(2,8);
M(2,14)=-((g0*L)/30)-(g1*L^2)/60-(g2*L^3)/84;
M(14,2)=M(2,14);
M(3,3)=(2*g0*L)/15+(g1*L^2)/60+(g2*L^3)/210;
M(3,9)=(g0*L)/15-(g2*L^3)/105;
M(9,3)=M(3,9);
M(3,15)=-((g0*L)/30)-(g1*L^2)/60-(g2*L^3)/84;
M(15,3)=M(3,15);
M(4,4)=(2*h0*L)/15+(h1*L^2)/60+(h2*L^3)/210+(h3*L^4)/420+(h4*L^5)/630;
M(4,10)=(h0*L)/15-(h2*L^3)/105-(h3*L^4)/105-(h4*L^5)/126;
M(10,4)=M(4,10);
M(4,16)=-((h0*L)/30)-(h1*L^2)/60-(h2*L^3)/84-(h3*L^4)/105-(h4*L^5)/126;
M(16,4)=M(4,16);
M(5,5)=(2*L*p0)/15+(L^2*p1)/60+(L^3*p2)/210+(L^4*p3)/420+(L^5*p4)/630;
M(5,11)=(L*p0)/15-(L^3*p2)/105-(L^4*p3)/105-(L^5*p4)/126;
M(11,5)=M(5,11);
M(5,17)=-((L*p0)/30)-(L^2*p1)/60-(L^3*p2)/84-(L^4*p3)/105-(L^5*p4)/126;
M(17,5)=M(5,17);
M(6,6)=(2*L*p0)/15+(L^2*p1)/60+(L^3*p2)/210+(L^4*p3)/420+(L^5*p4)/630;
M(6,12)=(L*p0)/15-(L^3*p2)/105-(L^4*p3)/105-(L^5*p4)/126;
M(12,6)=M(6,12);
M(6,18)=-((L*p0)/30)-(L^2*p1)/60-(L^3*p2)/84-(L^4*p3)/105-(L^5*p4)/126;
M(18,6)=M(6,18);
M(7,7)=(8*g0*L)/15+(4*g1*L^2)/15+(16*g2*L^3)/105;
M(7,13)=(g0*L)/15+(g1*L^2)/15+(2*g2*L^3)/35;
M(13,7)=M(7,13);
M(8,8)=(8*g0*L)/15+(4*g1*L^2)/15+(16*g2*L^3)/105;
M(8,14)=(g0*L)/15+(g1*L^2)/15+(2*g2*L^3)/35;
M(14,8)=M(8,14);
M(9,9)=(8*g0*L)/15+(4*g1*L^2)/15+(16*g2*L^3)/105;
M(9,15)=(g0*L)/15+(g1*L^2)/15+(2*g2*L^3)/35;
M(15,9)=M(9,15);
M(10,10)=(8*h0*L)/15+(4*h1*L^2)/15+(16*h2*L^3)/105+(2*h3*L^4)/21+(4*h4*L^5)/63;
M(10,16)=(h0*L)/15+(h1*L^2)/15+(2*h2*L^3)/35+(h3*L^4)/21+(5*h4*L^5)/126;
M(16,10)=M(10,16);
M(11,11)=(8*L*p0)/15+(4*L^2*p1)/15+(16*L^3*p2)/105+(2*L^4*p3)/21+(4*L^5*p4)/63;
M(11,17)=(L*p0)/15+(L^2*p1)/15+(2*L^3*p2)/35+(L^4*p3)/21+(5*L^5*p4)/126;
M(17,11)=M(11,17);
M(12,12)=(8*L*p0)/15+(4*L^2*p1)/15+(16*L^3*p2)/105+(2*L^4*p3)/21+(4*L^5*p4)/63;
M(12,18)=(L*p0)/15+(L^2*p1)/15+(2*L^3*p2)/35+(L^4*p3)/21+(5*L^5*p4)/126;
M(18,12)=M(12,18);
M(13,13)=(2*g0*L)/15+(7*g1*L^2)/60+(11*g2*L^3)/105;
M(14,14)=(2*g0*L)/15+(7*g1*L^2)/60+(11*g2*L^3)/105;
M(15,15)=(2*g0*L)/15+(7*g1*L^2)/60+(11*g2*L^3)/105;
M(16,16)=(2*h0*L)/15+(7*h1*L^2)/60+(11*h2*L^3)/105+(2*h3*L^4)/21+(11*h4*L^5)/126;
M(17,17)=(2*L*p0)/15+(7*L^2*p1)/60+(11*L^3*p2)/105+(2*L^4*p3)/21+(11*L^5*p4)/126;
M(18,18)=(2*L*p0)/15+(7*L^2*p1)/60+(11*L^3*p2)/105+(2*L^4*p3)/21+(11*L^5*p4)/126;

DC = zeros(18, 18);

DC(1:3, 1:3) = DirCos;
DC(4:6, 4:6) = DirCos;
DC(7:9, 7:9) = DirCos;
DC(10:12, 10:12) = DirCos;
DC(13:15, 13:15) = DirCos;
DC(16:18, 16:18) = DirCos;


M = DC*M*DC';

end

