function     k = ElemK(A, L, I, J, ka, E, G, DirCos, shear )    

%ELEMK Summary of this function goes here
%   Detailed explanation goes here

Asy = ka*A; % Ax
Asz = ka*A; % Ay
Iy = I; % Ix
Iz = I; % Iy
Le = L;
Ax = A; % Az

k = zeros(12, 12);

if( shear ) 
    Ksy = 12.*E*Iz / (G*Asy*Le*Le); 
    Ksz = 12.*E*Iy / (G*Asz*Le*Le);
else
    Ksy = 0.0;
    Ksz = 0.0;
end
    
% k(7,7)   = E*Ax / Le;
k(9,9)   = E*Ax / Le;
% k(8,8)   = 12.*E*Iz / ( Le*Le*Le*(1.+Ksy) );
k(7,7)   = 12.*E*Iz / ( Le*Le*Le*(1.+Ksy) );
% k(9,9)   = 12.*E*Iy / ( Le*Le*Le*(1.+Ksz) );
k(8,8)   = 12.*E*Iy / ( Le*Le*Le*(1.+Ksz) );
% k(10,10) = G*J / Le;
k(12,12) = G*J / Le;
% k(11,11) = (4.+Ksz)*E*Iy / ( Le*(1.+Ksz) );
k(10,10) = (4.+Ksz)*E*Iy / ( Le*(1.+Ksz) );
% k(12,12) = (4.+Ksy)*E*Iz / ( Le*(1.+Ksy) );
k(11,11) = (4.+Ksy)*E*Iz / ( Le*(1.+Ksy) );
% k(3,5)   = -6.*E*Iy / ( Le*Le*(1.+Ksz) );
k(2,4)   = -6.*E*Iy / ( Le*Le*(1.+Ksz) );
% k(2,6)   =  6.*E*Iz / ( Le*Le*(1.+Ksy) );
k(1,5)   =  6.*E*Iz / ( Le*Le*(1.+Ksy) );
% k(5,11)  = (2.-Ksz)*E*Iy / ( Le*(1.+Ksz) );
k(4,10)  = (2.-Ksz)*E*Iy / ( Le*(1.+Ksz) );
% k(6,12)  = (2.-Ksy)*E*Iz / ( Le*(1.+Ksy) );
k(5,11)  = (2.-Ksy)*E*Iz / ( Le*(1.+Ksy) );
% 	
% k(1,1)  = k(7,7);
k(3,3)  = k(9,9);
% k(2,2)  = k(8,8); 
k(1,1)  = k(7,7); 
% k(3,3)  = k(9,9); 
k(2,2)  = k(8,8); 
% k(4,4)  = k(10,10);
k(6,6)  = k(12,12);
% k(5,5)  = k(11,11);
k(4,4)  = k(10,10);
% k(6,6)  = k(12,12);
k(5,5)  = k(11,11);
% k(5,3)  = k(3,5); 
k(4,2)  = k(2,4); 
% k(6,2)  = k(2,6); 
k(5,1)  = k(1,5); 
% k(11,5) = k(5,11);
k(10,4) = k(4,10);
% k(12,6) = k(6,12);
k(11,5) = k(5,11);
% 
% k(10,4)= -k(4,4);
k(12,6)= -k(6,6);
% k(11,3)=  k(5,3);
k(10,2)=  k(4,2);
% k(12,2)=  k(6,2);
k(11,1)=  k(5,1);
% k(7,1) = -k(1,1);
k(9,3) = -k(3,3);
% k(8,2) = -k(2,2);
k(7,1) = -k(1,1);
% k(9,3) = -k(3,3);
k(8,2) = -k(2,2);
% 
% k(4, 10) = -k(4,4);
k(6, 12) = -k(6,6);
% k(3, 11) =  k(5,3);
k(2, 10) =  k(4,2);
% k(2, 12) =  k(6,2);
k(1, 11) =  k(5,1);
% k(1, 7)  = -k(1,1);
k(3, 9)  = -k(3,3);
% k(2, 8)  = -k(2,2);
k(1, 7)  = -k(1,1);
% k(3, 9)  = -k(3,3);
k(2, 8)  = -k(2,2);
% 
% k(12,8) = -k(6,2);
k(11,7) = -k(5,1);
% k(11,9) = -k(5,3);
k(10,8) = -k(4,2);
% 
% k(8,12) = -k(6,2);
k(7,11) = -k(5,1);
% k(9,11) = -k(5,3);
k(8,10) = -k(4,2);
% 
% k(8,6) = -k(6,2);
k(7,5) = -k(5,1);
% k(6,8) = -k(6,2);
k(5,7) = -k(5,1);
% k(9,5) = -k(5,3);
k(8,4) = -k(4,2);
% k(5,9) = -k(5,3);
k(4,8) = -k(4,2);
%kt = k-k'

DC = zeros(12, 12);

DC(1:3, 1:3) = DirCos;
DC(4:6, 4:6) = DirCos;
DC(7:9, 7:9) = DirCos;
DC(10:12, 10:12) = DirCos;

k = DC*k*DC';






end

