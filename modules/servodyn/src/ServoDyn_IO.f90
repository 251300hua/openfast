!**********************************************************************************************************************************
! LICENSING
! Copyright (C) 2013-2016  National Renewable Energy Laboratory
!
!    This file is part of FAST's Controls and Electrical Drive Module, "ServoDyn".
!
! Licensed under the Apache License, Version 2.0 (the "License");
! you may not use this file except in compliance with the License.
! You may obtain a copy of the License at
!
!     http://www.apache.org/licenses/LICENSE-2.0
!
! Unless required by applicable law or agreed to in writing, software
! distributed under the License is distributed on an "AS IS" BASIS,
! WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
! See the License for the specific language governing permissions and
! limitations under the License.
!
!**********************************************************************************************************************************
!> Control and electrical drive dynamics module for FAST   
MODULE ServoDyn_IO

   USE ServoDyn_Types
   USE NWTC_Library
   USE StrucCtrl_Types
   

   IMPLICIT NONE


! ===================================================================================================
! NOTE: The following lines of code were generated by a Matlab script called "Write_ChckOutLst.m"
!      using the parameters listed in the "OutListParameters.xlsx" Excel file. Any changes to these
!      lines should be modified in the Matlab script and/or Excel worksheet as necessary.
! ===================================================================================================
! This code was generated by Write_ChckOutLst.m at 05-Dec-2020 09:46:03.


     ! Parameters related to output length (number of characters allowed in the output data headers):

   INTEGER(IntKi), PARAMETER      :: OutStrLenM1 = ChanLen - 1


     ! Indices for computing output channels:
     ! NOTES:
     !    (1) These parameters are in the order stored in "OutListParameters.xlsx"
     !    (2) Array AllOuts() must be dimensioned to the value of the largest output parameter

     !  Time:

   INTEGER(IntKi), PARAMETER      :: Time         =   0


     ! Airfoil control:

   INTEGER(IntKi), PARAMETER      :: BlAirFlC1    =   1
   INTEGER(IntKi), PARAMETER      :: BlAirFlC2    =   2
   INTEGER(IntKi), PARAMETER      :: BlAirFlC3    =   3


     ! Pitch Control:

   INTEGER(IntKi), PARAMETER      :: BlPitchC1    =   4
   INTEGER(IntKi), PARAMETER      :: BlPitchC2    =   5
   INTEGER(IntKi), PARAMETER      :: BlPitchC3    =   6


     ! Generator and Torque Control:

   INTEGER(IntKi), PARAMETER      :: GenTq        =   7
   INTEGER(IntKi), PARAMETER      :: GenPwr       =   8


     ! High Speed Shaft Brake:

   INTEGER(IntKi), PARAMETER      :: HSSBrTqC     =   9


     ! Nacelle Yaw Control:

   INTEGER(IntKi), PARAMETER      :: YawMomCom    =  10


     ! Nacelle Structural Control  (StC):

   INTEGER(IntKi), PARAMETER      :: NStC1_XQ     =  11
   INTEGER(IntKi), PARAMETER      :: NStC1_XQD    =  12
   INTEGER(IntKi), PARAMETER      :: NStC1_YQ     =  13
   INTEGER(IntKi), PARAMETER      :: NStC1_YQD    =  14
   INTEGER(IntKi), PARAMETER      :: NStC1_ZQ     =  15
   INTEGER(IntKi), PARAMETER      :: NStC1_ZQD    =  16
   INTEGER(IntKi), PARAMETER      :: NStC1_Fxi    =  17
   INTEGER(IntKi), PARAMETER      :: NStC1_Fyi    =  18
   INTEGER(IntKi), PARAMETER      :: NStC1_Fzi    =  19
   INTEGER(IntKi), PARAMETER      :: NStC1_Mxi    =  20
   INTEGER(IntKi), PARAMETER      :: NStC1_Myi    =  21
   INTEGER(IntKi), PARAMETER      :: NStC1_Mzi    =  22
   INTEGER(IntKi), PARAMETER      :: NStC1_Fxn    =  23
   INTEGER(IntKi), PARAMETER      :: NStC1_Fyn    =  24
   INTEGER(IntKi), PARAMETER      :: NStC1_Fzn    =  25
   INTEGER(IntKi), PARAMETER      :: NStC1_Mxn    =  26
   INTEGER(IntKi), PARAMETER      :: NStC1_Myn    =  27
   INTEGER(IntKi), PARAMETER      :: NStC1_Mzn    =  28
   INTEGER(IntKi), PARAMETER      :: NStC2_XQ     =  29
   INTEGER(IntKi), PARAMETER      :: NStC2_XQD    =  30
   INTEGER(IntKi), PARAMETER      :: NStC2_YQ     =  31
   INTEGER(IntKi), PARAMETER      :: NStC2_YQD    =  32
   INTEGER(IntKi), PARAMETER      :: NStC2_ZQ     =  33
   INTEGER(IntKi), PARAMETER      :: NStC2_ZQD    =  34
   INTEGER(IntKi), PARAMETER      :: NStC2_Fxi    =  35
   INTEGER(IntKi), PARAMETER      :: NStC2_Fyi    =  36
   INTEGER(IntKi), PARAMETER      :: NStC2_Fzi    =  37
   INTEGER(IntKi), PARAMETER      :: NStC2_Mxi    =  38
   INTEGER(IntKi), PARAMETER      :: NStC2_Myi    =  39
   INTEGER(IntKi), PARAMETER      :: NStC2_Mzi    =  40
   INTEGER(IntKi), PARAMETER      :: NStC2_Fxn    =  41
   INTEGER(IntKi), PARAMETER      :: NStC2_Fyn    =  42
   INTEGER(IntKi), PARAMETER      :: NStC2_Fzn    =  43
   INTEGER(IntKi), PARAMETER      :: NStC2_Mxn    =  44
   INTEGER(IntKi), PARAMETER      :: NStC2_Myn    =  45
   INTEGER(IntKi), PARAMETER      :: NStC2_Mzn    =  46
   INTEGER(IntKi), PARAMETER      :: NStC3_XQ     =  47
   INTEGER(IntKi), PARAMETER      :: NStC3_XQD    =  48
   INTEGER(IntKi), PARAMETER      :: NStC3_YQ     =  49
   INTEGER(IntKi), PARAMETER      :: NStC3_YQD    =  50
   INTEGER(IntKi), PARAMETER      :: NStC3_ZQ     =  51
   INTEGER(IntKi), PARAMETER      :: NStC3_ZQD    =  52
   INTEGER(IntKi), PARAMETER      :: NStC3_Fxi    =  53
   INTEGER(IntKi), PARAMETER      :: NStC3_Fyi    =  54
   INTEGER(IntKi), PARAMETER      :: NStC3_Fzi    =  55
   INTEGER(IntKi), PARAMETER      :: NStC3_Mxi    =  56
   INTEGER(IntKi), PARAMETER      :: NStC3_Myi    =  57
   INTEGER(IntKi), PARAMETER      :: NStC3_Mzi    =  58
   INTEGER(IntKi), PARAMETER      :: NStC3_Fxn    =  59
   INTEGER(IntKi), PARAMETER      :: NStC3_Fyn    =  60
   INTEGER(IntKi), PARAMETER      :: NStC3_Fzn    =  61
   INTEGER(IntKi), PARAMETER      :: NStC3_Mxn    =  62
   INTEGER(IntKi), PARAMETER      :: NStC3_Myn    =  63
   INTEGER(IntKi), PARAMETER      :: NStC3_Mzn    =  64
   INTEGER(IntKi), PARAMETER      :: NStC4_XQ     =  65
   INTEGER(IntKi), PARAMETER      :: NStC4_XQD    =  66
   INTEGER(IntKi), PARAMETER      :: NStC4_YQ     =  67
   INTEGER(IntKi), PARAMETER      :: NStC4_YQD    =  68
   INTEGER(IntKi), PARAMETER      :: NStC4_ZQ     =  69
   INTEGER(IntKi), PARAMETER      :: NStC4_ZQD    =  70
   INTEGER(IntKi), PARAMETER      :: NStC4_Fxi    =  71
   INTEGER(IntKi), PARAMETER      :: NStC4_Fyi    =  72
   INTEGER(IntKi), PARAMETER      :: NStC4_Fzi    =  73
   INTEGER(IntKi), PARAMETER      :: NStC4_Mxi    =  74
   INTEGER(IntKi), PARAMETER      :: NStC4_Myi    =  75
   INTEGER(IntKi), PARAMETER      :: NStC4_Mzi    =  76
   INTEGER(IntKi), PARAMETER      :: NStC4_Fxn    =  77
   INTEGER(IntKi), PARAMETER      :: NStC4_Fyn    =  78
   INTEGER(IntKi), PARAMETER      :: NStC4_Fzn    =  79
   INTEGER(IntKi), PARAMETER      :: NStC4_Mxn    =  80
   INTEGER(IntKi), PARAMETER      :: NStC4_Myn    =  81
   INTEGER(IntKi), PARAMETER      :: NStC4_Mzn    =  82


     ! Tower Structural Control  (StC):

   INTEGER(IntKi), PARAMETER      :: TStC1_XQ     =  83
   INTEGER(IntKi), PARAMETER      :: TStC1_XQD    =  84
   INTEGER(IntKi), PARAMETER      :: TStC1_YQ     =  85
   INTEGER(IntKi), PARAMETER      :: TStC1_YQD    =  86
   INTEGER(IntKi), PARAMETER      :: TStC1_ZQ     =  87
   INTEGER(IntKi), PARAMETER      :: TStC1_ZQD    =  88
   INTEGER(IntKi), PARAMETER      :: TStC1_Fxi    =  89
   INTEGER(IntKi), PARAMETER      :: TStC1_Fyi    =  90
   INTEGER(IntKi), PARAMETER      :: TStC1_Fzi    =  91
   INTEGER(IntKi), PARAMETER      :: TStC1_Mxi    =  92
   INTEGER(IntKi), PARAMETER      :: TStC1_Myi    =  93
   INTEGER(IntKi), PARAMETER      :: TStC1_Mzi    =  94
   INTEGER(IntKi), PARAMETER      :: TStC1_Fxn    =  95
   INTEGER(IntKi), PARAMETER      :: TStC1_Fyn    =  96
   INTEGER(IntKi), PARAMETER      :: TStC1_Fzn    =  97
   INTEGER(IntKi), PARAMETER      :: TStC1_Mxn    =  98
   INTEGER(IntKi), PARAMETER      :: TStC1_Myn    =  99
   INTEGER(IntKi), PARAMETER      :: TStC1_Mzn    = 100
   INTEGER(IntKi), PARAMETER      :: TStC2_XQ     = 101
   INTEGER(IntKi), PARAMETER      :: TStC2_XQD    = 102
   INTEGER(IntKi), PARAMETER      :: TStC2_YQ     = 103
   INTEGER(IntKi), PARAMETER      :: TStC2_YQD    = 104
   INTEGER(IntKi), PARAMETER      :: TStC2_ZQ     = 105
   INTEGER(IntKi), PARAMETER      :: TStC2_ZQD    = 106
   INTEGER(IntKi), PARAMETER      :: TStC2_Fxi    = 107
   INTEGER(IntKi), PARAMETER      :: TStC2_Fyi    = 108
   INTEGER(IntKi), PARAMETER      :: TStC2_Fzi    = 109
   INTEGER(IntKi), PARAMETER      :: TStC2_Mxi    = 110
   INTEGER(IntKi), PARAMETER      :: TStC2_Myi    = 111
   INTEGER(IntKi), PARAMETER      :: TStC2_Mzi    = 112
   INTEGER(IntKi), PARAMETER      :: TStC2_Fxn    = 113
   INTEGER(IntKi), PARAMETER      :: TStC2_Fyn    = 114
   INTEGER(IntKi), PARAMETER      :: TStC2_Fzn    = 115
   INTEGER(IntKi), PARAMETER      :: TStC2_Mxn    = 116
   INTEGER(IntKi), PARAMETER      :: TStC2_Myn    = 117
   INTEGER(IntKi), PARAMETER      :: TStC2_Mzn    = 118
   INTEGER(IntKi), PARAMETER      :: TStC3_XQ     = 119
   INTEGER(IntKi), PARAMETER      :: TStC3_XQD    = 120
   INTEGER(IntKi), PARAMETER      :: TStC3_YQ     = 121
   INTEGER(IntKi), PARAMETER      :: TStC3_YQD    = 122
   INTEGER(IntKi), PARAMETER      :: TStC3_ZQ     = 123
   INTEGER(IntKi), PARAMETER      :: TStC3_ZQD    = 124
   INTEGER(IntKi), PARAMETER      :: TStC3_Fxi    = 125
   INTEGER(IntKi), PARAMETER      :: TStC3_Fyi    = 126
   INTEGER(IntKi), PARAMETER      :: TStC3_Fzi    = 127
   INTEGER(IntKi), PARAMETER      :: TStC3_Mxi    = 128
   INTEGER(IntKi), PARAMETER      :: TStC3_Myi    = 129
   INTEGER(IntKi), PARAMETER      :: TStC3_Mzi    = 130
   INTEGER(IntKi), PARAMETER      :: TStC3_Fxn    = 131
   INTEGER(IntKi), PARAMETER      :: TStC3_Fyn    = 132
   INTEGER(IntKi), PARAMETER      :: TStC3_Fzn    = 133
   INTEGER(IntKi), PARAMETER      :: TStC3_Mxn    = 134
   INTEGER(IntKi), PARAMETER      :: TStC3_Myn    = 135
   INTEGER(IntKi), PARAMETER      :: TStC3_Mzn    = 136
   INTEGER(IntKi), PARAMETER      :: TStC4_XQ     = 137
   INTEGER(IntKi), PARAMETER      :: TStC4_XQD    = 138
   INTEGER(IntKi), PARAMETER      :: TStC4_YQ     = 139
   INTEGER(IntKi), PARAMETER      :: TStC4_YQD    = 140
   INTEGER(IntKi), PARAMETER      :: TStC4_ZQ     = 141
   INTEGER(IntKi), PARAMETER      :: TStC4_ZQD    = 142
   INTEGER(IntKi), PARAMETER      :: TStC4_Fxi    = 143
   INTEGER(IntKi), PARAMETER      :: TStC4_Fyi    = 144
   INTEGER(IntKi), PARAMETER      :: TStC4_Fzi    = 145
   INTEGER(IntKi), PARAMETER      :: TStC4_Mxi    = 146
   INTEGER(IntKi), PARAMETER      :: TStC4_Myi    = 147
   INTEGER(IntKi), PARAMETER      :: TStC4_Mzi    = 148
   INTEGER(IntKi), PARAMETER      :: TStC4_Fxn    = 149
   INTEGER(IntKi), PARAMETER      :: TStC4_Fyn    = 150
   INTEGER(IntKi), PARAMETER      :: TStC4_Fzn    = 151
   INTEGER(IntKi), PARAMETER      :: TStC4_Mxn    = 152
   INTEGER(IntKi), PARAMETER      :: TStC4_Myn    = 153
   INTEGER(IntKi), PARAMETER      :: TStC4_Mzn    = 154


     ! Blade  Structural Control  (StC):

   INTEGER(IntKi), PARAMETER      :: BStC1_B1_XQ  = 155
   INTEGER(IntKi), PARAMETER      :: BStC1_B1_XQD = 156
   INTEGER(IntKi), PARAMETER      :: BStC1_B1_YQ  = 157
   INTEGER(IntKi), PARAMETER      :: BStC1_B1_YQD = 158
   INTEGER(IntKi), PARAMETER      :: BStC1_B1_ZQ  = 159
   INTEGER(IntKi), PARAMETER      :: BStC1_B1_ZQD = 160
   INTEGER(IntKi), PARAMETER      :: BStC1_B1_Fxi = 161
   INTEGER(IntKi), PARAMETER      :: BStC1_B1_Fyi = 162
   INTEGER(IntKi), PARAMETER      :: BStC1_B1_Fzi = 163
   INTEGER(IntKi), PARAMETER      :: BStC1_B1_Mxi = 164
   INTEGER(IntKi), PARAMETER      :: BStC1_B1_Myi = 165
   INTEGER(IntKi), PARAMETER      :: BStC1_B1_Mzi = 166
   INTEGER(IntKi), PARAMETER      :: BStC1_B1_Fxn = 167
   INTEGER(IntKi), PARAMETER      :: BStC1_B1_Fyn = 168
   INTEGER(IntKi), PARAMETER      :: BStC1_B1_Fzn = 169
   INTEGER(IntKi), PARAMETER      :: BStC1_B1_Mxn = 170
   INTEGER(IntKi), PARAMETER      :: BStC1_B1_Myn = 171
   INTEGER(IntKi), PARAMETER      :: BStC1_B1_Mzn = 172
   INTEGER(IntKi), PARAMETER      :: BStC2_B1_XQ  = 173
   INTEGER(IntKi), PARAMETER      :: BStC2_B1_XQD = 174
   INTEGER(IntKi), PARAMETER      :: BStC2_B1_YQ  = 175
   INTEGER(IntKi), PARAMETER      :: BStC2_B1_YQD = 176
   INTEGER(IntKi), PARAMETER      :: BStC2_B1_ZQ  = 177
   INTEGER(IntKi), PARAMETER      :: BStC2_B1_ZQD = 178
   INTEGER(IntKi), PARAMETER      :: BStC2_B1_Fxi = 179
   INTEGER(IntKi), PARAMETER      :: BStC2_B1_Fyi = 180
   INTEGER(IntKi), PARAMETER      :: BStC2_B1_Fzi = 181
   INTEGER(IntKi), PARAMETER      :: BStC2_B1_Mxi = 182
   INTEGER(IntKi), PARAMETER      :: BStC2_B1_Myi = 183
   INTEGER(IntKi), PARAMETER      :: BStC2_B1_Mzi = 184
   INTEGER(IntKi), PARAMETER      :: BStC2_B1_Fxn = 185
   INTEGER(IntKi), PARAMETER      :: BStC2_B1_Fyn = 186
   INTEGER(IntKi), PARAMETER      :: BStC2_B1_Fzn = 187
   INTEGER(IntKi), PARAMETER      :: BStC2_B1_Mxn = 188
   INTEGER(IntKi), PARAMETER      :: BStC2_B1_Myn = 189
   INTEGER(IntKi), PARAMETER      :: BStC2_B1_Mzn = 190
   INTEGER(IntKi), PARAMETER      :: BStC3_B1_XQ  = 191
   INTEGER(IntKi), PARAMETER      :: BStC3_B1_XQD = 192
   INTEGER(IntKi), PARAMETER      :: BStC3_B1_YQ  = 193
   INTEGER(IntKi), PARAMETER      :: BStC3_B1_YQD = 194
   INTEGER(IntKi), PARAMETER      :: BStC3_B1_ZQ  = 195
   INTEGER(IntKi), PARAMETER      :: BStC3_B1_ZQD = 196
   INTEGER(IntKi), PARAMETER      :: BStC3_B1_Fxi = 197
   INTEGER(IntKi), PARAMETER      :: BStC3_B1_Fyi = 198
   INTEGER(IntKi), PARAMETER      :: BStC3_B1_Fzi = 199
   INTEGER(IntKi), PARAMETER      :: BStC3_B1_Mxi = 200
   INTEGER(IntKi), PARAMETER      :: BStC3_B1_Myi = 201
   INTEGER(IntKi), PARAMETER      :: BStC3_B1_Mzi = 202
   INTEGER(IntKi), PARAMETER      :: BStC3_B1_Fxn = 203
   INTEGER(IntKi), PARAMETER      :: BStC3_B1_Fyn = 204
   INTEGER(IntKi), PARAMETER      :: BStC3_B1_Fzn = 205
   INTEGER(IntKi), PARAMETER      :: BStC3_B1_Mxn = 206
   INTEGER(IntKi), PARAMETER      :: BStC3_B1_Myn = 207
   INTEGER(IntKi), PARAMETER      :: BStC3_B1_Mzn = 208
   INTEGER(IntKi), PARAMETER      :: BStC4_B1_XQ  = 209
   INTEGER(IntKi), PARAMETER      :: BStC4_B1_XQD = 210
   INTEGER(IntKi), PARAMETER      :: BStC4_B1_YQ  = 211
   INTEGER(IntKi), PARAMETER      :: BStC4_B1_YQD = 212
   INTEGER(IntKi), PARAMETER      :: BStC4_B1_ZQ  = 213
   INTEGER(IntKi), PARAMETER      :: BStC4_B1_ZQD = 214
   INTEGER(IntKi), PARAMETER      :: BStC4_B1_Fxi = 215
   INTEGER(IntKi), PARAMETER      :: BStC4_B1_Fyi = 216
   INTEGER(IntKi), PARAMETER      :: BStC4_B1_Fzi = 217
   INTEGER(IntKi), PARAMETER      :: BStC4_B1_Mxi = 218
   INTEGER(IntKi), PARAMETER      :: BStC4_B1_Myi = 219
   INTEGER(IntKi), PARAMETER      :: BStC4_B1_Mzi = 220
   INTEGER(IntKi), PARAMETER      :: BStC4_B1_Fxn = 221
   INTEGER(IntKi), PARAMETER      :: BStC4_B1_Fyn = 222
   INTEGER(IntKi), PARAMETER      :: BStC4_B1_Fzn = 223
   INTEGER(IntKi), PARAMETER      :: BStC4_B1_Mxn = 224
   INTEGER(IntKi), PARAMETER      :: BStC4_B1_Myn = 225
   INTEGER(IntKi), PARAMETER      :: BStC4_B1_Mzn = 226
   INTEGER(IntKi), PARAMETER      :: BStC1_B2_XQ  = 227
   INTEGER(IntKi), PARAMETER      :: BStC1_B2_XQD = 228
   INTEGER(IntKi), PARAMETER      :: BStC1_B2_YQ  = 229
   INTEGER(IntKi), PARAMETER      :: BStC1_B2_YQD = 230
   INTEGER(IntKi), PARAMETER      :: BStC1_B2_ZQ  = 231
   INTEGER(IntKi), PARAMETER      :: BStC1_B2_ZQD = 232
   INTEGER(IntKi), PARAMETER      :: BStC1_B2_Fxi = 233
   INTEGER(IntKi), PARAMETER      :: BStC1_B2_Fyi = 234
   INTEGER(IntKi), PARAMETER      :: BStC1_B2_Fzi = 235
   INTEGER(IntKi), PARAMETER      :: BStC1_B2_Mxi = 236
   INTEGER(IntKi), PARAMETER      :: BStC1_B2_Myi = 237
   INTEGER(IntKi), PARAMETER      :: BStC1_B2_Mzi = 238
   INTEGER(IntKi), PARAMETER      :: BStC1_B2_Fxn = 239
   INTEGER(IntKi), PARAMETER      :: BStC1_B2_Fyn = 240
   INTEGER(IntKi), PARAMETER      :: BStC1_B2_Fzn = 241
   INTEGER(IntKi), PARAMETER      :: BStC1_B2_Mxn = 242
   INTEGER(IntKi), PARAMETER      :: BStC1_B2_Myn = 243
   INTEGER(IntKi), PARAMETER      :: BStC1_B2_Mzn = 244
   INTEGER(IntKi), PARAMETER      :: BStC2_B2_XQ  = 245
   INTEGER(IntKi), PARAMETER      :: BStC2_B2_XQD = 246
   INTEGER(IntKi), PARAMETER      :: BStC2_B2_YQ  = 247
   INTEGER(IntKi), PARAMETER      :: BStC2_B2_YQD = 248
   INTEGER(IntKi), PARAMETER      :: BStC2_B2_ZQ  = 249
   INTEGER(IntKi), PARAMETER      :: BStC2_B2_ZQD = 250
   INTEGER(IntKi), PARAMETER      :: BStC2_B2_Fxi = 251
   INTEGER(IntKi), PARAMETER      :: BStC2_B2_Fyi = 252
   INTEGER(IntKi), PARAMETER      :: BStC2_B2_Fzi = 253
   INTEGER(IntKi), PARAMETER      :: BStC2_B2_Mxi = 254
   INTEGER(IntKi), PARAMETER      :: BStC2_B2_Myi = 255
   INTEGER(IntKi), PARAMETER      :: BStC2_B2_Mzi = 256
   INTEGER(IntKi), PARAMETER      :: BStC2_B2_Fxn = 257
   INTEGER(IntKi), PARAMETER      :: BStC2_B2_Fyn = 258
   INTEGER(IntKi), PARAMETER      :: BStC2_B2_Fzn = 259
   INTEGER(IntKi), PARAMETER      :: BStC2_B2_Mxn = 260
   INTEGER(IntKi), PARAMETER      :: BStC2_B2_Myn = 261
   INTEGER(IntKi), PARAMETER      :: BStC2_B2_Mzn = 262
   INTEGER(IntKi), PARAMETER      :: BStC3_B2_XQ  = 263
   INTEGER(IntKi), PARAMETER      :: BStC3_B2_XQD = 264
   INTEGER(IntKi), PARAMETER      :: BStC3_B2_YQ  = 265
   INTEGER(IntKi), PARAMETER      :: BStC3_B2_YQD = 266
   INTEGER(IntKi), PARAMETER      :: BStC3_B2_ZQ  = 267
   INTEGER(IntKi), PARAMETER      :: BStC3_B2_ZQD = 268
   INTEGER(IntKi), PARAMETER      :: BStC3_B2_Fxi = 269
   INTEGER(IntKi), PARAMETER      :: BStC3_B2_Fyi = 270
   INTEGER(IntKi), PARAMETER      :: BStC3_B2_Fzi = 271
   INTEGER(IntKi), PARAMETER      :: BStC3_B2_Mxi = 272
   INTEGER(IntKi), PARAMETER      :: BStC3_B2_Myi = 273
   INTEGER(IntKi), PARAMETER      :: BStC3_B2_Mzi = 274
   INTEGER(IntKi), PARAMETER      :: BStC3_B2_Fxn = 275
   INTEGER(IntKi), PARAMETER      :: BStC3_B2_Fyn = 276
   INTEGER(IntKi), PARAMETER      :: BStC3_B2_Fzn = 277
   INTEGER(IntKi), PARAMETER      :: BStC3_B2_Mxn = 278
   INTEGER(IntKi), PARAMETER      :: BStC3_B2_Myn = 279
   INTEGER(IntKi), PARAMETER      :: BStC3_B2_Mzn = 280
   INTEGER(IntKi), PARAMETER      :: BStC4_B2_XQ  = 281
   INTEGER(IntKi), PARAMETER      :: BStC4_B2_XQD = 282
   INTEGER(IntKi), PARAMETER      :: BStC4_B2_YQ  = 283
   INTEGER(IntKi), PARAMETER      :: BStC4_B2_YQD = 284
   INTEGER(IntKi), PARAMETER      :: BStC4_B2_ZQ  = 285
   INTEGER(IntKi), PARAMETER      :: BStC4_B2_ZQD = 286
   INTEGER(IntKi), PARAMETER      :: BStC4_B2_Fxi = 287
   INTEGER(IntKi), PARAMETER      :: BStC4_B2_Fyi = 288
   INTEGER(IntKi), PARAMETER      :: BStC4_B2_Fzi = 289
   INTEGER(IntKi), PARAMETER      :: BStC4_B2_Mxi = 290
   INTEGER(IntKi), PARAMETER      :: BStC4_B2_Myi = 291
   INTEGER(IntKi), PARAMETER      :: BStC4_B2_Mzi = 292
   INTEGER(IntKi), PARAMETER      :: BStC4_B2_Fxn = 293
   INTEGER(IntKi), PARAMETER      :: BStC4_B2_Fyn = 294
   INTEGER(IntKi), PARAMETER      :: BStC4_B2_Fzn = 295
   INTEGER(IntKi), PARAMETER      :: BStC4_B2_Mxn = 296
   INTEGER(IntKi), PARAMETER      :: BStC4_B2_Myn = 297
   INTEGER(IntKi), PARAMETER      :: BStC4_B2_Mzn = 298
   INTEGER(IntKi), PARAMETER      :: BStC1_B3_XQ  = 299
   INTEGER(IntKi), PARAMETER      :: BStC1_B3_XQD = 300
   INTEGER(IntKi), PARAMETER      :: BStC1_B3_YQ  = 301
   INTEGER(IntKi), PARAMETER      :: BStC1_B3_YQD = 302
   INTEGER(IntKi), PARAMETER      :: BStC1_B3_ZQ  = 303
   INTEGER(IntKi), PARAMETER      :: BStC1_B3_ZQD = 304
   INTEGER(IntKi), PARAMETER      :: BStC1_B3_Fxi = 305
   INTEGER(IntKi), PARAMETER      :: BStC1_B3_Fyi = 306
   INTEGER(IntKi), PARAMETER      :: BStC1_B3_Fzi = 307
   INTEGER(IntKi), PARAMETER      :: BStC1_B3_Mxi = 308
   INTEGER(IntKi), PARAMETER      :: BStC1_B3_Myi = 309
   INTEGER(IntKi), PARAMETER      :: BStC1_B3_Mzi = 310
   INTEGER(IntKi), PARAMETER      :: BStC1_B3_Fxn = 311
   INTEGER(IntKi), PARAMETER      :: BStC1_B3_Fyn = 312
   INTEGER(IntKi), PARAMETER      :: BStC1_B3_Fzn = 313
   INTEGER(IntKi), PARAMETER      :: BStC1_B3_Mxn = 314
   INTEGER(IntKi), PARAMETER      :: BStC1_B3_Myn = 315
   INTEGER(IntKi), PARAMETER      :: BStC1_B3_Mzn = 316
   INTEGER(IntKi), PARAMETER      :: BStC2_B3_XQ  = 317
   INTEGER(IntKi), PARAMETER      :: BStC2_B3_XQD = 318
   INTEGER(IntKi), PARAMETER      :: BStC2_B3_YQ  = 319
   INTEGER(IntKi), PARAMETER      :: BStC2_B3_YQD = 320
   INTEGER(IntKi), PARAMETER      :: BStC2_B3_ZQ  = 321
   INTEGER(IntKi), PARAMETER      :: BStC2_B3_ZQD = 322
   INTEGER(IntKi), PARAMETER      :: BStC2_B3_Fxi = 323
   INTEGER(IntKi), PARAMETER      :: BStC2_B3_Fyi = 324
   INTEGER(IntKi), PARAMETER      :: BStC2_B3_Fzi = 325
   INTEGER(IntKi), PARAMETER      :: BStC2_B3_Mxi = 326
   INTEGER(IntKi), PARAMETER      :: BStC2_B3_Myi = 327
   INTEGER(IntKi), PARAMETER      :: BStC2_B3_Mzi = 328
   INTEGER(IntKi), PARAMETER      :: BStC2_B3_Fxn = 329
   INTEGER(IntKi), PARAMETER      :: BStC2_B3_Fyn = 330
   INTEGER(IntKi), PARAMETER      :: BStC2_B3_Fzn = 331
   INTEGER(IntKi), PARAMETER      :: BStC2_B3_Mxn = 332
   INTEGER(IntKi), PARAMETER      :: BStC2_B3_Myn = 333
   INTEGER(IntKi), PARAMETER      :: BStC2_B3_Mzn = 334
   INTEGER(IntKi), PARAMETER      :: BStC3_B3_XQ  = 335
   INTEGER(IntKi), PARAMETER      :: BStC3_B3_XQD = 336
   INTEGER(IntKi), PARAMETER      :: BStC3_B3_YQ  = 337
   INTEGER(IntKi), PARAMETER      :: BStC3_B3_YQD = 338
   INTEGER(IntKi), PARAMETER      :: BStC3_B3_ZQ  = 339
   INTEGER(IntKi), PARAMETER      :: BStC3_B3_ZQD = 340
   INTEGER(IntKi), PARAMETER      :: BStC3_B3_Fxi = 341
   INTEGER(IntKi), PARAMETER      :: BStC3_B3_Fyi = 342
   INTEGER(IntKi), PARAMETER      :: BStC3_B3_Fzi = 343
   INTEGER(IntKi), PARAMETER      :: BStC3_B3_Mxi = 344
   INTEGER(IntKi), PARAMETER      :: BStC3_B3_Myi = 345
   INTEGER(IntKi), PARAMETER      :: BStC3_B3_Mzi = 346
   INTEGER(IntKi), PARAMETER      :: BStC3_B3_Fxn = 347
   INTEGER(IntKi), PARAMETER      :: BStC3_B3_Fyn = 348
   INTEGER(IntKi), PARAMETER      :: BStC3_B3_Fzn = 349
   INTEGER(IntKi), PARAMETER      :: BStC3_B3_Mxn = 350
   INTEGER(IntKi), PARAMETER      :: BStC3_B3_Myn = 351
   INTEGER(IntKi), PARAMETER      :: BStC3_B3_Mzn = 352
   INTEGER(IntKi), PARAMETER      :: BStC4_B3_XQ  = 353
   INTEGER(IntKi), PARAMETER      :: BStC4_B3_XQD = 354
   INTEGER(IntKi), PARAMETER      :: BStC4_B3_YQ  = 355
   INTEGER(IntKi), PARAMETER      :: BStC4_B3_YQD = 356
   INTEGER(IntKi), PARAMETER      :: BStC4_B3_ZQ  = 357
   INTEGER(IntKi), PARAMETER      :: BStC4_B3_ZQD = 358
   INTEGER(IntKi), PARAMETER      :: BStC4_B3_Fxi = 359
   INTEGER(IntKi), PARAMETER      :: BStC4_B3_Fyi = 360
   INTEGER(IntKi), PARAMETER      :: BStC4_B3_Fzi = 361
   INTEGER(IntKi), PARAMETER      :: BStC4_B3_Mxi = 362
   INTEGER(IntKi), PARAMETER      :: BStC4_B3_Myi = 363
   INTEGER(IntKi), PARAMETER      :: BStC4_B3_Mzi = 364
   INTEGER(IntKi), PARAMETER      :: BStC4_B3_Fxn = 365
   INTEGER(IntKi), PARAMETER      :: BStC4_B3_Fyn = 366
   INTEGER(IntKi), PARAMETER      :: BStC4_B3_Fzn = 367
   INTEGER(IntKi), PARAMETER      :: BStC4_B3_Mxn = 368
   INTEGER(IntKi), PARAMETER      :: BStC4_B3_Myn = 369
   INTEGER(IntKi), PARAMETER      :: BStC4_B3_Mzn = 370
   INTEGER(IntKi), PARAMETER      :: BStC1_B4_XQ  = 371
   INTEGER(IntKi), PARAMETER      :: BStC1_B4_XQD = 372
   INTEGER(IntKi), PARAMETER      :: BStC1_B4_YQ  = 373
   INTEGER(IntKi), PARAMETER      :: BStC1_B4_YQD = 374
   INTEGER(IntKi), PARAMETER      :: BStC1_B4_ZQ  = 375
   INTEGER(IntKi), PARAMETER      :: BStC1_B4_ZQD = 376
   INTEGER(IntKi), PARAMETER      :: BStC1_B4_Fxi = 377
   INTEGER(IntKi), PARAMETER      :: BStC1_B4_Fyi = 378
   INTEGER(IntKi), PARAMETER      :: BStC1_B4_Fzi = 379
   INTEGER(IntKi), PARAMETER      :: BStC1_B4_Mxi = 380
   INTEGER(IntKi), PARAMETER      :: BStC1_B4_Myi = 381
   INTEGER(IntKi), PARAMETER      :: BStC1_B4_Mzi = 382
   INTEGER(IntKi), PARAMETER      :: BStC1_B4_Fxn = 383
   INTEGER(IntKi), PARAMETER      :: BStC1_B4_Fyn = 384
   INTEGER(IntKi), PARAMETER      :: BStC1_B4_Fzn = 385
   INTEGER(IntKi), PARAMETER      :: BStC1_B4_Mxn = 386
   INTEGER(IntKi), PARAMETER      :: BStC1_B4_Myn = 387
   INTEGER(IntKi), PARAMETER      :: BStC1_B4_Mzn = 388
   INTEGER(IntKi), PARAMETER      :: BStC2_B4_XQ  = 389
   INTEGER(IntKi), PARAMETER      :: BStC2_B4_XQD = 390
   INTEGER(IntKi), PARAMETER      :: BStC2_B4_YQ  = 391
   INTEGER(IntKi), PARAMETER      :: BStC2_B4_YQD = 392
   INTEGER(IntKi), PARAMETER      :: BStC2_B4_ZQ  = 393
   INTEGER(IntKi), PARAMETER      :: BStC2_B4_ZQD = 394
   INTEGER(IntKi), PARAMETER      :: BStC2_B4_Fxi = 395
   INTEGER(IntKi), PARAMETER      :: BStC2_B4_Fyi = 396
   INTEGER(IntKi), PARAMETER      :: BStC2_B4_Fzi = 397
   INTEGER(IntKi), PARAMETER      :: BStC2_B4_Mxi = 398
   INTEGER(IntKi), PARAMETER      :: BStC2_B4_Myi = 399
   INTEGER(IntKi), PARAMETER      :: BStC2_B4_Mzi = 400
   INTEGER(IntKi), PARAMETER      :: BStC2_B4_Fxn = 401
   INTEGER(IntKi), PARAMETER      :: BStC2_B4_Fyn = 402
   INTEGER(IntKi), PARAMETER      :: BStC2_B4_Fzn = 403
   INTEGER(IntKi), PARAMETER      :: BStC2_B4_Mxn = 404
   INTEGER(IntKi), PARAMETER      :: BStC2_B4_Myn = 405
   INTEGER(IntKi), PARAMETER      :: BStC2_B4_Mzn = 406
   INTEGER(IntKi), PARAMETER      :: BStC3_B4_XQ  = 407
   INTEGER(IntKi), PARAMETER      :: BStC3_B4_XQD = 408
   INTEGER(IntKi), PARAMETER      :: BStC3_B4_YQ  = 409
   INTEGER(IntKi), PARAMETER      :: BStC3_B4_YQD = 410
   INTEGER(IntKi), PARAMETER      :: BStC3_B4_ZQ  = 411
   INTEGER(IntKi), PARAMETER      :: BStC3_B4_ZQD = 412
   INTEGER(IntKi), PARAMETER      :: BStC3_B4_Fxi = 413
   INTEGER(IntKi), PARAMETER      :: BStC3_B4_Fyi = 414
   INTEGER(IntKi), PARAMETER      :: BStC3_B4_Fzi = 415
   INTEGER(IntKi), PARAMETER      :: BStC3_B4_Mxi = 416
   INTEGER(IntKi), PARAMETER      :: BStC3_B4_Myi = 417
   INTEGER(IntKi), PARAMETER      :: BStC3_B4_Mzi = 418
   INTEGER(IntKi), PARAMETER      :: BStC3_B4_Fxn = 419
   INTEGER(IntKi), PARAMETER      :: BStC3_B4_Fyn = 420
   INTEGER(IntKi), PARAMETER      :: BStC3_B4_Fzn = 421
   INTEGER(IntKi), PARAMETER      :: BStC3_B4_Mxn = 422
   INTEGER(IntKi), PARAMETER      :: BStC3_B4_Myn = 423
   INTEGER(IntKi), PARAMETER      :: BStC3_B4_Mzn = 424
   INTEGER(IntKi), PARAMETER      :: BStC4_B4_XQ  = 425
   INTEGER(IntKi), PARAMETER      :: BStC4_B4_XQD = 426
   INTEGER(IntKi), PARAMETER      :: BStC4_B4_YQ  = 427
   INTEGER(IntKi), PARAMETER      :: BStC4_B4_YQD = 428
   INTEGER(IntKi), PARAMETER      :: BStC4_B4_ZQ  = 429
   INTEGER(IntKi), PARAMETER      :: BStC4_B4_ZQD = 430
   INTEGER(IntKi), PARAMETER      :: BStC4_B4_Fxi = 431
   INTEGER(IntKi), PARAMETER      :: BStC4_B4_Fyi = 432
   INTEGER(IntKi), PARAMETER      :: BStC4_B4_Fzi = 433
   INTEGER(IntKi), PARAMETER      :: BStC4_B4_Mxi = 434
   INTEGER(IntKi), PARAMETER      :: BStC4_B4_Myi = 435
   INTEGER(IntKi), PARAMETER      :: BStC4_B4_Mzi = 436
   INTEGER(IntKi), PARAMETER      :: BStC4_B4_Fxn = 437
   INTEGER(IntKi), PARAMETER      :: BStC4_B4_Fyn = 438
   INTEGER(IntKi), PARAMETER      :: BStC4_B4_Fzn = 439
   INTEGER(IntKi), PARAMETER      :: BStC4_B4_Mxn = 440
   INTEGER(IntKi), PARAMETER      :: BStC4_B4_Myn = 441
   INTEGER(IntKi), PARAMETER      :: BStC4_B4_Mzn = 442


     ! Platform  Structural Control  (StC):

   INTEGER(IntKi), PARAMETER      :: PtfmStC1_XQ  = 443
   INTEGER(IntKi), PARAMETER      :: PtfmStC1_XQD = 444
   INTEGER(IntKi), PARAMETER      :: PtfmStC1_YQ  = 445
   INTEGER(IntKi), PARAMETER      :: PtfmStC1_YQD = 446
   INTEGER(IntKi), PARAMETER      :: PtfmStC1_ZQ  = 447
   INTEGER(IntKi), PARAMETER      :: PtfmStC1_ZQD = 448
   INTEGER(IntKi), PARAMETER      :: PtfmStC1_Fxi = 449
   INTEGER(IntKi), PARAMETER      :: PtfmStC1_Fyi = 450
   INTEGER(IntKi), PARAMETER      :: PtfmStC1_Fzi = 451
   INTEGER(IntKi), PARAMETER      :: PtfmStC1_Mxi = 452
   INTEGER(IntKi), PARAMETER      :: PtfmStC1_Myi = 453
   INTEGER(IntKi), PARAMETER      :: PtfmStC1_Mzi = 454
   INTEGER(IntKi), PARAMETER      :: PtfmStC1_Fxn = 455
   INTEGER(IntKi), PARAMETER      :: PtfmStC1_Fyn = 456
   INTEGER(IntKi), PARAMETER      :: PtfmStC1_Fzn = 457
   INTEGER(IntKi), PARAMETER      :: PtfmStC1_Mxn = 458
   INTEGER(IntKi), PARAMETER      :: PtfmStC1_Myn = 459
   INTEGER(IntKi), PARAMETER      :: PtfmStC1_Mzn = 460
   INTEGER(IntKi), PARAMETER      :: PtfmStC2_XQ  = 461
   INTEGER(IntKi), PARAMETER      :: PtfmStC2_XQD = 462
   INTEGER(IntKi), PARAMETER      :: PtfmStC2_YQ  = 463
   INTEGER(IntKi), PARAMETER      :: PtfmStC2_YQD = 464
   INTEGER(IntKi), PARAMETER      :: PtfmStC2_ZQ  = 465
   INTEGER(IntKi), PARAMETER      :: PtfmStC2_ZQD = 466
   INTEGER(IntKi), PARAMETER      :: PtfmStC2_Fxi = 467
   INTEGER(IntKi), PARAMETER      :: PtfmStC2_Fyi = 468
   INTEGER(IntKi), PARAMETER      :: PtfmStC2_Fzi = 469
   INTEGER(IntKi), PARAMETER      :: PtfmStC2_Mxi = 470
   INTEGER(IntKi), PARAMETER      :: PtfmStC2_Myi = 471
   INTEGER(IntKi), PARAMETER      :: PtfmStC2_Mzi = 472
   INTEGER(IntKi), PARAMETER      :: PtfmStC2_Fxn = 473
   INTEGER(IntKi), PARAMETER      :: PtfmStC2_Fyn = 474
   INTEGER(IntKi), PARAMETER      :: PtfmStC2_Fzn = 475
   INTEGER(IntKi), PARAMETER      :: PtfmStC2_Mxn = 476
   INTEGER(IntKi), PARAMETER      :: PtfmStC2_Myn = 477
   INTEGER(IntKi), PARAMETER      :: PtfmStC2_Mzn = 478
   INTEGER(IntKi), PARAMETER      :: PtfmStC3_XQ  = 479
   INTEGER(IntKi), PARAMETER      :: PtfmStC3_XQD = 480
   INTEGER(IntKi), PARAMETER      :: PtfmStC3_YQ  = 481
   INTEGER(IntKi), PARAMETER      :: PtfmStC3_YQD = 482
   INTEGER(IntKi), PARAMETER      :: PtfmStC3_ZQ  = 483
   INTEGER(IntKi), PARAMETER      :: PtfmStC3_ZQD = 484
   INTEGER(IntKi), PARAMETER      :: PtfmStC3_Fxi = 485
   INTEGER(IntKi), PARAMETER      :: PtfmStC3_Fyi = 486
   INTEGER(IntKi), PARAMETER      :: PtfmStC3_Fzi = 487
   INTEGER(IntKi), PARAMETER      :: PtfmStC3_Mxi = 488
   INTEGER(IntKi), PARAMETER      :: PtfmStC3_Myi = 489
   INTEGER(IntKi), PARAMETER      :: PtfmStC3_Mzi = 490
   INTEGER(IntKi), PARAMETER      :: PtfmStC3_Fxn = 491
   INTEGER(IntKi), PARAMETER      :: PtfmStC3_Fyn = 492
   INTEGER(IntKi), PARAMETER      :: PtfmStC3_Fzn = 493
   INTEGER(IntKi), PARAMETER      :: PtfmStC3_Mxn = 494
   INTEGER(IntKi), PARAMETER      :: PtfmStC3_Myn = 495
   INTEGER(IntKi), PARAMETER      :: PtfmStC3_Mzn = 496
   INTEGER(IntKi), PARAMETER      :: PtfmStC4_XQ  = 497
   INTEGER(IntKi), PARAMETER      :: PtfmStC4_XQD = 498
   INTEGER(IntKi), PARAMETER      :: PtfmStC4_YQ  = 499
   INTEGER(IntKi), PARAMETER      :: PtfmStC4_YQD = 500
   INTEGER(IntKi), PARAMETER      :: PtfmStC4_ZQ  = 501
   INTEGER(IntKi), PARAMETER      :: PtfmStC4_ZQD = 502
   INTEGER(IntKi), PARAMETER      :: PtfmStC4_Fxi = 503
   INTEGER(IntKi), PARAMETER      :: PtfmStC4_Fyi = 504
   INTEGER(IntKi), PARAMETER      :: PtfmStC4_Fzi = 505
   INTEGER(IntKi), PARAMETER      :: PtfmStC4_Mxi = 506
   INTEGER(IntKi), PARAMETER      :: PtfmStC4_Myi = 507
   INTEGER(IntKi), PARAMETER      :: PtfmStC4_Mzi = 508
   INTEGER(IntKi), PARAMETER      :: PtfmStC4_Fxn = 509
   INTEGER(IntKi), PARAMETER      :: PtfmStC4_Fyn = 510
   INTEGER(IntKi), PARAMETER      :: PtfmStC4_Fzn = 511
   INTEGER(IntKi), PARAMETER      :: PtfmStC4_Mxn = 512
   INTEGER(IntKi), PARAMETER      :: PtfmStC4_Myn = 513
   INTEGER(IntKi), PARAMETER      :: PtfmStC4_Mzn = 514


     ! The maximum number of output channels which can be output by the code.
   INTEGER(IntKi), PARAMETER      :: MaxOutPts    = 514

!End of code generated by Matlab script
! ===================================================================================================
   INTEGER(IntKi), PARAMETER      :: BlPitchC (3) = (/ BlPitchC1, BlPitchC2, BlPitchC3 /) 
   INTEGER(IntKi), PARAMETER      :: BlAirfoilC (3) = (/ BlAirFlC1, BlAirFlC2, BlAirFlC3 /)

   ! Structural Control outputs -- these arrays simplify the output a little.  The MaxBlOuts and MaxStC
   !                               must be set according to what is in the OutListParameters and auto
   !                               generated code above.
   INTEGER(IntKi), PARAMETER      :: MaxBlOuts = 4    ! maximum number of blades that we can output for
   INTEGER(IntKi), PARAMETER      :: MaxStC    = 4    ! maximum number of StC outputs of type
   ! StC nacelle outputs -- maximum of 4 for now.  Expand if more needed
   INTEGER(IntKi), PARAMETER      :: NStC_XQ(MaxStC)    = (/ NStC1_XQ,  NStC2_XQ,  NStC3_XQ,  NStC4_XQ  /)
   INTEGER(IntKi), PARAMETER      :: NStC_XQD(MaxStC)   = (/ NStC1_XQD, NStC2_XQD, NStC3_XQD, NStC4_XQD /)
   INTEGER(IntKi), PARAMETER      :: NStC_YQ(MaxStC)    = (/ NStC1_YQ,  NStC2_YQ,  NStC3_YQ,  NStC4_YQ  /)
   INTEGER(IntKi), PARAMETER      :: NStC_YQD(MaxStC)   = (/ NStC1_YQD, NStC2_YQD, NStC3_YQD, NStC4_YQD /)
   INTEGER(IntKi), PARAMETER      :: NStC_ZQ(MaxStC)    = (/ NStC1_ZQ,  NStC2_ZQ,  NStC3_ZQ,  NStC4_ZQ  /)
   INTEGER(IntKi), PARAMETER      :: NStC_ZQD(MaxStC)   = (/ NStC1_ZQD, NStC2_ZQD, NStC3_ZQD, NStC4_ZQD /)
   INTEGER(IntKi), PARAMETER      :: NStC_Fxi(MaxStC)   = (/ NStC1_Fxi, NStC2_Fxi, NStC3_Fxi, NStC4_Fxi /)
   INTEGER(IntKi), PARAMETER      :: NStC_Fyi(MaxStC)   = (/ NStC1_Fyi, NStC2_Fyi, NStC3_Fyi, NStC4_Fyi /)
   INTEGER(IntKi), PARAMETER      :: NStC_Fzi(MaxStC)   = (/ NStC1_Fzi, NStC2_Fzi, NStC3_Fzi, NStC4_Fzi /)
   INTEGER(IntKi), PARAMETER      :: NStC_Mxi(MaxStC)   = (/ NStC1_Mxi, NStC2_Mxi, NStC3_Mxi, NStC4_Mxi /)
   INTEGER(IntKi), PARAMETER      :: NStC_Myi(MaxStC)   = (/ NStC1_Myi, NStC2_Myi, NStC3_Myi, NStC4_Myi /)
   INTEGER(IntKi), PARAMETER      :: NStC_Mzi(MaxStC)   = (/ NStC1_Mzi, NStC2_Mzi, NStC3_Mzi, NStC4_Mzi /)
   INTEGER(IntKi), PARAMETER      :: NStC_Fxn(MaxStC)   = (/ NStC1_Fxn, NStC2_Fxn, NStC3_Fxn, NStC4_Fxn /)
   INTEGER(IntKi), PARAMETER      :: NStC_Fyn(MaxStC)   = (/ NStC1_Fyn, NStC2_Fyn, NStC3_Fyn, NStC4_Fyn /)
   INTEGER(IntKi), PARAMETER      :: NStC_Fzn(MaxStC)   = (/ NStC1_Fzn, NStC2_Fzn, NStC3_Fzn, NStC4_Fzn /)
   INTEGER(IntKi), PARAMETER      :: NStC_Mxn(MaxStC)   = (/ NStC1_Mxn, NStC2_Mxn, NStC3_Mxn, NStC4_Mxn /)
   INTEGER(IntKi), PARAMETER      :: NStC_Myn(MaxStC)   = (/ NStC1_Myn, NStC2_Myn, NStC3_Myn, NStC4_Myn /)
   INTEGER(IntKi), PARAMETER      :: NStC_Mzn(MaxStC)   = (/ NStC1_Mzn, NStC2_Mzn, NStC3_Mzn, NStC4_Mzn /)
   ! StC tower outputs -- maximum of 4 for now.  Expand if more needed
   INTEGER(IntKi), PARAMETER      :: TStC_XQ(MaxStC)    = (/ TStC1_XQ,  TStC2_XQ,  TStC3_XQ,  TStC4_XQ  /)
   INTEGER(IntKi), PARAMETER      :: TStC_XQD(MaxStC)   = (/ TStC1_XQD, TStC2_XQD, TStC3_XQD, TStC4_XQD /)
   INTEGER(IntKi), PARAMETER      :: TStC_YQ(MaxStC)    = (/ TStC1_YQ,  TStC2_YQ,  TStC3_YQ,  TStC4_YQ  /)
   INTEGER(IntKi), PARAMETER      :: TStC_YQD(MaxStC)   = (/ TStC1_YQD, TStC2_YQD, TStC3_YQD, TStC4_YQD /)
   INTEGER(IntKi), PARAMETER      :: TStC_ZQ(MaxStC)    = (/ TStC1_ZQ,  TStC2_ZQ,  TStC3_ZQ,  TStC4_ZQ  /)
   INTEGER(IntKi), PARAMETER      :: TStC_ZQD(MaxStC)   = (/ TStC1_ZQD, TStC2_ZQD, TStC3_ZQD, TStC4_ZQD /)
   INTEGER(IntKi), PARAMETER      :: TStC_Fxi(MaxStC)   = (/ TStC1_Fxi, TStC2_Fxi, TStC3_Fxi, TStC4_Fxi /)
   INTEGER(IntKi), PARAMETER      :: TStC_Fyi(MaxStC)   = (/ TStC1_Fyi, TStC2_Fyi, TStC3_Fyi, TStC4_Fyi /)
   INTEGER(IntKi), PARAMETER      :: TStC_Fzi(MaxStC)   = (/ TStC1_Fzi, TStC2_Fzi, TStC3_Fzi, TStC4_Fzi /)
   INTEGER(IntKi), PARAMETER      :: TStC_Mxi(MaxStC)   = (/ TStC1_Mxi, TStC2_Mxi, TStC3_Mxi, TStC4_Mxi /)
   INTEGER(IntKi), PARAMETER      :: TStC_Myi(MaxStC)   = (/ TStC1_Myi, TStC2_Myi, TStC3_Myi, TStC4_Myi /)
   INTEGER(IntKi), PARAMETER      :: TStC_Mzi(MaxStC)   = (/ TStC1_Mzi, TStC2_Mzi, TStC3_Mzi, TStC4_Mzi /)
   INTEGER(IntKi), PARAMETER      :: TStC_Fxn(MaxStC)   = (/ TStC1_Fxn, TStC2_Fxn, TStC3_Fxn, TStC4_Fxn /)
   INTEGER(IntKi), PARAMETER      :: TStC_Fyn(MaxStC)   = (/ TStC1_Fyn, TStC2_Fyn, TStC3_Fyn, TStC4_Fyn /)
   INTEGER(IntKi), PARAMETER      :: TStC_Fzn(MaxStC)   = (/ TStC1_Fzn, TStC2_Fzn, TStC3_Fzn, TStC4_Fzn /)
   INTEGER(IntKi), PARAMETER      :: TStC_Mxn(MaxStC)   = (/ TStC1_Mxn, TStC2_Mxn, TStC3_Mxn, TStC4_Mxn /)
   INTEGER(IntKi), PARAMETER      :: TStC_Myn(MaxStC)   = (/ TStC1_Myn, TStC2_Myn, TStC3_Myn, TStC4_Myn /)
   INTEGER(IntKi), PARAMETER      :: TStC_Mzn(MaxStC)   = (/ TStC1_Mzn, TStC2_Mzn, TStC3_Mzn, TStC4_Mzn /)
   ! StC blade outputs -- maximum of 4 for now.  Expand if more needed
   INTEGER(IntKi), PARAMETER      :: BStC_XQ(MaxStC,MaxBlOuts) = reshape((/ &
                                         BStC1_B1_XQ,  BStC2_B1_XQ,  BStC3_B1_XQ,  BStC4_B1_XQ,  &
                                         BStC1_B2_XQ,  BStC2_B2_XQ,  BStC3_B2_XQ,  BStC4_B2_XQ,  &
                                         BStC1_B3_XQ,  BStC2_B3_XQ,  BStC3_B3_XQ,  BStC4_B3_XQ,  &
                                         BStC1_B4_XQ,  BStC2_B4_XQ,  BStC3_B4_XQ,  BStC4_B4_XQ   /),(/4,MaxBlOuts/))
   INTEGER(IntKi), PARAMETER      :: BStC_XQD(MaxStC,MaxBlOuts)= reshape((/ &
                                         BStC1_B1_XQD, BStC2_B1_XQD, BStC3_B1_XQD, BStC4_B1_XQD, &
                                         BStC1_B2_XQD, BStC2_B2_XQD, BStC3_B2_XQD, BStC4_B2_XQD, &
                                         BStC1_B3_XQD, BStC2_B3_XQD, BStC3_B3_XQD, BStC4_B3_XQD, &
                                         BStC1_B4_XQD, BStC2_B4_XQD, BStC3_B4_XQD, BStC4_B4_XQD  /),(/4,MaxBlOuts/))
   INTEGER(IntKi), PARAMETER      :: BStC_YQ(MaxStC,MaxBlOuts) = reshape((/ &
                                         BStC1_B1_YQ,  BStC2_B1_YQ,  BStC3_B1_YQ,  BStC4_B1_YQ,  &
                                         BStC1_B2_YQ,  BStC2_B2_YQ,  BStC3_B2_YQ,  BStC4_B2_YQ,  &
                                         BStC1_B3_YQ,  BStC2_B3_YQ,  BStC3_B3_YQ,  BStC4_B3_YQ,  &
                                         BStC1_B4_YQ,  BStC2_B4_YQ,  BStC3_B4_YQ,  BStC4_B4_YQ   /),(/4,MaxBlOuts/))
   INTEGER(IntKi), PARAMETER      :: BStC_YQD(MaxStC,MaxBlOuts)= reshape((/ &
                                         BStC1_B1_YQD, BStC2_B1_YQD, BStC3_B1_YQD, BStC4_B1_YQD, &
                                         BStC1_B2_YQD, BStC2_B2_YQD, BStC3_B2_YQD, BStC4_B2_YQD, &
                                         BStC1_B3_YQD, BStC2_B3_YQD, BStC3_B3_YQD, BStC4_B3_YQD, &
                                         BStC1_B4_YQD, BStC2_B4_YQD, BStC3_B4_YQD, BStC4_B4_YQD  /),(/4,MaxBlOuts/))
   INTEGER(IntKi), PARAMETER      :: BStC_ZQ(MaxStC,MaxBlOuts) = reshape((/ &
                                         BStC1_B1_ZQ,  BStC2_B1_ZQ,  BStC3_B1_ZQ,  BStC4_B1_ZQ,  &
                                         BStC1_B2_ZQ,  BStC2_B2_ZQ,  BStC3_B2_ZQ,  BStC4_B2_ZQ,  &
                                         BStC1_B3_ZQ,  BStC2_B3_ZQ,  BStC3_B3_ZQ,  BStC4_B3_ZQ,  &
                                         BStC1_B4_ZQ,  BStC2_B4_ZQ,  BStC3_B4_ZQ,  BStC4_B4_ZQ   /),(/4,MaxBlOuts/))
   INTEGER(IntKi), PARAMETER      :: BStC_ZQD(MaxStC,MaxBlOuts)= reshape((/ &
                                         BStC1_B1_ZQD, BStC2_B1_ZQD, BStC3_B1_ZQD, BStC4_B1_ZQD, &
                                         BStC1_B2_ZQD, BStC2_B2_ZQD, BStC3_B2_ZQD, BStC4_B2_ZQD, &
                                         BStC1_B3_ZQD, BStC2_B3_ZQD, BStC3_B3_ZQD, BStC4_B3_ZQD, &
                                         BStC1_B4_ZQD, BStC2_B4_ZQD, BStC3_B4_ZQD, BStC4_B4_ZQD  /),(/4,MaxBlOuts/))
   INTEGER(IntKi), PARAMETER      :: BStC_Fxi(MaxStC,MaxBlOuts)= reshape((/ &
                                         BStC1_B1_Fxi, BStC2_B1_Fxi, BStC3_B1_Fxi, BStC4_B1_Fxi, &
                                         BStC1_B2_Fxi, BStC2_B2_Fxi, BStC3_B2_Fxi, BStC4_B2_Fxi, &
                                         BStC1_B3_Fxi, BStC2_B3_Fxi, BStC3_B3_Fxi, BStC4_B3_Fxi, &
                                         BStC1_B4_Fxi, BStC2_B4_Fxi, BStC3_B4_Fxi, BStC4_B4_Fxi  /),(/4,MaxBlOuts/))
   INTEGER(IntKi), PARAMETER      :: BStC_Fyi(MaxStC,MaxBlOuts)= reshape((/ &
                                         BStC1_B1_Fyi, BStC2_B1_Fyi, BStC3_B1_Fyi, BStC4_B1_Fyi, &
                                         BStC1_B2_Fyi, BStC2_B2_Fyi, BStC3_B2_Fyi, BStC4_B2_Fyi, &
                                         BStC1_B3_Fyi, BStC2_B3_Fyi, BStC3_B3_Fyi, BStC4_B3_Fyi, &
                                         BStC1_B4_Fyi, BStC2_B4_Fyi, BStC3_B4_Fyi, BStC4_B4_Fyi  /),(/4,MaxBlOuts/))
   INTEGER(IntKi), PARAMETER      :: BStC_Fzi(MaxStC,MaxBlOuts)= reshape((/ &
                                         BStC1_B1_Fzi, BStC2_B1_Fzi, BStC3_B1_Fzi, BStC4_B1_Fzi, &
                                         BStC1_B2_Fzi, BStC2_B2_Fzi, BStC3_B2_Fzi, BStC4_B2_Fzi, &
                                         BStC1_B3_Fzi, BStC2_B3_Fzi, BStC3_B3_Fzi, BStC4_B3_Fzi, &
                                         BStC1_B4_Fzi, BStC2_B4_Fzi, BStC3_B4_Fzi, BStC4_B4_Fzi  /),(/4,MaxBlOuts/))
   INTEGER(IntKi), PARAMETER      :: BStC_Mxi(MaxStC,MaxBlOuts)= reshape((/ &
                                         BStC1_B1_Mxi, BStC2_B1_Mxi, BStC3_B1_Mxi, BStC4_B1_Mxi, &
                                         BStC1_B2_Mxi, BStC2_B2_Mxi, BStC3_B2_Mxi, BStC4_B2_Mxi, &
                                         BStC1_B3_Mxi, BStC2_B3_Mxi, BStC3_B3_Mxi, BStC4_B3_Mxi, &
                                         BStC1_B4_Mxi, BStC2_B4_Mxi, BStC3_B4_Mxi, BStC4_B4_Mxi  /),(/4,MaxBlOuts/))
   INTEGER(IntKi), PARAMETER      :: BStC_Myi(MaxStC,MaxBlOuts)= reshape((/ &
                                         BStC1_B1_Myi, BStC2_B1_Myi, BStC3_B1_Myi, BStC4_B1_Myi, &
                                         BStC1_B2_Myi, BStC2_B2_Myi, BStC3_B2_Myi, BStC4_B2_Myi, &
                                         BStC1_B3_Myi, BStC2_B3_Myi, BStC3_B3_Myi, BStC4_B3_Myi, &
                                         BStC1_B4_Myi, BStC2_B4_Myi, BStC3_B4_Myi, BStC4_B4_Myi  /),(/4,MaxBlOuts/))
   INTEGER(IntKi), PARAMETER      :: BStC_Mzi(MaxStC,MaxBlOuts)= reshape((/ &
                                         BStC1_B1_Mzi, BStC2_B1_Mzi, BStC3_B1_Mzi, BStC4_B1_Mzi, &
                                         BStC1_B2_Mzi, BStC2_B2_Mzi, BStC3_B2_Mzi, BStC4_B2_Mzi, &
                                         BStC1_B3_Mzi, BStC2_B3_Mzi, BStC3_B3_Mzi, BStC4_B3_Mzi, &
                                         BStC1_B4_Mzi, BStC2_B4_Mzi, BStC3_B4_Mzi, BStC4_B4_Mzi  /),(/4,MaxBlOuts/))
   INTEGER(IntKi), PARAMETER      :: BStC_Fxn(MaxStC,MaxBlOuts)= reshape((/ &
                                         BStC1_B1_Fxn, BStC2_B1_Fxn, BStC3_B1_Fxn, BStC4_B1_Fxn, &
                                         BStC1_B2_Fxn, BStC2_B2_Fxn, BStC3_B2_Fxn, BStC4_B2_Fxn, &
                                         BStC1_B3_Fxn, BStC2_B3_Fxn, BStC3_B3_Fxn, BStC4_B3_Fxn, &
                                         BStC1_B4_Fxn, BStC2_B4_Fxn, BStC3_B4_Fxn, BStC4_B4_Fxn  /),(/4,MaxBlOuts/))
   INTEGER(IntKi), PARAMETER      :: BStC_Fyn(MaxStC,MaxBlOuts)= reshape((/ &
                                         BStC1_B1_Fyn, BStC2_B1_Fyn, BStC3_B1_Fyn, BStC4_B1_Fyn, &
                                         BStC1_B2_Fyn, BStC2_B2_Fyn, BStC3_B2_Fyn, BStC4_B2_Fyn, &
                                         BStC1_B3_Fyn, BStC2_B3_Fyn, BStC3_B3_Fyn, BStC4_B3_Fyn, &
                                         BStC1_B1_Fyn, BStC2_B1_Fyn, BStC3_B1_Fyn, BStC4_B1_Fyn  /),(/4,MaxBlOuts/))
   INTEGER(IntKi), PARAMETER      :: BStC_Fzn(MaxStC,MaxBlOuts)= reshape((/ &
                                         BStC1_B1_Fzn, BStC2_B1_Fzn, BStC3_B1_Fzn, BStC4_B1_Fzn, &
                                                                   BStC1_B2_Fzn, BStC2_B2_Fzn, BStC3_B2_Fzn, BStC4_B2_Fzn, &
                                                                   BStC1_B3_Fzn, BStC2_B3_Fzn, BStC3_B3_Fzn, BStC4_B3_Fzn, &
                                                                   BStC1_B4_Fzn, BStC2_B4_Fzn, BStC3_B4_Fzn, BStC4_B4_Fzn  /),(/4,MaxBlOuts/))
   INTEGER(IntKi), PARAMETER      :: BStC_Mxn(MaxStC,MaxBlOuts)= reshape((/ &
                                         BStC1_B1_Mxn, BStC2_B1_Mxn, BStC3_B1_Mxn, BStC4_B1_Mxn, &
                                                                   BStC1_B2_Mxn, BStC2_B2_Mxn, BStC3_B2_Mxn, BStC4_B2_Mxn, &
                                                                   BStC1_B3_Mxn, BStC2_B3_Mxn, BStC3_B3_Mxn, BStC4_B3_Mxn, &
                                                                   BStC1_B4_Mxn, BStC2_B4_Mxn, BStC3_B4_Mxn, BStC4_B4_Mxn  /),(/4,MaxBlOuts/))
   INTEGER(IntKi), PARAMETER      :: BStC_Myn(MaxStC,MaxBlOuts)= reshape((/ &
                                         BStC1_B1_Myn, BStC2_B1_Myn, BStC3_B1_Myn, BStC4_B1_Myn, &
                                                                   BStC1_B2_Myn, BStC2_B2_Myn, BStC3_B2_Myn, BStC4_B2_Myn, &
                                                                   BStC1_B3_Myn, BStC2_B3_Myn, BStC3_B3_Myn, BStC4_B3_Myn, &
                                                                   BStC1_B4_Myn, BStC2_B4_Myn, BStC3_B4_Myn, BStC4_B4_Myn  /),(/4,MaxBlOuts/))
   INTEGER(IntKi), PARAMETER      :: BStC_Mzn(MaxStC,MaxBlOuts)= reshape((/ &
                                         BStC1_B1_Mzn, BStC2_B1_Mzn, BStC3_B1_Mzn, BStC4_B1_Mzn, &
                                         BStC1_B2_Mzn, BStC2_B2_Mzn, BStC3_B2_Mzn, BStC4_B2_Mzn, &
                                         BStC1_B3_Mzn, BStC2_B3_Mzn, BStC3_B3_Mzn, BStC4_B3_Mzn, &
                                         BStC1_B4_Mzn, BStC2_B4_Mzn, BStC3_B4_Mzn, BStC4_B4_Mzn  /),(/4,MaxBlOuts/))
   ! StC Platform outputs -- maximum of 4 for now.  Expand if more needed
   INTEGER(IntKi), PARAMETER      :: PtfmStC_XQ(MaxStC)    = (/ PtfmStC1_XQ,  PtfmStC2_XQ,  PtfmStC3_XQ,  PtfmStC4_XQ  /)
   INTEGER(IntKi), PARAMETER      :: PtfmStC_XQD(MaxStC)   = (/ PtfmStC1_XQD, PtfmStC2_XQD, PtfmStC3_XQD, PtfmStC4_XQD /)
   INTEGER(IntKi), PARAMETER      :: PtfmStC_YQ(MaxStC)    = (/ PtfmStC1_YQ,  PtfmStC2_YQ,  PtfmStC3_YQ,  PtfmStC4_YQ  /)
   INTEGER(IntKi), PARAMETER      :: PtfmStC_YQD(MaxStC)   = (/ PtfmStC1_YQD, PtfmStC2_YQD, PtfmStC3_YQD, PtfmStC4_YQD /)
   INTEGER(IntKi), PARAMETER      :: PtfmStC_ZQ(MaxStC)    = (/ PtfmStC1_ZQ,  PtfmStC2_ZQ,  PtfmStC3_ZQ,  PtfmStC4_ZQ  /)
   INTEGER(IntKi), PARAMETER      :: PtfmStC_ZQD(MaxStC)   = (/ PtfmStC1_ZQD, PtfmStC2_ZQD, PtfmStC3_ZQD, PtfmStC4_ZQD /)
   INTEGER(IntKi), PARAMETER      :: PtfmStC_Fxi(MaxStC)   = (/ PtfmStC1_Fxi, PtfmStC2_Fxi, PtfmStC3_Fxi, PtfmStC4_Fxi /)
   INTEGER(IntKi), PARAMETER      :: PtfmStC_Fyi(MaxStC)   = (/ PtfmStC1_Fyi, PtfmStC2_Fyi, PtfmStC3_Fyi, PtfmStC4_Fyi /)
   INTEGER(IntKi), PARAMETER      :: PtfmStC_Fzi(MaxStC)   = (/ PtfmStC1_Fzi, PtfmStC2_Fzi, PtfmStC3_Fzi, PtfmStC4_Fzi /)
   INTEGER(IntKi), PARAMETER      :: PtfmStC_Mxi(MaxStC)   = (/ PtfmStC1_Mxi, PtfmStC2_Mxi, PtfmStC3_Mxi, PtfmStC4_Mxi /)
   INTEGER(IntKi), PARAMETER      :: PtfmStC_Myi(MaxStC)   = (/ PtfmStC1_Myi, PtfmStC2_Myi, PtfmStC3_Myi, PtfmStC4_Myi /)
   INTEGER(IntKi), PARAMETER      :: PtfmStC_Mzi(MaxStC)   = (/ PtfmStC1_Mzi, PtfmStC2_Mzi, PtfmStC3_Mzi, PtfmStC4_Mzi /)
   INTEGER(IntKi), PARAMETER      :: PtfmStC_Fxn(MaxStC)   = (/ PtfmStC1_Fxn, PtfmStC2_Fxn, PtfmStC3_Fxn, PtfmStC4_Fxn /)
   INTEGER(IntKi), PARAMETER      :: PtfmStC_Fyn(MaxStC)   = (/ PtfmStC1_Fyn, PtfmStC2_Fyn, PtfmStC3_Fyn, PtfmStC4_Fyn /)
   INTEGER(IntKi), PARAMETER      :: PtfmStC_Fzn(MaxStC)   = (/ PtfmStC1_Fzn, PtfmStC2_Fzn, PtfmStC3_Fzn, PtfmStC4_Fzn /)
   INTEGER(IntKi), PARAMETER      :: PtfmStC_Mxn(MaxStC)   = (/ PtfmStC1_Mxn, PtfmStC2_Mxn, PtfmStC3_Mxn, PtfmStC4_Mxn /)
   INTEGER(IntKi), PARAMETER      :: PtfmStC_Myn(MaxStC)   = (/ PtfmStC1_Myn, PtfmStC2_Myn, PtfmStC3_Myn, PtfmStC4_Myn /)
   INTEGER(IntKi), PARAMETER      :: PtfmStC_Mzn(MaxStC)   = (/ PtfmStC1_Mzn, PtfmStC2_Mzn, PtfmStC3_Mzn, PtfmStC4_Mzn /)



CONTAINS
!---------------------------
subroutine Set_SrvD_Outs( p, y, m, AllOuts )
   type(SrvD_ParameterType),                    intent(in   )  :: p           !< Parameters
   type(SrvD_OutputType),                       intent(in   )  :: y           !< Outputs computed at Time
   type(SrvD_MiscVarType),                      intent(inout)  :: m           !< Misc (optimization) variables
   real(ReKi),                                  intent(inout)  :: AllOuts(:)  ! All the the available output channels
   integer  :: K

   !...............................................................................................................................   
   ! Calculate all of the available output channels:
   !...............................................................................................................................   
      ! This is overwriting the values if it was called from UpdateStates, but they 
      ! should be the same and this sets the values if we called the DLL above.
   m%dll_data%ElecPwr_prev = y%ElecPwr
   m%dll_data%GenTrq_prev  = y%GenTrq
   
   !...............................................................................................................................   
   ! Calculate all of the available output channels:
   !...............................................................................................................................   
!   AllOuts(Time) = t    
   
   AllOuts(GenTq)   = 0.001*y%GenTrq
   AllOuts(GenPwr)  = 0.001*y%ElecPwr
   AllOuts(HSSBrTqC)= 0.001*y%HSSBrTrqC

   DO K=1,p%NumBl
      AllOuts( BlPitchC(K) )     = y%BlPitchCom(K)*R2D
      AllOuts( BlAirfoilC(K) )   = y%BlAirfoilCom(K)
   END DO

   AllOuts(YawMomCom) = -0.001*y%YawMom

end subroutine Set_Srvd_Outs
!---------------------------
subroutine Set_NStC_Outs( p_SrvD, x, m, y, AllOuts )     ! Nacelle
   type(SrvD_ParameterType),                    intent(in   )  :: p_SrvD      !< Parameters
   type(StC_ContinuousStateType),   allocatable,intent(in   )  :: x(:)        !< Continuous states at t
   type(StC_MiscVarType),           allocatable,intent(in   )  :: m(:)        !< Misc (optimization) variables
   type(StC_OutputType),            allocatable,intent(in   )  :: y(:)        !< Outputs computed at Time
   real(ReKi),                                  intent(inout)  :: AllOuts(:)  ! All the the available output channels
   integer  :: i,j
   j=1
   if (allocated(x) .and. allocated(m) .and. allocated(y)) then
      do i=1,min(p_SrvD%CompNStC,MaxStC)                 ! in case we have more Nacelle StCs than the outputs are set for
         AllOuts(NStC_XQ( i)) = x(i)%StC_x(1,1)          ! x
         AllOuts(NStC_XQD(i)) = x(i)%StC_x(2,1)          ! x-dot
         AllOuts(NStC_YQ( i)) = x(i)%StC_x(3,1)          ! y
         AllOuts(NStC_YQD(i)) = x(i)%StC_x(4,1)          ! y-dot
         AllOuts(NStC_ZQ( i)) = x(i)%StC_x(5,1)          ! z
         AllOuts(NStC_ZQD(i)) = x(i)%StC_x(6,1)          ! z-dot
         AllOuts(NStC_Fxi(i)) = y(i)%Mesh(j)%Force(1,1)  ! only one mesh per NStC instance
         AllOuts(NStC_Fyi(i)) = y(i)%Mesh(j)%Force(2,1)  ! only one mesh per NStC instance
         AllOuts(NStC_Fzi(i)) = y(i)%Mesh(j)%Force(3,1)  ! only one mesh per NStC instance
         AllOuts(NStC_Mxi(i)) = y(i)%Mesh(j)%Moment(1,1) ! only one mesh per NStC instance
         AllOuts(NStC_Myi(i)) = y(i)%Mesh(j)%Moment(2,1) ! only one mesh per NStC instance
         AllOuts(NStC_Mzi(i)) = y(i)%Mesh(j)%Moment(3,1) ! only one mesh per NStC instance
         AllOuts(NStC_Fxn(i)) = m(i)%F_P(1,j)
         AllOuts(NStC_Fyn(i)) = m(i)%F_P(2,j)
         AllOuts(NStC_Fzn(i)) = m(i)%F_P(3,j)
         AllOuts(NStC_Mxn(i)) = m(i)%M_P(1,j)
         AllOuts(NStC_Myn(i)) = m(i)%M_P(2,j)
         AllOuts(NStC_Mzn(i)) = m(i)%M_P(3,j)
      enddo
   endif
end subroutine Set_NStC_Outs
!---------------------------
subroutine Set_TStC_Outs( p_SrvD, x, m, y, AllOuts )     ! Tower
   type(SrvD_ParameterType),                    intent(in   )  :: p_SrvD      !< Parameters
   type(StC_ContinuousStateType),   allocatable,intent(in   )  :: x(:)        !< Continuous states at t
   type(StC_MiscVarType),           allocatable,intent(in   )  :: m(:)        !< Misc (optimization) variables
   type(StC_OutputType),            allocatable,intent(in   )  :: y(:)        !< Outputs computed at Time
   real(ReKi),                                  intent(inout)  :: AllOuts(:)  ! All the the available output channels
   integer  :: i,j
   j=1
   if (allocated(x) .and. allocated(m) .and. allocated(y)) then
      do i=1,min(p_SrvD%CompTStC,MaxStC)                 ! in case we have more Nacelle StCs than the outputs are set for
         AllOuts(TStC_XQ( i)) = x(i)%StC_x(1,1)          ! x
         AllOuts(TStC_XQD(i)) = x(i)%StC_x(2,1)          ! x-dot
         AllOuts(TStC_YQ( i)) = x(i)%StC_x(3,1)          ! y
         AllOuts(TStC_YQD(i)) = x(i)%StC_x(4,1)          ! y-dot
         AllOuts(TStC_ZQ( i)) = x(i)%StC_x(5,1)          ! z
         AllOuts(TStC_ZQD(i)) = x(i)%StC_x(6,1)          ! z-dot
         AllOuts(TStC_Fxi(i)) = y(i)%Mesh(j)%Force(1,1)  ! only one mesh per TStC instance
         AllOuts(TStC_Fyi(i)) = y(i)%Mesh(j)%Force(2,1)  ! only one mesh per TStC instance
         AllOuts(TStC_Fzi(i)) = y(i)%Mesh(j)%Force(3,1)  ! only one mesh per TStC instance
         AllOuts(TStC_Mxi(i)) = y(i)%Mesh(j)%Moment(1,1) ! only one mesh per TStC instance
         AllOuts(TStC_Myi(i)) = y(i)%Mesh(j)%Moment(2,1) ! only one mesh per TStC instance
         AllOuts(TStC_Mzi(i)) = y(i)%Mesh(j)%Moment(3,1) ! only one mesh per TStC instance
         AllOuts(TStC_Fxn(i)) = m(i)%F_P(1,j)
         AllOuts(TStC_Fyn(i)) = m(i)%F_P(2,j)
         AllOuts(TStC_Fzn(i)) = m(i)%F_P(3,j)
         AllOuts(TStC_Mxn(i)) = m(i)%M_P(1,j)
         AllOuts(TStC_Myn(i)) = m(i)%M_P(2,j)
         AllOuts(TStC_Mzn(i)) = m(i)%M_P(3,j)
      enddo
   endif
end subroutine Set_TStC_Outs
!---------------------------
subroutine Set_BStC_Outs( p_SrvD, x, m, y, AllOuts )        ! Blades
   type(SrvD_ParameterType),                    intent(in   )  :: p_SrvD      !< Parameters
   type(StC_ContinuousStateType),   allocatable,intent(in   )  :: x(:)        !< Continuous states at t
   type(StC_MiscVarType),           allocatable,intent(in   )  :: m(:)        !< Misc (optimization) variables
   type(StC_OutputType),            allocatable,intent(in   )  :: y(:)        !< Outputs computed at Time
   real(ReKi),                                  intent(inout)  :: AllOuts(:)  ! All the the available output channels
   integer  :: i,j
   if (allocated(x) .and. allocated(m) .and. allocated(y)) then
      do j=1,min(p_SrvD%NumBl,MaxBlOuts)
         do i=1,min(p_SrvD%CompBStC,MaxStC)                 ! in case we have more Nacelle StCs than the outputs are set for
            AllOuts(BStC_XQ( i,j)) = x(i)%StC_x(1,j)          ! x
            AllOuts(BStC_XQD(i,j)) = x(i)%StC_x(2,j)          ! x-dot
            AllOuts(BStC_YQ( i,j)) = x(i)%StC_x(3,j)          ! y
            AllOuts(BStC_YQD(i,j)) = x(i)%StC_x(4,j)          ! y-dot
            AllOuts(BStC_ZQ( i,j)) = x(i)%StC_x(5,j)          ! z
            AllOuts(BStC_ZQD(i,j)) = x(i)%StC_x(6,j)          ! z-dot
            AllOuts(BStC_Fxi(i,j)) = y(i)%Mesh(j)%Force(1,1)  ! only one mesh per BStC instance
            AllOuts(BStC_Fyi(i,j)) = y(i)%Mesh(j)%Force(2,1)  ! only one mesh per BStC instance
            AllOuts(BStC_Fzi(i,j)) = y(i)%Mesh(j)%Force(3,1)  ! only one mesh per BStC instance
            AllOuts(BStC_Mxi(i,j)) = y(i)%Mesh(j)%Moment(1,1) ! only one mesh per BStC instance
            AllOuts(BStC_Myi(i,j)) = y(i)%Mesh(j)%Moment(2,1) ! only one mesh per BStC instance
            AllOuts(BStC_Mzi(i,j)) = y(i)%Mesh(j)%Moment(3,1) ! only one mesh per BStC instance
            AllOuts(BStC_Fxn(i,j)) = m(i)%F_P(1,j)
            AllOuts(BStC_Fyn(i,j)) = m(i)%F_P(2,j)
            AllOuts(BStC_Fzn(i,j)) = m(i)%F_P(3,j)
            AllOuts(BStC_Mxn(i,j)) = m(i)%M_P(1,j)
            AllOuts(BStC_Myn(i,j)) = m(i)%M_P(2,j)
            AllOuts(BStC_Mzn(i,j)) = m(i)%M_P(3,j)
         enddo
      enddo
   endif
end subroutine Set_BStC_Outs
!---------------------------
subroutine Set_PtfmStC_Outs( p_SrvD, x, m, y, AllOuts )     ! Platform 
   type(SrvD_ParameterType),                    intent(in   )  :: p_SrvD      !< Parameters
   type(StC_ContinuousStateType),   allocatable,intent(in   )  :: x(:)        !< Continuous states at t
   type(StC_MiscVarType),           allocatable,intent(in   )  :: m(:)        !< Misc (optimization) variables
   type(StC_OutputType),            allocatable,intent(in   )  :: y(:)        !< Outputs computed at Time
   real(ReKi),                                  intent(inout)  :: AllOuts(:)  ! All the the available output channels
   integer  :: i,j
   j=1
   if (allocated(x) .and. allocated(m) .and. allocated(y)) then
      do i=1,min(p_SrvD%CompPtfmStC,MaxStC)                 ! in case we have more Nacelle StCs than the outputs are set for
         AllOuts(PtfmStC_XQ( i)) = x(i)%StC_x(1,1)          ! x
         AllOuts(PtfmStC_XQD(i)) = x(i)%StC_x(2,1)          ! x-dot
         AllOuts(PtfmStC_YQ( i)) = x(i)%StC_x(3,1)          ! y
         AllOuts(PtfmStC_YQD(i)) = x(i)%StC_x(4,1)          ! y-dot
         AllOuts(PtfmStC_ZQ( i)) = x(i)%StC_x(5,1)          ! z
         AllOuts(PtfmStC_ZQD(i)) = x(i)%StC_x(6,1)          ! z-dot
         AllOuts(PtfmStC_Fxi(i)) = y(i)%Mesh(j)%Force(1,1)  ! only one mesh per PtfmStC instance
         AllOuts(PtfmStC_Fyi(i)) = y(i)%Mesh(j)%Force(2,1)  ! only one mesh per PtfmStC instance
         AllOuts(PtfmStC_Fzi(i)) = y(i)%Mesh(j)%Force(3,1)  ! only one mesh per PtfmStC instance
         AllOuts(PtfmStC_Mxi(i)) = y(i)%Mesh(j)%Moment(1,1) ! only one mesh per PtfmStC instance
         AllOuts(PtfmStC_Myi(i)) = y(i)%Mesh(j)%Moment(2,1) ! only one mesh per PtfmStC instance
         AllOuts(PtfmStC_Mzi(i)) = y(i)%Mesh(j)%Moment(3,1) ! only one mesh per PtfmStC instance
         AllOuts(PtfmStC_Fxn(i)) = m(i)%F_P(1,j)
         AllOuts(PtfmStC_Fyn(i)) = m(i)%F_P(2,j)
         AllOuts(PtfmStC_Fzn(i)) = m(i)%F_P(3,j)
         AllOuts(PtfmStC_Mxn(i)) = m(i)%M_P(1,j)
         AllOuts(PtfmStC_Myn(i)) = m(i)%M_P(2,j)
         AllOuts(PtfmStC_Mzn(i)) = m(i)%M_P(3,j)
      enddo
   endif
end subroutine Set_PtfmStC_Outs
!---------------------------

!----------------------------------------------------------------------------------------------------------------------------------
!> This subroutine parses the input file and stores all the data in the SrvD_InputFile structure.
!! It does not perform data validation.
subroutine ParseInputFileInfo( PriPath, InputFile, OutFileRoot, FileInfo_In, InputFileData, Default_DT, ErrStat, ErrMsg )

   implicit    none

      ! Passed variables
   character(*),                    intent(in   )  :: PriPath           ! Path name of the primary file
   character(*),                    intent(in   )  :: InputFile         !< Name of the file containing the primary input data
   character(*),                    intent(in   )  :: OutFileRoot       !< The rootname of the echo file, possibly opened in this routine
   type(SrvD_InputFile),            intent(  out)  :: InputFileData     !< All the data in the StrucCtrl input file
   type(FileInfoType),              intent(in   )  :: FileInfo_In       !< The derived type for holding the file information.
   real(DbKi),                      intent(in   )  :: Default_DT        !< The default DT (from glue code)
   integer(IntKi),                  intent(  out)  :: ErrStat           !< Error status
   character(ErrMsgLen),            intent(  out)  :: ErrMsg            !< Error message

      ! Local variables:
   integer(IntKi)                                  :: i                 !< generic counter
   character(20)                                   :: TmpChr            !< Temporary char array
   integer(IntKi)                                  :: UnEcho
   integer(IntKi)                                  :: ErrStat2          !< Temporary Error status
   character(ErrMsgLen)                            :: ErrMsg2           !< Temporary Error message
   integer(IntKi)                                  :: CurLine           !< current entry in FileInfo_In%Lines array
   real(ReKi)                                      :: TmpRe2(2)         !< temporary 2 number array for reading values in
   character(*), parameter                         :: RoutineName = 'ParseInputFileInfo'


   ! Initialization
   ErrStat  =  ErrID_None
   ErrMsg   =  ""
   UnEcho   = -1     ! Echo file unit.  >0 when used

   call AllocAry( InputFileData%OutList, MaxOutPts, "ServoDyn Input File's Outlist", ErrStat2, ErrMsg2 )
      if (Failed()) return;

      ! Give verbose info on what we are reading
   if (NWTC_VerboseLevel == NWTC_Verbose) THEN
      call WrScr( ' Heading of the ServoDyn input file: ' )      
      call WrScr( '   '//trim( FileInfo_In%Lines(2) ) )
   end if

   !-------------------------------------------------------------------------------------------------
   ! General settings
   !-------------------------------------------------------------------------------------------------
   CurLine = 4    ! Skip the first three lines as they are known to be header lines and separators
   call ParseVar( FileInfo_In, CurLine, 'Echo', InputFileData%Echo, ErrStat2, ErrMsg2 )
         if (Failed()) return;

   if ( InputFileData%Echo ) then
      CALL OpenEcho ( UnEcho, TRIM(OutFileRoot)//'.ech', ErrStat2, ErrMsg2 )
         if (Failed()) return;
      WRITE(UnEcho, '(A)') 'Echo file for ServoDyn input file: '//trim(InputFile)
      ! Write the first three lines into the echo file
      WRITE(UnEcho, '(A)') FileInfo_In%Lines(1)
      WRITE(UnEcho, '(A)') FileInfo_In%Lines(2)
      WRITE(UnEcho, '(A)') FileInfo_In%Lines(3)

      CurLine = 4
      call ParseVar( FileInfo_In, CurLine, 'Echo', InputFileData%Echo, ErrStat2, ErrMsg2, UnEcho )
            if (Failed()) return
   endif

      !  DT - Communication interval for controllers (s) (or "default")
   call ParseVarWDefault ( FileInfo_In, CurLine, 'DT', InputFileData%DT, Default_DT, ErrStat2, ErrMsg2, UnEcho )


   !---------------------- PITCH CONTROL -------------------------------------------
   if ( InputFileData%Echo )   WRITE(UnEcho, '(A)') FileInfo_In%Lines(CurLine)    ! Write section break to echo
   CurLine = CurLine + 1
      !  PCMode (switch) - Pitch control mode { 0: none
      !                                         3: user-defined from routine PitchCntrl,
      !                                         4: user-defined from Simulink/Labview
      !                                         5: user-defined from Bladed-style DLL} (switch)
   call ParseVar( FileInfo_In, CurLine, 'PCMode', InputFileData%PCMode, ErrStat2, ErrMsg2, UnEcho )
      if (Failed())  return;
      !  TPCOn          - Time to enable active pitch control (s) [unused when PCMode=0]
   call ParseVar( FileInfo_In, CurLine, 'TPCOn', InputFileData%TPCOn, ErrStat2, ErrMsg2, UnEcho )
      if (Failed())  return;

      !  TPitManS       - Time to start override pitch maneuver for blade 1 and end standard pitch control (s)
   do i=1,size(InputFileData%TPitManS)
      TmpChr='TPitManS('//trim(Num2LStr(i))//')'
      call ParseVar( FileInfo_In, CurLine, trim(TmpChr), InputFileData%TPitManS(i), ErrStat2, ErrMsg2, UnEcho )
         if (Failed())  return;
   enddo

      !  PitManRat      - Pitch rate at which override pitch maneuver heads toward final pitch angle for blade 1 (deg/s)
   do i=1,size(InputFileData%PitManRat)
      TmpChr='PitManRat('//trim(Num2LStr(i))//')'
      call ParseVar( FileInfo_In, CurLine, trim(TmpChr), InputFileData%PitManRat(i), ErrStat2, ErrMsg2, UnEcho )
         if (Failed())  return;
   enddo

      !  BlPitchF       - Blade 1 final pitch for pitch maneuvers (degrees)
   do i=1,size(InputFileData%BlPitchF)
      TmpChr='BlPitchF('//trim(Num2LStr(i))//')'
      call ParseVar( FileInfo_In, CurLine, trim(TmpChr), InputFileData%BlPitchF(i), ErrStat2, ErrMsg2, UnEcho )
         if (Failed())  return;
   enddo
   InputFileData%BlPitchF = InputFileData%BlPitchF*D2R


   !---------------------- GENERATOR AND TORQUE CONTROL ----------------------------
   if ( InputFileData%Echo )   WRITE(UnEcho, '(A)') FileInfo_In%Lines(CurLine)    ! Write section break to echo
   CurLine = CurLine + 1
      !  VSContrl (switch) - Variable-speed control mode {
      !                          0: none
      !                          1: simple VS,
      !                          3: user-defined from routine UserVSCont,
      !                          4: user-defined from Simulink/Labview,
      !                          5: user-defined from Bladed-style DLL}
   call ParseVar( FileInfo_In, CurLine, 'VSContrl', InputFileData%VSContrl, ErrStat2, ErrMsg2, UnEcho )
      if (Failed())  return;
      !  GenModel       - Generator model {1: simple, 2: Thevenin, 3: user-defined from routine UserGen} (switch) [used only when VSContrl=0]
   call ParseVar( FileInfo_In, CurLine, 'GenModel', InputFileData%GenModel, ErrStat2, ErrMsg2, UnEcho )
      if (Failed())  return;
      !  GenEff         - Generator efficiency [ignored by the Thevenin and user-defined generator models] (
   call ParseVar( FileInfo_In, CurLine, 'GenEff', InputFileData%GenEff, ErrStat2, ErrMsg2, UnEcho )
      if (Failed())  return;
   InputFileData%GenEff = InputFileData%GenEff*0.01      
      !  GenTiStr       - Method to start the generator {T: timed using TimGenOn, F: generator speed using SpdGenOn} (flag)
   call ParseVar( FileInfo_In, CurLine, 'GenTiStr', InputFileData%GenTiStr, ErrStat2, ErrMsg2, UnEcho )
      if (Failed())  return;
      !  GenTiStp       - Method to stop the generator {T: timed using TimGenOf, F: when generator power = 0} (flag)
   call ParseVar( FileInfo_In, CurLine, 'GenTiStp', InputFileData%GenTiStp, ErrStat2, ErrMsg2, UnEcho )
      if (Failed())  return;
      !  SpdGenOn       - Generator speed to turn on the generator for a startup (HSS speed) (rpm) [used only when GenTiStr=False]
   call ParseVar( FileInfo_In, CurLine, 'SpdGenOn', InputFileData%SpdGenOn, ErrStat2, ErrMsg2, UnEcho )
      if (Failed())  return;
   InputFileData%SpdGenOn = InputFileData%SpdGenOn*RPM2RPS
      !  TimGenOn       - Time to turn on the generator for a startup (s) [used only when GenTiStr=True]
   call ParseVar( FileInfo_In, CurLine, 'TimGenOn', InputFileData%TimGenOn, ErrStat2, ErrMsg2, UnEcho )
      if (Failed())  return;
      !  TimGenOf       - Time to turn off the generator (s) [used only when GenTiStp=True]
   call ParseVar( FileInfo_In, CurLine, 'TimGenOf', InputFileData%TimGenOf, ErrStat2, ErrMsg2, UnEcho )
      if (Failed())  return;


   !---------------------- SIMPLE VARIABLE-SPEED TORQUE CONTROL --------------------
   if ( InputFileData%Echo )   WRITE(UnEcho, '(A)') FileInfo_In%Lines(CurLine)    ! Write section break to echo
   CurLine = CurLine + 1
      !  VS_RtGnSp      - Rated generator speed for simple variable-speed generator control (HSS side) (rpm) [used only when VSContrl=1]
   call ParseVar( FileInfo_In, CurLine, 'VS_RtGnSp', InputFileData%VS_RtGnSp, ErrStat2, ErrMsg2, UnEcho )
      if (Failed())  return;
   InputFileData%VS_RtGnSp = InputFileData%VS_RtGnSp*RPM2RPS
      !  VS_RtTq        - Rated generator torque/constant generator torque in Region 3 for simple variable-speed generator control (HSS side) (N-m) [used only when VSContrl=1]
   call ParseVar( FileInfo_In, CurLine, 'VS_RtTq', InputFileData%VS_RtTq, ErrStat2, ErrMsg2, UnEcho )
      if (Failed())  return;
      !  VS_Rgn2K       - Generator torque constant in Region 2 for simple variable-speed generator control (HSS side) (N-m/rpm^2) [used only when VSContrl=1]
   call ParseVar( FileInfo_In, CurLine, 'VS_Rgn2K', InputFileData%VS_Rgn2K, ErrStat2, ErrMsg2, UnEcho )
      if (Failed())  return;
   InputFileData%VS_Rgn2K = InputFileData%VS_Rgn2K/( RPM2RPS**2 )
      !  VS_SlPc        - Rated generator slip percentage in Region 2 1/2 for simple variable-speed generator control (
   call ParseVar( FileInfo_In, CurLine, 'VS_SlPc', InputFileData%VS_SlPc, ErrStat2, ErrMsg2, UnEcho )
      if (Failed())  return;
   InputFileData%VS_SlPc = InputFileData%VS_SlPc*.01


   !---------------------- SIMPLE INDUCTION GENERATOR ------------------------------
   if ( InputFileData%Echo )   WRITE(UnEcho, '(A)') FileInfo_In%Lines(CurLine)    ! Write section break to echo
   CurLine = CurLine + 1
      !  SIG_SlPc       - Rated generator slip percentage (
   call ParseVar( FileInfo_In, CurLine, 'SIG_SlPc', InputFileData%SIG_SlPc, ErrStat2, ErrMsg2, UnEcho )
      if (Failed())  return;
   InputFileData%SIG_SlPc = InputFileData%SIG_SlPc*.01
      !  SIG_SySp       - Synchronous (zero-torque) generator speed (rpm) [used only when VSContrl=0 and GenModel=1]
   call ParseVar( FileInfo_In, CurLine, 'SIG_SySp', InputFileData%SIG_SySp, ErrStat2, ErrMsg2, UnEcho )
      if (Failed())  return;
   InputFileData%SIG_SySp = InputFileData%SIG_SySp*RPM2RPS  
      !  SIG_RtTq       - Rated torque (N-m) [used only when VSContrl=0 and GenModel=1]
   call ParseVar( FileInfo_In, CurLine, 'SIG_RtTq', InputFileData%SIG_RtTq, ErrStat2, ErrMsg2, UnEcho )
      if (Failed())  return;
      !  SIG_PORt       - Pull-out ratio (Tpullout/Trated) (-) [used only when VSContrl=0 and GenModel=1]
   call ParseVar( FileInfo_In, CurLine, 'SIG_PORt', InputFileData%SIG_PORt, ErrStat2, ErrMsg2, UnEcho )
      if (Failed())  return;


   !---------------------- THEVENIN-EQUIVALENT INDUCTION GENERATOR -----------------
   if ( InputFileData%Echo )   WRITE(UnEcho, '(A)') FileInfo_In%Lines(CurLine)    ! Write section break to echo
   CurLine = CurLine + 1
      !  TEC_Freq       - Line frequency [50 or 60] (Hz) [used only when VSContrl=0 and GenModel=2]
   call ParseVar( FileInfo_In, CurLine, 'TEC_Freq', InputFileData%TEC_Freq, ErrStat2, ErrMsg2, UnEcho )
      if (Failed())  return;
      !  TEC_NPol       - Number of poles [even integer > 0] (-) [used only when VSContrl=0 and GenModel=2]
   call ParseVar( FileInfo_In, CurLine, 'TEC_NPol', InputFileData%TEC_NPol, ErrStat2, ErrMsg2, UnEcho )
      if (Failed())  return;
      !  TEC_SRes       - Stator resistance (ohms) [used only when VSContrl=0 and GenModel=2]
   call ParseVar( FileInfo_In, CurLine, 'TEC_SRes', InputFileData%TEC_SRes, ErrStat2, ErrMsg2, UnEcho )
      if (Failed())  return;
      !  TEC_RRes       - Rotor resistance (ohms) [used only when VSContrl=0 and GenModel=2]
   call ParseVar( FileInfo_In, CurLine, 'TEC_RRes', InputFileData%TEC_RRes, ErrStat2, ErrMsg2, UnEcho )
      if (Failed())  return;
      !  TEC_VLL        - Line-to-line RMS voltage (volts) [used only when VSContrl=0 and GenModel=2]
   call ParseVar( FileInfo_In, CurLine, 'TEC_VLL', InputFileData%TEC_VLL, ErrStat2, ErrMsg2, UnEcho )
      if (Failed())  return;
      !  TEC_SLR        - Stator leakage reactance (ohms) [used only when VSContrl=0 and GenModel=2]
   call ParseVar( FileInfo_In, CurLine, 'TEC_SLR', InputFileData%TEC_SLR, ErrStat2, ErrMsg2, UnEcho )
      if (Failed())  return;
      !  TEC_RLR        - Rotor leakage reactance (ohms) [used only when VSContrl=0 and GenModel=2]
   call ParseVar( FileInfo_In, CurLine, 'TEC_RLR', InputFileData%TEC_RLR, ErrStat2, ErrMsg2, UnEcho )
      if (Failed())  return;
      !  TEC_MR         - Magnetizing reactance (ohms) [used only when VSContrl=0 and GenModel=2]
   call ParseVar( FileInfo_In, CurLine, 'TEC_MR', InputFileData%TEC_MR, ErrStat2, ErrMsg2, UnEcho )
      if (Failed())  return;


   !---------------------- HIGH-SPEED SHAFT BRAKE ----------------------------------
   if ( InputFileData%Echo )   WRITE(UnEcho, '(A)') FileInfo_In%Lines(CurLine)    ! Write section break to echo
   CurLine = CurLine + 1
      !  HSSBrMode (switch)   - HSS brake model {
      !                             0: none,
      !                             1: simple,
      !                             3: user-defined from routine UserHSSBr,
      !                             4: user-defined from Simulink/Labview,
      !                             5: user-defined from Bladed-style DLL}
   call ParseVar( FileInfo_In, CurLine, 'HSSBrMode', InputFileData%HSSBrMode, ErrStat2, ErrMsg2, UnEcho )
      if (Failed())  return;
      !  THSSBrDp   - Time to initiate deployment of the HSS brake (s)
   call ParseVar( FileInfo_In, CurLine, 'THSSBrDp', InputFileData%THSSBrDp, ErrStat2, ErrMsg2, UnEcho )
      if (Failed())  return;
      !  HSSBrDT   - Time for HSS-brake to reach full deployment once initiated (sec) [used only when HSSBrMode=1]
   call ParseVar( FileInfo_In, CurLine, 'HSSBrDT', InputFileData%HSSBrDT, ErrStat2, ErrMsg2, UnEcho )
      if (Failed())  return;
      !  HSSBrTqF   - Fully deployed HSS-brake torque (N-m)
   call ParseVar( FileInfo_In, CurLine, 'HSSBrTqF', InputFileData%HSSBrTqF, ErrStat2, ErrMsg2, UnEcho )
      if (Failed())  return;


   !---------------------- YAW CONTROL ---------------------------------------------
   if ( InputFileData%Echo )   WRITE(UnEcho, '(A)') FileInfo_In%Lines(CurLine)    ! Write section break to echo
   CurLine = CurLine + 1
      !  YCMode (switch)   - Yaw control mode {
      !                             0: none,
      !                             3: user-defined from routine UserYawCont,
      !                             4: user-defined from Simulink/Labview,
      !                             5: user-defined from Bladed-style DLL}
   call ParseVar( FileInfo_In, CurLine, 'YCMode', InputFileData%YCMode, ErrStat2, ErrMsg2, UnEcho )
      if (Failed())  return;
      !  TYCOn  - Time to enable active yaw control (s) [unused when YCMode=0]
   call ParseVar( FileInfo_In, CurLine, 'TYCOn', InputFileData%TYCOn, ErrStat2, ErrMsg2, UnEcho )
      if (Failed())  return;
      !  YawNeut  - Neutral yaw position--yaw spring force is zero at this yaw (degrees)
   call ParseVar( FileInfo_In, CurLine, 'YawNeut', InputFileData%YawNeut, ErrStat2, ErrMsg2, UnEcho )
      if (Failed())  return;
   InputFileData%YawNeut = InputFileData%YawNeut*D2R
      !  YawSpr  - Nacelle-yaw spring constant (N-m/rad)
   call ParseVar( FileInfo_In, CurLine, 'YawSpr', InputFileData%YawSpr, ErrStat2, ErrMsg2, UnEcho )
      if (Failed())  return;
      !  YawDamp  - Nacelle-yaw damping constant (N-m/(rad/s))
   call ParseVar( FileInfo_In, CurLine, 'YawDamp', InputFileData%YawDamp, ErrStat2, ErrMsg2, UnEcho )
      if (Failed())  return;
      !  TYawManS  - Time to start override yaw maneuver and end standard yaw control (s)
   call ParseVar( FileInfo_In, CurLine, 'TYawManS', InputFileData%TYawManS, ErrStat2, ErrMsg2, UnEcho )
      if (Failed())  return;
      !  YawManRat  - Yaw maneuver rate (in absolute value) (deg/s)
   call ParseVar( FileInfo_In, CurLine, 'YawManRat', InputFileData%YawManRat, ErrStat2, ErrMsg2, UnEcho )
      if (Failed())  return;
   InputFileData%YawManRat = InputFileData%YawManRat*D2R
      !  NacYawF  - Final yaw angle for override yaw maneuvers (degrees)
   call ParseVar( FileInfo_In, CurLine, 'NacYawF', InputFileData%NacYawF, ErrStat2, ErrMsg2, UnEcho )
      if (Failed())  return;
   InputFileData%NacYawF = InputFileData%NacYawF*D2R


   !---------------------- TUNED MASS DAMPER ----------------------------------------         
   if ( InputFileData%Echo )   WRITE(UnEcho, '(A)') FileInfo_In%Lines(CurLine)    ! Write section break to echo
   CurLine = CurLine + 1
      !  CompNStC  - Compute nacelle structural control damping {number of nacelle TMDs} (integer)
   call ParseVar( FileInfo_In, CurLine, 'CompNStC', InputFileData%CompNStC, ErrStat2, ErrMsg2, UnEcho )
      if (Failed())  return;
      !  NStCfile  - Name of the file for nacelle structural control damping (quoted strings) [unused when CompNStC==0]
   call AllocAry( InputFileData%NStCfile, InputFileData%CompNStC, 'NStCfile', ErrStat2, ErrMsg2 )
      if (Failed())  return;
   call ParseAry( FileInfo_In, CurLine, 'NStCfile', InputFileData%NStCfile, InputFileData%CompNStC, ErrStat2, ErrMsg2, UnEcho )
      if (Failed())  return;

      !  CompTStC  - Compute tower structural control damping {number of nacelle TMDs} (integer)
   call ParseVar( FileInfo_In, CurLine, 'CompTStC', InputFileData%CompTStC, ErrStat2, ErrMsg2, UnEcho )
      if (Failed())  return;
      !  TStCfile  - Name of the file for tower structural control damping (quoted strings) [unused when CompTStC==0]
   call AllocAry( InputFileData%TStCfile, InputFileData%CompTStC, 'TStCfile', ErrStat2, ErrMsg2 )
      if (Failed())  return;
   call ParseAry( FileInfo_In, CurLine, 'TStCfile', InputFileData%TStCfile, InputFileData%CompTStC, ErrStat2, ErrMsg2, UnEcho )
      if (Failed())  return;

      !  CompBStC  - Compute  blade structural control damping {number of nacelle tmds} (integer)
   call ParseVar( FileInfo_In, CurLine, 'CompBStC', InputFileData%CompBStC, ErrStat2, ErrMsg2, UnEcho )
      if (Failed())  return;
      !  BStCfile  - Name of the file for blade structural control damping (quoted strings) [unused when CompBStC==0]
   call AllocAry( InputFileData%BStCfile, InputFileData%CompBStC, 'BStCfile', ErrStat2, ErrMsg2 )
      if (Failed())  return;
   call ParseAry( FileInfo_In, CurLine, 'BStCfile', InputFileData%BStCfile, InputFileData%CompBStC, ErrStat2, ErrMsg2, UnEcho )
      if (Failed())  return;

      !  CompPtfmStC  - Compute platform structural control damping {number of nacelle TMDs} (integer)
   call ParseVar( FileInfo_In, CurLine, 'CompPtfmStC', InputFileData%CompPtfmStC, ErrStat2, ErrMsg2, UnEcho )
      if (Failed())  return;
      !  PtfmStCfile  - Name of the file for blade structural control damping (quoted strings) [unused when CompPtfmStC==0]
   call AllocAry( InputFileData%PtfmStCfile, InputFileData%CompPtfmStC, 'PtfmStCfile', ErrStat2, ErrMsg2 )
      if (Failed())  return;
   call ParseAry( FileInfo_In, CurLine, 'PtfmStCfile', InputFileData%PtfmStCfile, InputFileData%CompPtfmStC, ErrStat2, ErrMsg2, UnEcho )
      if (Failed())  return;


   !---------------------- BLADED INTERFACE ----------------------------------------         
   if ( InputFileData%Echo )   WRITE(UnEcho, '(A)') FileInfo_In%Lines(CurLine)    ! Write section break to echo
   CurLine = CurLine + 1
      !  DLL_FileName  - Name/location of the dynamic library {.dll [Windows] or .so [Linux]} in the Bladed-DLL format (-) [used only with Bladed Interface]
   call ParseVar( FileInfo_In, CurLine, 'DLL_FileName', InputFileData%DLL_FileName, ErrStat2, ErrMsg2, UnEcho )
      if (Failed())  return;
   IF ( PathIsRelative( InputFileData%DLL_FileName ) ) InputFileData%DLL_FileName = TRIM(PriPath)//TRIM(InputFileData%DLL_FileName)
      !  DLL_InFile  - Name of input file sent to the DLL (-) [used only with Bladed Interface]
   call ParseVar( FileInfo_In, CurLine, 'DLL_InFile', InputFileData%DLL_InFile, ErrStat2, ErrMsg2, UnEcho )
      if (Failed())  return;
   IF ( PathIsRelative( InputFileData%DLL_InFile ) ) InputFileData%DLL_InFile = TRIM(PriPath)//TRIM(InputFileData%DLL_InFile)   
      !  DLL_ProcName  - Name of procedure in DLL to be called (-) [case sensitive; used only with DLL Interface]
   call ParseVar( FileInfo_In, CurLine, 'DLL_ProcName', InputFileData%DLL_ProcName, ErrStat2, ErrMsg2, UnEcho )
      if (Failed())  return;
      !  DLL_DT  - Communication interval for dynamic library (s) (or "default") [used only with Bladed Interface]
   call ParseVarWDefault( FileInfo_In, CurLine, 'DLL_DT', InputFileData%DLL_DT, InputFileData%DT, ErrStat2, ErrMsg2, UnEcho )
      if (Failed())  return;
      !  DLL_Ramp  - Whether a linear ramp should be used between DLL_DT time steps [introduces time shift when true] (flag) [used only with Bladed Interface]
   call ParseVar( FileInfo_In, CurLine, 'DLL_Ramp', InputFileData%DLL_Ramp, ErrStat2, ErrMsg2, UnEcho )
      if (Failed())  return;
      !  BPCutoff  - Cuttoff frequency for low-pass filter on blade pitch from DLL (Hz) [used only with Bladed Interface]
   call ParseVar( FileInfo_In, CurLine, 'BPCutoff', InputFileData%BPCutoff, ErrStat2, ErrMsg2, UnEcho )
      if (Failed())  return;
      !  NacYaw_North  - Reference yaw angle of the nacelle when the upwind end points due North (deg) [used only with Bladed Interface]
   call ParseVar( FileInfo_In, CurLine, 'NacYaw_North', InputFileData%NacYaw_North, ErrStat2, ErrMsg2, UnEcho )
      if (Failed())  return;
   InputFileData%NacYaw_North = InputFileData%NacYaw_North*D2R
      !  Ptch_Cntrl  - Record 28: Use individual pitch control {0: collective pitch; 1: individual pitch control} (switch) [used only with Bladed Interface]
   call ParseVar( FileInfo_In, CurLine, 'Ptch_Cntrl', InputFileData%Ptch_Cntrl, ErrStat2, ErrMsg2, UnEcho )
      if (Failed())  return;
      !  Ptch_SetPnt  - Record  5: Below-rated pitch angle set-point (deg) [used only with Bladed Interface]
   call ParseVar( FileInfo_In, CurLine, 'Ptch_SetPnt', InputFileData%Ptch_SetPnt, ErrStat2, ErrMsg2, UnEcho )
      if (Failed())  return;
   InputFileData%Ptch_SetPnt = InputFileData%Ptch_SetPnt*D2R
      !  Ptch_Min  - Record  6: Minimum pitch angle (deg) [used only with Bladed Interface]
   call ParseVar( FileInfo_In, CurLine, 'Ptch_Min', InputFileData%Ptch_Min, ErrStat2, ErrMsg2, UnEcho )
      if (Failed())  return;
   InputFileData%Ptch_Min = InputFileData%Ptch_Min*D2R
      !  Ptch_Max  - Record  7: Maximum pitch angle (deg) [used only with Bladed Interface]
   call ParseVar( FileInfo_In, CurLine, 'Ptch_Max', InputFileData%Ptch_Max, ErrStat2, ErrMsg2, UnEcho )
      if (Failed())  return;
   InputFileData%Ptch_Max = InputFileData%Ptch_Max*D2R
      !  PtchRate_Min  - Record  8: Minimum pitch rate (most negative value allowed) (deg/s) [used only with Bladed Interface]
   call ParseVar( FileInfo_In, CurLine, 'PtchRate_Min', InputFileData%PtchRate_Min, ErrStat2, ErrMsg2, UnEcho )
      if (Failed())  return;
   InputFileData%PtchRate_Min = InputFileData%PtchRate_Min*D2R
      !  PtchRate_Max  - Record  9: Maximum pitch rate  (deg/s) [used only with Bladed Interface]
   call ParseVar( FileInfo_In, CurLine, 'PtchRate_Max', InputFileData%PtchRate_Max, ErrStat2, ErrMsg2, UnEcho )
      if (Failed())  return;
   InputFileData%PtchRate_Max = InputFileData%PtchRate_Max*D2R
      !  Gain_OM  - Record 16: Optimal mode gain (Nm/(rad/s)^2) [used only with Bladed Interface]
   call ParseVar( FileInfo_In, CurLine, 'Gain_OM', InputFileData%Gain_OM, ErrStat2, ErrMsg2, UnEcho )
      if (Failed())  return;
      !  GenSpd_MinOM  - Record 17: Minimum generator speed (rpm) [used only with Bladed Interface]
   call ParseVar( FileInfo_In, CurLine, 'GenSpd_MinOM', InputFileData%GenSpd_MinOM, ErrStat2, ErrMsg2, UnEcho )
      if (Failed())  return;
   InputFileData%GenSpd_MinOM = InputFileData%GenSpd_MinOM*RPM2RPS
      !  GenSpd_MaxOM  - Record 18: Optimal mode maximum speed (rpm) [used only with Bladed Interface]
   call ParseVar( FileInfo_In, CurLine, 'GenSpd_MaxOM', InputFileData%GenSpd_MaxOM, ErrStat2, ErrMsg2, UnEcho )
      if (Failed())  return;
   InputFileData%GenSpd_MaxOM = InputFileData%GenSpd_MaxOM*RPM2RPS
      !  GenSpd_Dem  - Record 19: Demanded generator speed above rated (rpm) [used only with Bladed Interface]
   call ParseVar( FileInfo_In, CurLine, 'GenSpd_Dem', InputFileData%GenSpd_Dem, ErrStat2, ErrMsg2, UnEcho )
      if (Failed())  return;
   InputFileData%GenSpd_Dem = InputFileData%GenSpd_Dem*RPM2RPS
      !  GenTrq_Dem  - Record 22: Demanded generator torque above rated (Nm) [used only with Bladed Interface]
   call ParseVar( FileInfo_In, CurLine, 'GenTrq_Dem', InputFileData%GenTrq_Dem, ErrStat2, ErrMsg2, UnEcho )
      if (Failed())  return;
      !  GenPwr_Dem  - Record 13: Demanded power (W) [used only with Bladed Interface]
   call ParseVar( FileInfo_In, CurLine, 'GenPwr_Dem', InputFileData%GenPwr_Dem, ErrStat2, ErrMsg2, UnEcho )
      if (Failed())  return;


   !---------------------- BLADED INTERFACE TORQUE-SPEED LOOK-UP TABLE -------------         
   if ( InputFileData%Echo )   WRITE(UnEcho, '(A)') FileInfo_In%Lines(CurLine)    ! Write section break to echo
   CurLine = CurLine + 1
      ! NKInpSt      - Number of spring force input stations
   call ParseVar( FileInfo_In, CurLine, 'DLL_NumTrq', InputFileData%DLL_NumTrq, ErrStat2, ErrMsg2, UnEcho)
         if (Failed()) return
   ! Section break --  GenSpd_TLU   GenTrq_TLU
   if ( InputFileData%Echo )   WRITE(UnEcho, '(A)') ' Table Header: '//FileInfo_In%Lines(CurLine)    ! Write section break to echo
   CurLine = CurLine + 1
   if ( InputFileData%Echo )   WRITE(UnEcho, '(A)') ' Table Units: '//FileInfo_In%Lines(CurLine)    ! Write section break to echo
   CurLine = CurLine + 1

   if (InputFileData%DLL_NumTrq > 0) then
      CALL AllocAry( InputFileData%GenSpd_TLU,   InputFileData%DLL_NumTrq, 'GenSpd_TLU', ErrStat2, ErrMsg2 )
            if (Failed()) return;
      CALL AllocAry( InputFileData%GenTrq_TLU,   InputFileData%DLL_NumTrq, 'GenTrq_TLU',ErrStat2, ErrMsg2 )
            if (Failed()) return;
         ! TABLE read
      do i=1,InputFileData%DLL_NumTrq
         call ParseAry ( FileInfo_In, CurLine, 'Coordinates', TmpRe2, 2, ErrStat2, ErrMsg2, UnEcho )
               if (Failed()) return;
         InputFileData%GenSpd_TLU(i) = TmpRe2(1)*RPM2RPS  ! GenSpd_TLU - Records R:2:R+2*DLL_NumTrq-2: Generator speed values in look-up table (rpm) (read from file in rpm and converted to rad/s here)
         InputFileData%GenTrq_TLU(i) = TmpRe2(2)          ! GenTrq_TLU - Records R+1:2:R+2*DLL_NumTrq-1: Generator torque values in look-up table (Nm)
      enddo
   endif



   !---------------------- OUTPUT --------------------------------------------------         
   if ( InputFileData%Echo )   WRITE(UnEcho, '(A)') FileInfo_In%Lines(CurLine)    ! Write section break to echo
   CurLine = CurLine + 1
      !  SumPrint  - Print summary data to <RootName>.sum (flag) (currently unused)
   call ParseVar( FileInfo_In, CurLine, 'SumPrint', InputFileData%SumPrint, ErrStat2, ErrMsg2, UnEcho )
      if (Failed())  return;
      !  OutFile  - Switch to determine where output will be placed: {1: in module output file only; 2: in glue code output file only; 3: both} (currently unused)
   call ParseVar( FileInfo_In, CurLine, 'OutFile', InputFileData%OutFile, ErrStat2, ErrMsg2, UnEcho )
      if (Failed())  return;
   !PLACEHOLDER: OutFileFmt - Format for module tabular (time-marching) output: (1: text file [<RootName>.out], 2: binary file [<RootName>.outb], 3: both):
      !  TabDelim  - Use tab delimiters in text tabular output file? (flag) (currently unused)
   call ParseVar( FileInfo_In, CurLine, 'TabDelim', InputFileData%TabDelim, ErrStat2, ErrMsg2, UnEcho )
      if (Failed())  return;
      !  OutFmt  - Format used for text tabular output (except time).  Resulting field should be 10 characters. (quoted string) (currently unused)
   call ParseVar( FileInfo_In, CurLine, 'OutFmt', InputFileData%OutFmt, ErrStat2, ErrMsg2, UnEcho )
      if (Failed())  return;
      !  TStart  - Time to begin tabular output (s) (currently unused)
   call ParseVar( FileInfo_In, CurLine, 'TStart', InputFileData%TStart, ErrStat2, ErrMsg2, UnEcho )
      if (Failed())  return;
   !PLACEHOLDER: DecFact - Decimation factor for module's tabular output (1=output every step) (-):

   !---------------------- OUTLIST  --------------------------------------------
   if ( InputFileData%Echo )   WRITE(UnEcho, '(A)') FileInfo_In%Lines(CurLine)    ! Write section break to echo
   CurLine = CurLine + 1
   call ReadOutputListFromFileInfo( FileInfo_In, CurLine, InputFileData%OutList, &
            InputFileData%NumOuts, 'OutList', "List of user-requested output channels", ErrStat2, ErrMsg2, UnEcho )
         if (Failed()) return;


   call Cleanup()
   return

contains
   !-------------------------------------------------------------------------------------------------
   logical function Failed()
      CALL SetErrStat( ErrStat2, ErrMsg2, ErrStat, ErrMsg, RoutineName )
      Failed = ErrStat >= AbortErrLev
      ! This fixes a strange compile issue with gfortran 9.1.0 on Mac where the CurLine and ErrStat end up sharing stack
      ! space due to the -fstack_reuse="all" is set for any optimization.  Can workaround with -fstack_reuse="none", but
      ! have not found any other viable workaround other than using CurLine here in the Failed function
      CurLine = CurLine
      if (Failed) call Cleanup()
   end function Failed
   !-------------------------------------------------------------------------------------------------
   subroutine Cleanup()
      if (UnEcho  > -1_IntKi)     CLOSE( UnEcho  )
   end subroutine Cleanup
end subroutine ParseInputFileInfo
!----------------------------------------------------------------------------------------------------------------------------------



!**********************************************************************************************************************************
! NOTE: The following lines of code were generated by a Matlab script called "Write_ChckOutLst.m"
!      using the parameters listed in the "OutListParameters.xlsx" Excel file. Any changes to these 
!      lines should be modified in the Matlab script and/or Excel worksheet as necessary. 
!----------------------------------------------------------------------------------------------------------------------------------
!> This routine checks to see if any requested output channel names (stored in the OutList(:)) are invalid. It returns a 
!! warning if any of the channels are not available outputs from the module.
!!  It assigns the settings for OutParam(:) (i.e, the index, name, and units of the output channels, WriteOutput(:)).
!!  the sign is set to 0 if the channel is invalid.
!! It sets assumes the value p%NumOuts has been set before this routine has been called, and it sets the values of p%OutParam here.
!! 
!! This routine was generated by Write_ChckOutLst.m using the parameters listed in OutListParameters.xlsx at 05-Dec-2020 09:46:04.
SUBROUTINE SetOutParam(OutList, p, ErrStat, ErrMsg )
!..................................................................................................................................

   IMPLICIT                        NONE

      ! Passed variables

   CHARACTER(ChanLen),        INTENT(IN)     :: OutList(:)                        !< The list out user-requested outputs
   TYPE(SrvD_ParameterType),    INTENT(INOUT)  :: p                                 !< The module parameters
   INTEGER(IntKi),            INTENT(OUT)    :: ErrStat                           !< The error status code
   CHARACTER(*),              INTENT(OUT)    :: ErrMsg                            !< The error message, if an error occurred

      ! Local variables

   INTEGER                      :: ErrStat2                                        ! temporary (local) error status
   INTEGER                      :: I                                               ! Generic loop-counting index
   INTEGER                      :: J                                               ! Generic loop-counting index
   INTEGER                      :: INDX                                            ! Index for valid arrays

   LOGICAL                      :: CheckOutListAgain                               ! Flag used to determine if output parameter starting with "M" is valid (or the negative of another parameter)
   LOGICAL                      :: InvalidOutput(0:MaxOutPts)                      ! This array determines if the output channel is valid for this configuration
   CHARACTER(ChanLen)           :: OutListTmp                                      ! A string to temporarily hold OutList(I)
   CHARACTER(*), PARAMETER      :: RoutineName = "SetOutParam"

   CHARACTER(OutStrLenM1), PARAMETER  :: ValidParamAry(518) =  (/  &   ! This lists the names of the allowed parameters, which must be sorted alphabetically
                               "BLAIRFLC1   ","BLAIRFLC2   ","BLAIRFLC3   ","BLFLAP1     ","BLFLAP2     ","BLFLAP3     ", &
                               "BLPITCHC1   ","BLPITCHC2   ","BLPITCHC3   ","BSTC1_B1_FXI","BSTC1_B1_FXN","BSTC1_B1_FYI", &
                               "BSTC1_B1_FYN","BSTC1_B1_FZI","BSTC1_B1_FZN","BSTC1_B1_MXI","BSTC1_B1_MXN","BSTC1_B1_MYI", &
                               "BSTC1_B1_MYN","BSTC1_B1_MZI","BSTC1_B1_MZN","BSTC1_B1_XQ ","BSTC1_B1_XQD","BSTC1_B1_YQ ", &
                               "BSTC1_B1_YQD","BSTC1_B1_ZQ ","BSTC1_B1_ZQD","BSTC1_B2_FXI","BSTC1_B2_FXN","BSTC1_B2_FYI", &
                               "BSTC1_B2_FYN","BSTC1_B2_FZI","BSTC1_B2_FZN","BSTC1_B2_MXI","BSTC1_B2_MXN","BSTC1_B2_MYI", &
                               "BSTC1_B2_MYN","BSTC1_B2_MZI","BSTC1_B2_MZN","BSTC1_B2_XQ ","BSTC1_B2_XQD","BSTC1_B2_YQ ", &
                               "BSTC1_B2_YQD","BSTC1_B2_ZQ ","BSTC1_B2_ZQD","BSTC1_B3_FXI","BSTC1_B3_FXN","BSTC1_B3_FYI", &
                               "BSTC1_B3_FYN","BSTC1_B3_FZI","BSTC1_B3_FZN","BSTC1_B3_MXI","BSTC1_B3_MXN","BSTC1_B3_MYI", &
                               "BSTC1_B3_MYN","BSTC1_B3_MZI","BSTC1_B3_MZN","BSTC1_B3_XQ ","BSTC1_B3_XQD","BSTC1_B3_YQ ", &
                               "BSTC1_B3_YQD","BSTC1_B3_ZQ ","BSTC1_B3_ZQD","BSTC1_B4_FXI","BSTC1_B4_FXN","BSTC1_B4_FYI", &
                               "BSTC1_B4_FYN","BSTC1_B4_FZI","BSTC1_B4_FZN","BSTC1_B4_MXI","BSTC1_B4_MXN","BSTC1_B4_MYI", &
                               "BSTC1_B4_MYN","BSTC1_B4_MZI","BSTC1_B4_MZN","BSTC1_B4_XQ ","BSTC1_B4_XQD","BSTC1_B4_YQ ", &
                               "BSTC1_B4_YQD","BSTC1_B4_ZQ ","BSTC1_B4_ZQD","BSTC2_B1_FXI","BSTC2_B1_FXN","BSTC2_B1_FYI", &
                               "BSTC2_B1_FYN","BSTC2_B1_FZI","BSTC2_B1_FZN","BSTC2_B1_MXI","BSTC2_B1_MXN","BSTC2_B1_MYI", &
                               "BSTC2_B1_MYN","BSTC2_B1_MZI","BSTC2_B1_MZN","BSTC2_B1_XQ ","BSTC2_B1_XQD","BSTC2_B1_YQ ", &
                               "BSTC2_B1_YQD","BSTC2_B1_ZQ ","BSTC2_B1_ZQD","BSTC2_B2_FXI","BSTC2_B2_FXN","BSTC2_B2_FYI", &
                               "BSTC2_B2_FYN","BSTC2_B2_FZI","BSTC2_B2_FZN","BSTC2_B2_MXI","BSTC2_B2_MXN","BSTC2_B2_MYI", &
                               "BSTC2_B2_MYN","BSTC2_B2_MZI","BSTC2_B2_MZN","BSTC2_B2_XQ ","BSTC2_B2_XQD","BSTC2_B2_YQ ", &
                               "BSTC2_B2_YQD","BSTC2_B2_ZQ ","BSTC2_B2_ZQD","BSTC2_B3_FXI","BSTC2_B3_FXN","BSTC2_B3_FYI", &
                               "BSTC2_B3_FYN","BSTC2_B3_FZI","BSTC2_B3_FZN","BSTC2_B3_MXI","BSTC2_B3_MXN","BSTC2_B3_MYI", &
                               "BSTC2_B3_MYN","BSTC2_B3_MZI","BSTC2_B3_MZN","BSTC2_B3_XQ ","BSTC2_B3_XQD","BSTC2_B3_YQ ", &
                               "BSTC2_B3_YQD","BSTC2_B3_ZQ ","BSTC2_B3_ZQD","BSTC2_B4_FXI","BSTC2_B4_FXN","BSTC2_B4_FYI", &
                               "BSTC2_B4_FYN","BSTC2_B4_FZI","BSTC2_B4_FZN","BSTC2_B4_MXI","BSTC2_B4_MXN","BSTC2_B4_MYI", &
                               "BSTC2_B4_MYN","BSTC2_B4_MZI","BSTC2_B4_MZN","BSTC2_B4_XQ ","BSTC2_B4_XQD","BSTC2_B4_YQ ", &
                               "BSTC2_B4_YQD","BSTC2_B4_ZQ ","BSTC2_B4_ZQD","BSTC3_B1_FXI","BSTC3_B1_FXN","BSTC3_B1_FYI", &
                               "BSTC3_B1_FYN","BSTC3_B1_FZI","BSTC3_B1_FZN","BSTC3_B1_MXI","BSTC3_B1_MXN","BSTC3_B1_MYI", &
                               "BSTC3_B1_MYN","BSTC3_B1_MZI","BSTC3_B1_MZN","BSTC3_B1_XQ ","BSTC3_B1_XQD","BSTC3_B1_YQ ", &
                               "BSTC3_B1_YQD","BSTC3_B1_ZQ ","BSTC3_B1_ZQD","BSTC3_B2_FXI","BSTC3_B2_FXN","BSTC3_B2_FYI", &
                               "BSTC3_B2_FYN","BSTC3_B2_FZI","BSTC3_B2_FZN","BSTC3_B2_MXI","BSTC3_B2_MXN","BSTC3_B2_MYI", &
                               "BSTC3_B2_MYN","BSTC3_B2_MZI","BSTC3_B2_MZN","BSTC3_B2_XQ ","BSTC3_B2_XQD","BSTC3_B2_YQ ", &
                               "BSTC3_B2_YQD","BSTC3_B2_ZQ ","BSTC3_B2_ZQD","BSTC3_B3_FXI","BSTC3_B3_FXN","BSTC3_B3_FYI", &
                               "BSTC3_B3_FYN","BSTC3_B3_FZI","BSTC3_B3_FZN","BSTC3_B3_MXI","BSTC3_B3_MXN","BSTC3_B3_MYI", &
                               "BSTC3_B3_MYN","BSTC3_B3_MZI","BSTC3_B3_MZN","BSTC3_B3_XQ ","BSTC3_B3_XQD","BSTC3_B3_YQ ", &
                               "BSTC3_B3_YQD","BSTC3_B3_ZQ ","BSTC3_B3_ZQD","BSTC3_B4_FXI","BSTC3_B4_FXN","BSTC3_B4_FYI", &
                               "BSTC3_B4_FYN","BSTC3_B4_FZI","BSTC3_B4_FZN","BSTC3_B4_MXI","BSTC3_B4_MXN","BSTC3_B4_MYI", &
                               "BSTC3_B4_MYN","BSTC3_B4_MZI","BSTC3_B4_MZN","BSTC3_B4_XQ ","BSTC3_B4_XQD","BSTC3_B4_YQ ", &
                               "BSTC3_B4_YQD","BSTC3_B4_ZQ ","BSTC3_B4_ZQD","BSTC4_B1_FXI","BSTC4_B1_FXN","BSTC4_B1_FYI", &
                               "BSTC4_B1_FYN","BSTC4_B1_FZI","BSTC4_B1_FZN","BSTC4_B1_MXI","BSTC4_B1_MXN","BSTC4_B1_MYI", &
                               "BSTC4_B1_MYN","BSTC4_B1_MZI","BSTC4_B1_MZN","BSTC4_B1_XQ ","BSTC4_B1_XQD","BSTC4_B1_YQ ", &
                               "BSTC4_B1_YQD","BSTC4_B1_ZQ ","BSTC4_B1_ZQD","BSTC4_B2_FXI","BSTC4_B2_FXN","BSTC4_B2_FYI", &
                               "BSTC4_B2_FYN","BSTC4_B2_FZI","BSTC4_B2_FZN","BSTC4_B2_MXI","BSTC4_B2_MXN","BSTC4_B2_MYI", &
                               "BSTC4_B2_MYN","BSTC4_B2_MZI","BSTC4_B2_MZN","BSTC4_B2_XQ ","BSTC4_B2_XQD","BSTC4_B2_YQ ", &
                               "BSTC4_B2_YQD","BSTC4_B2_ZQ ","BSTC4_B2_ZQD","BSTC4_B3_FXI","BSTC4_B3_FXN","BSTC4_B3_FYI", &
                               "BSTC4_B3_FYN","BSTC4_B3_FZI","BSTC4_B3_FZN","BSTC4_B3_MXI","BSTC4_B3_MXN","BSTC4_B3_MYI", &
                               "BSTC4_B3_MYN","BSTC4_B3_MZI","BSTC4_B3_MZN","BSTC4_B3_XQ ","BSTC4_B3_XQD","BSTC4_B3_YQ ", &
                               "BSTC4_B3_YQD","BSTC4_B3_ZQ ","BSTC4_B3_ZQD","BSTC4_B4_FXI","BSTC4_B4_FXN","BSTC4_B4_FYI", &
                               "BSTC4_B4_FYN","BSTC4_B4_FZI","BSTC4_B4_FZN","BSTC4_B4_MXI","BSTC4_B4_MXN","BSTC4_B4_MYI", &
                               "BSTC4_B4_MYN","BSTC4_B4_MZI","BSTC4_B4_MZN","BSTC4_B4_XQ ","BSTC4_B4_XQD","BSTC4_B4_YQ ", &
                               "BSTC4_B4_YQD","BSTC4_B4_ZQ ","BSTC4_B4_ZQD","GENPWR      ","GENTQ       ","HSSBRTQC    ", &
                               "NSTC1_FXI   ","NSTC1_FXN   ","NSTC1_FYI   ","NSTC1_FYN   ","NSTC1_FZI   ","NSTC1_FZN   ", &
                               "NSTC1_MXI   ","NSTC1_MXN   ","NSTC1_MYI   ","NSTC1_MYN   ","NSTC1_MZI   ","NSTC1_MZN   ", &
                               "NSTC1_XQ    ","NSTC1_XQD   ","NSTC1_YQ    ","NSTC1_YQD   ","NSTC1_ZQ    ","NSTC1_ZQD   ", &
                               "NSTC2_FXI   ","NSTC2_FXN   ","NSTC2_FYI   ","NSTC2_FYN   ","NSTC2_FZI   ","NSTC2_FZN   ", &
                               "NSTC2_MXI   ","NSTC2_MXN   ","NSTC2_MYI   ","NSTC2_MYN   ","NSTC2_MZI   ","NSTC2_MZN   ", &
                               "NSTC2_XQ    ","NSTC2_XQD   ","NSTC2_YQ    ","NSTC2_YQD   ","NSTC2_ZQ    ","NSTC2_ZQD   ", &
                               "NSTC3_FXI   ","NSTC3_FXN   ","NSTC3_FYI   ","NSTC3_FYN   ","NSTC3_FZI   ","NSTC3_FZN   ", &
                               "NSTC3_MXI   ","NSTC3_MXN   ","NSTC3_MYI   ","NSTC3_MYN   ","NSTC3_MZI   ","NSTC3_MZN   ", &
                               "NSTC3_XQ    ","NSTC3_XQD   ","NSTC3_YQ    ","NSTC3_YQD   ","NSTC3_ZQ    ","NSTC3_ZQD   ", &
                               "NSTC4_FXI   ","NSTC4_FXN   ","NSTC4_FYI   ","NSTC4_FYN   ","NSTC4_FZI   ","NSTC4_FZN   ", &
                               "NSTC4_MXI   ","NSTC4_MXN   ","NSTC4_MYI   ","NSTC4_MYN   ","NSTC4_MZI   ","NSTC4_MZN   ", &
                               "NSTC4_XQ    ","NSTC4_XQD   ","NSTC4_YQ    ","NSTC4_YQD   ","NSTC4_ZQ    ","NSTC4_ZQD   ", &
                               "PTFMSTC1_FXI","PTFMSTC1_FXN","PTFMSTC1_FYI","PTFMSTC1_FYN","PTFMSTC1_FZI","PTFMSTC1_FZN", &
                               "PTFMSTC1_MXI","PTFMSTC1_MXN","PTFMSTC1_MYI","PTFMSTC1_MYN","PTFMSTC1_MZI","PTFMSTC1_MZN", &
                               "PTFMSTC1_XQ ","PTFMSTC1_XQD","PTFMSTC1_YQ ","PTFMSTC1_YQD","PTFMSTC1_ZQ ","PTFMSTC1_ZQD", &
                               "PTFMSTC2_FXI","PTFMSTC2_FXN","PTFMSTC2_FYI","PTFMSTC2_FYN","PTFMSTC2_FZI","PTFMSTC2_FZN", &
                               "PTFMSTC2_MXI","PTFMSTC2_MXN","PTFMSTC2_MYI","PTFMSTC2_MYN","PTFMSTC2_MZI","PTFMSTC2_MZN", &
                               "PTFMSTC2_XQ ","PTFMSTC2_XQD","PTFMSTC2_YQ ","PTFMSTC2_YQD","PTFMSTC2_ZQ ","PTFMSTC2_ZQD", &
                               "PTFMSTC3_FXI","PTFMSTC3_FXN","PTFMSTC3_FYI","PTFMSTC3_FYN","PTFMSTC3_FZI","PTFMSTC3_FZN", &
                               "PTFMSTC3_MXI","PTFMSTC3_MXN","PTFMSTC3_MYI","PTFMSTC3_MYN","PTFMSTC3_MZI","PTFMSTC3_MZN", &
                               "PTFMSTC3_XQ ","PTFMSTC3_XQD","PTFMSTC3_YQ ","PTFMSTC3_YQD","PTFMSTC3_ZQ ","PTFMSTC3_ZQD", &
                               "PTFMSTC4_FXI","PTFMSTC4_FXN","PTFMSTC4_FYI","PTFMSTC4_FYN","PTFMSTC4_FZI","PTFMSTC4_FZN", &
                               "PTFMSTC4_MXI","PTFMSTC4_MXN","PTFMSTC4_MYI","PTFMSTC4_MYN","PTFMSTC4_MZI","PTFMSTC4_MZN", &
                               "PTFMSTC4_XQ ","PTFMSTC4_XQD","PTFMSTC4_YQ ","PTFMSTC4_YQD","PTFMSTC4_ZQ ","PTFMSTC4_ZQD", &
                               "TSTC1_FXI   ","TSTC1_FXN   ","TSTC1_FYI   ","TSTC1_FYN   ","TSTC1_FZI   ","TSTC1_FZN   ", &
                               "TSTC1_MXI   ","TSTC1_MXN   ","TSTC1_MYI   ","TSTC1_MYN   ","TSTC1_MZI   ","TSTC1_MZN   ", &
                               "TSTC1_XQ    ","TSTC1_XQD   ","TSTC1_YQ    ","TSTC1_YQD   ","TSTC1_ZQ    ","TSTC1_ZQD   ", &
                               "TSTC2_FXI   ","TSTC2_FXN   ","TSTC2_FYI   ","TSTC2_FYN   ","TSTC2_FZI   ","TSTC2_FZN   ", &
                               "TSTC2_MXI   ","TSTC2_MXN   ","TSTC2_MYI   ","TSTC2_MYN   ","TSTC2_MZI   ","TSTC2_MZN   ", &
                               "TSTC2_XQ    ","TSTC2_XQD   ","TSTC2_YQ    ","TSTC2_YQD   ","TSTC2_ZQ    ","TSTC2_ZQD   ", &
                               "TSTC3_FXI   ","TSTC3_FXN   ","TSTC3_FYI   ","TSTC3_FYN   ","TSTC3_FZI   ","TSTC3_FZN   ", &
                               "TSTC3_MXI   ","TSTC3_MXN   ","TSTC3_MYI   ","TSTC3_MYN   ","TSTC3_MZI   ","TSTC3_MZN   ", &
                               "TSTC3_XQ    ","TSTC3_XQD   ","TSTC3_YQ    ","TSTC3_YQD   ","TSTC3_ZQ    ","TSTC3_ZQD   ", &
                               "TSTC4_FXI   ","TSTC4_FXN   ","TSTC4_FYI   ","TSTC4_FYN   ","TSTC4_FZI   ","TSTC4_FZN   ", &
                               "TSTC4_MXI   ","TSTC4_MXN   ","TSTC4_MYI   ","TSTC4_MYN   ","TSTC4_MZI   ","TSTC4_MZN   ", &
                               "TSTC4_XQ    ","TSTC4_XQD   ","TSTC4_YQ    ","TSTC4_YQD   ","TSTC4_ZQ    ","TSTC4_ZQD   ", &
                               "YAWMOM      ","YAWMOMCOM   "/)
   INTEGER(IntKi), PARAMETER :: ParamIndxAry(518) =  (/ &                            ! This lists the index into AllOuts(:) of the allowed parameters ValidParamAry(:)
                                   BlAirFlC1 ,    BlAirFlC2 ,    BlAirFlC3 ,    BlAirFlC1 ,    BlAirFlC2 ,    BlAirFlC3 , &
                                   BlPitchC1 ,    BlPitchC2 ,    BlPitchC3 , BStC1_B1_Fxi , BStC1_B1_Fxn , BStC1_B1_Fyi , &
                                BStC1_B1_Fyn , BStC1_B1_Fzi , BStC1_B1_Fzn , BStC1_B1_Mxi , BStC1_B1_Mxn , BStC1_B1_Myi , &
                                BStC1_B1_Myn , BStC1_B1_Mzi , BStC1_B1_Mzn ,  BStC1_B1_XQ , BStC1_B1_XQD ,  BStC1_B1_YQ , &
                                BStC1_B1_YQD ,  BStC1_B1_ZQ , BStC1_B1_ZQD , BStC1_B2_Fxi , BStC1_B2_Fxn , BStC1_B2_Fyi , &
                                BStC1_B2_Fyn , BStC1_B2_Fzi , BStC1_B2_Fzn , BStC1_B2_Mxi , BStC1_B2_Mxn , BStC1_B2_Myi , &
                                BStC1_B2_Myn , BStC1_B2_Mzi , BStC1_B2_Mzn ,  BStC1_B2_XQ , BStC1_B2_XQD ,  BStC1_B2_YQ , &
                                BStC1_B2_YQD ,  BStC1_B2_ZQ , BStC1_B2_ZQD , BStC1_B3_Fxi , BStC1_B3_Fxn , BStC1_B3_Fyi , &
                                BStC1_B3_Fyn , BStC1_B3_Fzi , BStC1_B3_Fzn , BStC1_B3_Mxi , BStC1_B3_Mxn , BStC1_B3_Myi , &
                                BStC1_B3_Myn , BStC1_B3_Mzi , BStC1_B3_Mzn ,  BStC1_B3_XQ , BStC1_B3_XQD ,  BStC1_B3_YQ , &
                                BStC1_B3_YQD ,  BStC1_B3_ZQ , BStC1_B3_ZQD , BStC1_B4_Fxi , BStC1_B4_Fxn , BStC1_B4_Fyi , &
                                BStC1_B4_Fyn , BStC1_B4_Fzi , BStC1_B4_Fzn , BStC1_B4_Mxi , BStC1_B4_Mxn , BStC1_B4_Myi , &
                                BStC1_B4_Myn , BStC1_B4_Mzi , BStC1_B4_Mzn ,  BStC1_B4_XQ , BStC1_B4_XQD ,  BStC1_B4_YQ , &
                                BStC1_B4_YQD ,  BStC1_B4_ZQ , BStC1_B4_ZQD , BStC2_B1_Fxi , BStC2_B1_Fxn , BStC2_B1_Fyi , &
                                BStC2_B1_Fyn , BStC2_B1_Fzi , BStC2_B1_Fzn , BStC2_B1_Mxi , BStC2_B1_Mxn , BStC2_B1_Myi , &
                                BStC2_B1_Myn , BStC2_B1_Mzi , BStC2_B1_Mzn ,  BStC2_B1_XQ , BStC2_B1_XQD ,  BStC2_B1_YQ , &
                                BStC2_B1_YQD ,  BStC2_B1_ZQ , BStC2_B1_ZQD , BStC2_B2_Fxi , BStC2_B2_Fxn , BStC2_B2_Fyi , &
                                BStC2_B2_Fyn , BStC2_B2_Fzi , BStC2_B2_Fzn , BStC2_B2_Mxi , BStC2_B2_Mxn , BStC2_B2_Myi , &
                                BStC2_B2_Myn , BStC2_B2_Mzi , BStC2_B2_Mzn ,  BStC2_B2_XQ , BStC2_B2_XQD ,  BStC2_B2_YQ , &
                                BStC2_B2_YQD ,  BStC2_B2_ZQ , BStC2_B2_ZQD , BStC2_B3_Fxi , BStC2_B3_Fxn , BStC2_B3_Fyi , &
                                BStC2_B3_Fyn , BStC2_B3_Fzi , BStC2_B3_Fzn , BStC2_B3_Mxi , BStC2_B3_Mxn , BStC2_B3_Myi , &
                                BStC2_B3_Myn , BStC2_B3_Mzi , BStC2_B3_Mzn ,  BStC2_B3_XQ , BStC2_B3_XQD ,  BStC2_B3_YQ , &
                                BStC2_B3_YQD ,  BStC2_B3_ZQ , BStC2_B3_ZQD , BStC2_B4_Fxi , BStC2_B4_Fxn , BStC2_B4_Fyi , &
                                BStC2_B4_Fyn , BStC2_B4_Fzi , BStC2_B4_Fzn , BStC2_B4_Mxi , BStC2_B4_Mxn , BStC2_B4_Myi , &
                                BStC2_B4_Myn , BStC2_B4_Mzi , BStC2_B4_Mzn ,  BStC2_B4_XQ , BStC2_B4_XQD ,  BStC2_B4_YQ , &
                                BStC2_B4_YQD ,  BStC2_B4_ZQ , BStC2_B4_ZQD , BStC3_B1_Fxi , BStC3_B1_Fxn , BStC3_B1_Fyi , &
                                BStC3_B1_Fyn , BStC3_B1_Fzi , BStC3_B1_Fzn , BStC3_B1_Mxi , BStC3_B1_Mxn , BStC3_B1_Myi , &
                                BStC3_B1_Myn , BStC3_B1_Mzi , BStC3_B1_Mzn ,  BStC3_B1_XQ , BStC3_B1_XQD ,  BStC3_B1_YQ , &
                                BStC3_B1_YQD ,  BStC3_B1_ZQ , BStC3_B1_ZQD , BStC3_B2_Fxi , BStC3_B2_Fxn , BStC3_B2_Fyi , &
                                BStC3_B2_Fyn , BStC3_B2_Fzi , BStC3_B2_Fzn , BStC3_B2_Mxi , BStC3_B2_Mxn , BStC3_B2_Myi , &
                                BStC3_B2_Myn , BStC3_B2_Mzi , BStC3_B2_Mzn ,  BStC3_B2_XQ , BStC3_B2_XQD ,  BStC3_B2_YQ , &
                                BStC3_B2_YQD ,  BStC3_B2_ZQ , BStC3_B2_ZQD , BStC3_B3_Fxi , BStC3_B3_Fxn , BStC3_B3_Fyi , &
                                BStC3_B3_Fyn , BStC3_B3_Fzi , BStC3_B3_Fzn , BStC3_B3_Mxi , BStC3_B3_Mxn , BStC3_B3_Myi , &
                                BStC3_B3_Myn , BStC3_B3_Mzi , BStC3_B3_Mzn ,  BStC3_B3_XQ , BStC3_B3_XQD ,  BStC3_B3_YQ , &
                                BStC3_B3_YQD ,  BStC3_B3_ZQ , BStC3_B3_ZQD , BStC3_B4_Fxi , BStC3_B4_Fxn , BStC3_B4_Fyi , &
                                BStC3_B4_Fyn , BStC3_B4_Fzi , BStC3_B4_Fzn , BStC3_B4_Mxi , BStC3_B4_Mxn , BStC3_B4_Myi , &
                                BStC3_B4_Myn , BStC3_B4_Mzi , BStC3_B4_Mzn ,  BStC3_B4_XQ , BStC3_B4_XQD ,  BStC3_B4_YQ , &
                                BStC3_B4_YQD ,  BStC3_B4_ZQ , BStC3_B4_ZQD , BStC4_B1_Fxi , BStC4_B1_Fxn , BStC4_B1_Fyi , &
                                BStC4_B1_Fyn , BStC4_B1_Fzi , BStC4_B1_Fzn , BStC4_B1_Mxi , BStC4_B1_Mxn , BStC4_B1_Myi , &
                                BStC4_B1_Myn , BStC4_B1_Mzi , BStC4_B1_Mzn ,  BStC4_B1_XQ , BStC4_B1_XQD ,  BStC4_B1_YQ , &
                                BStC4_B1_YQD ,  BStC4_B1_ZQ , BStC4_B1_ZQD , BStC4_B2_Fxi , BStC4_B2_Fxn , BStC4_B2_Fyi , &
                                BStC4_B2_Fyn , BStC4_B2_Fzi , BStC4_B2_Fzn , BStC4_B2_Mxi , BStC4_B2_Mxn , BStC4_B2_Myi , &
                                BStC4_B2_Myn , BStC4_B2_Mzi , BStC4_B2_Mzn ,  BStC4_B2_XQ , BStC4_B2_XQD ,  BStC4_B2_YQ , &
                                BStC4_B2_YQD ,  BStC4_B2_ZQ , BStC4_B2_ZQD , BStC4_B3_Fxi , BStC4_B3_Fxn , BStC4_B3_Fyi , &
                                BStC4_B3_Fyn , BStC4_B3_Fzi , BStC4_B3_Fzn , BStC4_B3_Mxi , BStC4_B3_Mxn , BStC4_B3_Myi , &
                                BStC4_B3_Myn , BStC4_B3_Mzi , BStC4_B3_Mzn ,  BStC4_B3_XQ , BStC4_B3_XQD ,  BStC4_B3_YQ , &
                                BStC4_B3_YQD ,  BStC4_B3_ZQ , BStC4_B3_ZQD , BStC4_B4_Fxi , BStC4_B4_Fxn , BStC4_B4_Fyi , &
                                BStC4_B4_Fyn , BStC4_B4_Fzi , BStC4_B4_Fzn , BStC4_B4_Mxi , BStC4_B4_Mxn , BStC4_B4_Myi , &
                                BStC4_B4_Myn , BStC4_B4_Mzi , BStC4_B4_Mzn ,  BStC4_B4_XQ , BStC4_B4_XQD ,  BStC4_B4_YQ , &
                                BStC4_B4_YQD ,  BStC4_B4_ZQ , BStC4_B4_ZQD ,       GenPwr ,        GenTq ,     HSSBrTqC , &
                                   NStC1_Fxi ,    NStC1_Fxn ,    NStC1_Fyi ,    NStC1_Fyn ,    NStC1_Fzi ,    NStC1_Fzn , &
                                   NStC1_Mxi ,    NStC1_Mxn ,    NStC1_Myi ,    NStC1_Myn ,    NStC1_Mzi ,    NStC1_Mzn , &
                                    NStC1_XQ ,    NStC1_XQD ,     NStC1_YQ ,    NStC1_YQD ,     NStC1_ZQ ,    NStC1_ZQD , &
                                   NStC2_Fxi ,    NStC2_Fxn ,    NStC2_Fyi ,    NStC2_Fyn ,    NStC2_Fzi ,    NStC2_Fzn , &
                                   NStC2_Mxi ,    NStC2_Mxn ,    NStC2_Myi ,    NStC2_Myn ,    NStC2_Mzi ,    NStC2_Mzn , &
                                    NStC2_XQ ,    NStC2_XQD ,     NStC2_YQ ,    NStC2_YQD ,     NStC2_ZQ ,    NStC2_ZQD , &
                                   NStC3_Fxi ,    NStC3_Fxn ,    NStC3_Fyi ,    NStC3_Fyn ,    NStC3_Fzi ,    NStC3_Fzn , &
                                   NStC3_Mxi ,    NStC3_Mxn ,    NStC3_Myi ,    NStC3_Myn ,    NStC3_Mzi ,    NStC3_Mzn , &
                                    NStC3_XQ ,    NStC3_XQD ,     NStC3_YQ ,    NStC3_YQD ,     NStC3_ZQ ,    NStC3_ZQD , &
                                   NStC4_Fxi ,    NStC4_Fxn ,    NStC4_Fyi ,    NStC4_Fyn ,    NStC4_Fzi ,    NStC4_Fzn , &
                                   NStC4_Mxi ,    NStC4_Mxn ,    NStC4_Myi ,    NStC4_Myn ,    NStC4_Mzi ,    NStC4_Mzn , &
                                    NStC4_XQ ,    NStC4_XQD ,     NStC4_YQ ,    NStC4_YQD ,     NStC4_ZQ ,    NStC4_ZQD , &
                                PtfmStC1_Fxi , PtfmStC1_Fxn , PtfmStC1_Fyi , PtfmStC1_Fyn , PtfmStC1_Fzi , PtfmStC1_Fzn , &
                                PtfmStC1_Mxi , PtfmStC1_Mxn , PtfmStC1_Myi , PtfmStC1_Myn , PtfmStC1_Mzi , PtfmStC1_Mzn , &
                                 PtfmStC1_XQ , PtfmStC1_XQD ,  PtfmStC1_YQ , PtfmStC1_YQD ,  PtfmStC1_ZQ , PtfmStC1_ZQD , &
                                PtfmStC2_Fxi , PtfmStC2_Fxn , PtfmStC2_Fyi , PtfmStC2_Fyn , PtfmStC2_Fzi , PtfmStC2_Fzn , &
                                PtfmStC2_Mxi , PtfmStC2_Mxn , PtfmStC2_Myi , PtfmStC2_Myn , PtfmStC2_Mzi , PtfmStC2_Mzn , &
                                 PtfmStC2_XQ , PtfmStC2_XQD ,  PtfmStC2_YQ , PtfmStC2_YQD ,  PtfmStC2_ZQ , PtfmStC2_ZQD , &
                                PtfmStC3_Fxi , PtfmStC3_Fxn , PtfmStC3_Fyi , PtfmStC3_Fyn , PtfmStC3_Fzi , PtfmStC3_Fzn , &
                                PtfmStC3_Mxi , PtfmStC3_Mxn , PtfmStC3_Myi , PtfmStC3_Myn , PtfmStC3_Mzi , PtfmStC3_Mzn , &
                                 PtfmStC3_XQ , PtfmStC3_XQD ,  PtfmStC3_YQ , PtfmStC3_YQD ,  PtfmStC3_ZQ , PtfmStC3_ZQD , &
                                PtfmStC4_Fxi , PtfmStC4_Fxn , PtfmStC4_Fyi , PtfmStC4_Fyn , PtfmStC4_Fzi , PtfmStC4_Fzn , &
                                PtfmStC4_Mxi , PtfmStC4_Mxn , PtfmStC4_Myi , PtfmStC4_Myn , PtfmStC4_Mzi , PtfmStC4_Mzn , &
                                 PtfmStC4_XQ , PtfmStC4_XQD ,  PtfmStC4_YQ , PtfmStC4_YQD ,  PtfmStC4_ZQ , PtfmStC4_ZQD , &
                                   TStC1_Fxi ,    TStC1_Fxn ,    TStC1_Fyi ,    TStC1_Fyn ,    TStC1_Fzi ,    TStC1_Fzn , &
                                   TStC1_Mxi ,    TStC1_Mxn ,    TStC1_Myi ,    TStC1_Myn ,    TStC1_Mzi ,    TStC1_Mzn , &
                                    TStC1_XQ ,    TStC1_XQD ,     TStC1_YQ ,    TStC1_YQD ,     TStC1_ZQ ,    TStC1_ZQD , &
                                   TStC2_Fxi ,    TStC2_Fxn ,    TStC2_Fyi ,    TStC2_Fyn ,    TStC2_Fzi ,    TStC2_Fzn , &
                                   TStC2_Mxi ,    TStC2_Mxn ,    TStC2_Myi ,    TStC2_Myn ,    TStC2_Mzi ,    TStC2_Mzn , &
                                    TStC2_XQ ,    TStC2_XQD ,     TStC2_YQ ,    TStC2_YQD ,     TStC2_ZQ ,    TStC2_ZQD , &
                                   TStC3_Fxi ,    TStC3_Fxn ,    TStC3_Fyi ,    TStC3_Fyn ,    TStC3_Fzi ,    TStC3_Fzn , &
                                   TStC3_Mxi ,    TStC3_Mxn ,    TStC3_Myi ,    TStC3_Myn ,    TStC3_Mzi ,    TStC3_Mzn , &
                                    TStC3_XQ ,    TStC3_XQD ,     TStC3_YQ ,    TStC3_YQD ,     TStC3_ZQ ,    TStC3_ZQD , &
                                   TStC4_Fxi ,    TStC4_Fxn ,    TStC4_Fyi ,    TStC4_Fyn ,    TStC4_Fzi ,    TStC4_Fzn , &
                                   TStC4_Mxi ,    TStC4_Mxn ,    TStC4_Myi ,    TStC4_Myn ,    TStC4_Mzi ,    TStC4_Mzn , &
                                    TStC4_XQ ,    TStC4_XQD ,     TStC4_YQ ,    TStC4_YQD ,     TStC4_ZQ ,    TStC4_ZQD , &
                                   YawMomCom ,    YawMomCom /)
   CHARACTER(ChanLen), PARAMETER :: ParamUnitsAry(518) =  (/  &  ! This lists the units corresponding to the allowed parameters
                               "(-)   ","(-)   ","(-)   ","(-)   ","(-)   ","(-)   ", &
                               "(deg) ","(deg) ","(deg) ","(kN)  ","(kN)  ","(kN)  ", &
                               "(kN)  ","(kN)  ","(kN)  ","(kN-m)","(kN-m)","(kN-m)", &
                               "(kN-m)","(kN-m)","(kN-m)","(m)   ","(m/s) ","(m)   ", &
                               "(m/s) ","(m)   ","(m/s) ","(kN)  ","(kN)  ","(kN)  ", &
                               "(kN)  ","(kN)  ","(kN)  ","(kN-m)","(kN-m)","(kN-m)", &
                               "(kN-m)","(kN-m)","(kN-m)","(m)   ","(m/s) ","(m)   ", &
                               "(m/s) ","(m)   ","(m/s) ","(kN)  ","(kN)  ","(kN)  ", &
                               "(kN)  ","(kN)  ","(kN)  ","(kN-m)","(kN-m)","(kN-m)", &
                               "(kN-m)","(kN-m)","(kN-m)","(m)   ","(m/s) ","(m)   ", &
                               "(m/s) ","(m)   ","(m/s) ","(kN)  ","(kN)  ","(kN)  ", &
                               "(kN)  ","(kN)  ","(kN)  ","(kN-m)","(kN-m)","(kN-m)", &
                               "(kN-m)","(kN-m)","(kN-m)","(m)   ","(m/s) ","(m)   ", &
                               "(m/s) ","(m)   ","(m/s) ","(kN)  ","(kN)  ","(kN)  ", &
                               "(kN)  ","(kN)  ","(kN)  ","(kN-m)","(kN-m)","(kN-m)", &
                               "(kN-m)","(kN-m)","(kN-m)","(m)   ","(m/s) ","(m)   ", &
                               "(m/s) ","(m)   ","(m/s) ","(kN)  ","(kN)  ","(kN)  ", &
                               "(kN)  ","(kN)  ","(kN)  ","(kN-m)","(kN-m)","(kN-m)", &
                               "(kN-m)","(kN-m)","(kN-m)","(m)   ","(m/s) ","(m)   ", &
                               "(m/s) ","(m)   ","(m/s) ","(kN)  ","(kN)  ","(kN)  ", &
                               "(kN)  ","(kN)  ","(kN)  ","(kN-m)","(kN-m)","(kN-m)", &
                               "(kN-m)","(kN-m)","(kN-m)","(m)   ","(m/s) ","(m)   ", &
                               "(m/s) ","(m)   ","(m/s) ","(kN)  ","(kN)  ","(kN)  ", &
                               "(kN)  ","(kN)  ","(kN)  ","(kN-m)","(kN-m)","(kN-m)", &
                               "(kN-m)","(kN-m)","(kN-m)","(m)   ","(m/s) ","(m)   ", &
                               "(m/s) ","(m)   ","(m/s) ","(kN)  ","(kN)  ","(kN)  ", &
                               "(kN)  ","(kN)  ","(kN)  ","(kN-m)","(kN-m)","(kN-m)", &
                               "(kN-m)","(kN-m)","(kN-m)","(m)   ","(m/s) ","(m)   ", &
                               "(m/s) ","(m)   ","(m/s) ","(kN)  ","(kN)  ","(kN)  ", &
                               "(kN)  ","(kN)  ","(kN)  ","(kN-m)","(kN-m)","(kN-m)", &
                               "(kN-m)","(kN-m)","(kN-m)","(m)   ","(m/s) ","(m)   ", &
                               "(m/s) ","(m)   ","(m/s) ","(kN)  ","(kN)  ","(kN)  ", &
                               "(kN)  ","(kN)  ","(kN)  ","(kN-m)","(kN-m)","(kN-m)", &
                               "(kN-m)","(kN-m)","(kN-m)","(m)   ","(m/s) ","(m)   ", &
                               "(m/s) ","(m)   ","(m/s) ","(kN)  ","(kN)  ","(kN)  ", &
                               "(kN)  ","(kN)  ","(kN)  ","(kN-m)","(kN-m)","(kN-m)", &
                               "(kN-m)","(kN-m)","(kN-m)","(m)   ","(m/s) ","(m)   ", &
                               "(m/s) ","(m)   ","(m/s) ","(kN)  ","(kN)  ","(kN)  ", &
                               "(kN)  ","(kN)  ","(kN)  ","(kN-m)","(kN-m)","(kN-m)", &
                               "(kN-m)","(kN-m)","(kN-m)","(m)   ","(m/s) ","(m)   ", &
                               "(m/s) ","(m)   ","(m/s) ","(kN)  ","(kN)  ","(kN)  ", &
                               "(kN)  ","(kN)  ","(kN)  ","(kN-m)","(kN-m)","(kN-m)", &
                               "(kN-m)","(kN-m)","(kN-m)","(m)   ","(m/s) ","(m)   ", &
                               "(m/s) ","(m)   ","(m/s) ","(kN)  ","(kN)  ","(kN)  ", &
                               "(kN)  ","(kN)  ","(kN)  ","(kN-m)","(kN-m)","(kN-m)", &
                               "(kN-m)","(kN-m)","(kN-m)","(m)   ","(m/s) ","(m)   ", &
                               "(m/s) ","(m)   ","(m/s) ","(kN)  ","(kN)  ","(kN)  ", &
                               "(kN)  ","(kN)  ","(kN)  ","(kN-m)","(kN-m)","(kN-m)", &
                               "(kN-m)","(kN-m)","(kN-m)","(m)   ","(m/s) ","(m)   ", &
                               "(m/s) ","(m)   ","(m/s) ","(kW)  ","(kN-m)","(kN-m)", &
                               "(kN)  ","(kN)  ","(kN)  ","(kN)  ","(kN)  ","(kN)  ", &
                               "(kN-m)","(kN-m)","(kN-m)","(kN-m)","(kN-m)","(kN-m)", &
                               "(m)   ","(m/s) ","(m)   ","(m/s) ","(m)   ","(m/s) ", &
                               "(kN)  ","(kN)  ","(kN)  ","(kN)  ","(kN)  ","(kN)  ", &
                               "(kN-m)","(kN-m)","(kN-m)","(kN-m)","(kN-m)","(kN-m)", &
                               "(m)   ","(m/s) ","(m)   ","(m/s) ","(m)   ","(m/s) ", &
                               "(kN)  ","(kN)  ","(kN)  ","(kN)  ","(kN)  ","(kN)  ", &
                               "(kN-m)","(kN-m)","(kN-m)","(kN-m)","(kN-m)","(kN-m)", &
                               "(m)   ","(m/s) ","(m)   ","(m/s) ","(m)   ","(m/s) ", &
                               "(kN)  ","(kN)  ","(kN)  ","(kN)  ","(kN)  ","(kN)  ", &
                               "(kN-m)","(kN-m)","(kN-m)","(kN-m)","(kN-m)","(kN-m)", &
                               "(m)   ","(m/s) ","(m)   ","(m/s) ","(m)   ","(m/s) ", &
                               "(kN)  ","(kN)  ","(kN)  ","(kN)  ","(kN)  ","(kN)  ", &
                               "(kN-m)","(kN-m)","(kN-m)","(kN-m)","(kN-m)","(kN-m)", &
                               "(m)   ","(m/s) ","(m)   ","(m/s) ","(m)   ","(m/s) ", &
                               "(kN)  ","(kN)  ","(kN)  ","(kN)  ","(kN)  ","(kN)  ", &
                               "(kN-m)","(kN-m)","(kN-m)","(kN-m)","(kN-m)","(kN-m)", &
                               "(m)   ","(m/s) ","(m)   ","(m/s) ","(m)   ","(m/s) ", &
                               "(kN)  ","(kN)  ","(kN)  ","(kN)  ","(kN)  ","(kN)  ", &
                               "(kN-m)","(kN-m)","(kN-m)","(kN-m)","(kN-m)","(kN-m)", &
                               "(m)   ","(m/s) ","(m)   ","(m/s) ","(m)   ","(m/s) ", &
                               "(kN)  ","(kN)  ","(kN)  ","(kN)  ","(kN)  ","(kN)  ", &
                               "(kN-m)","(kN-m)","(kN-m)","(kN-m)","(kN-m)","(kN-m)", &
                               "(m)   ","(m/s) ","(m)   ","(m/s) ","(m)   ","(m/s) ", &
                               "(kN)  ","(kN)  ","(kN)  ","(kN)  ","(kN)  ","(kN)  ", &
                               "(kN-m)","(kN-m)","(kN-m)","(kN-m)","(kN-m)","(kN-m)", &
                               "(m)   ","(m/s) ","(m)   ","(m/s) ","(m)   ","(m/s) ", &
                               "(kN)  ","(kN)  ","(kN)  ","(kN)  ","(kN)  ","(kN)  ", &
                               "(kN-m)","(kN-m)","(kN-m)","(kN-m)","(kN-m)","(kN-m)", &
                               "(m)   ","(m/s) ","(m)   ","(m/s) ","(m)   ","(m/s) ", &
                               "(kN)  ","(kN)  ","(kN)  ","(kN)  ","(kN)  ","(kN)  ", &
                               "(kN-m)","(kN-m)","(kN-m)","(kN-m)","(kN-m)","(kN-m)", &
                               "(m)   ","(m/s) ","(m)   ","(m/s) ","(m)   ","(m/s) ", &
                               "(kN)  ","(kN)  ","(kN)  ","(kN)  ","(kN)  ","(kN)  ", &
                               "(kN-m)","(kN-m)","(kN-m)","(kN-m)","(kN-m)","(kN-m)", &
                               "(m)   ","(m/s) ","(m)   ","(m/s) ","(m)   ","(m/s) ", &
                               "(kN-m)","(kN-m)"/)


      ! Initialize values
   ErrStat = ErrID_None
   ErrMsg = ""
   InvalidOutput = .FALSE.


      ! Determine which inputs are not valid

   InvalidOutput(   BlAirFlC3) = ( p%NumBl < 3 )
   InvalidOutput(   BlPitchC3) = ( p%NumBl < 3 )
   InvalidOutput(    NStC1_XQ) = ( p%CompNStC<1 )
   InvalidOutput(   NStC1_XQD) = ( p%CompNStC<1 )
   InvalidOutput(    NStC1_YQ) = ( p%CompNStC<1 )
   InvalidOutput(   NStC1_YQD) = ( p%CompNStC<1 )
   InvalidOutput(    NStC1_ZQ) = ( p%CompNStC<1 )
   InvalidOutput(   NStC1_ZQD) = ( p%CompNStC<1 )
   InvalidOutput(   NStC1_Fxi) = ( p%CompNStC<1 )
   InvalidOutput(   NStC1_Fyi) = ( p%CompNStC<1 )
   InvalidOutput(   NStC1_Fzi) = ( p%CompNStC<1 )
   InvalidOutput(   NStC1_Mxi) = ( p%CompNStC<1 )
   InvalidOutput(   NStC1_Myi) = ( p%CompNStC<1 )
   InvalidOutput(   NStC1_Mzi) = ( p%CompNStC<1 )
   InvalidOutput(   NStC1_Fxn) = ( p%CompNStC<1 )
   InvalidOutput(   NStC1_Fyn) = ( p%CompNStC<1 )
   InvalidOutput(   NStC1_Fzn) = ( p%CompNStC<1 )
   InvalidOutput(   NStC1_Mxn) = ( p%CompNStC<1 )
   InvalidOutput(   NStC1_Myn) = ( p%CompNStC<1 )
   InvalidOutput(   NStC1_Mzn) = ( p%CompNStC<1 )
   InvalidOutput(    NStC2_XQ) = ( p%CompNStC<2 )
   InvalidOutput(   NStC2_XQD) = ( p%CompNStC<2 )
   InvalidOutput(    NStC2_YQ) = ( p%CompNStC<2 )
   InvalidOutput(   NStC2_YQD) = ( p%CompNStC<2 )
   InvalidOutput(    NStC2_ZQ) = ( p%CompNStC<2 )
   InvalidOutput(   NStC2_ZQD) = ( p%CompNStC<2 )
   InvalidOutput(   NStC2_Fxi) = ( p%CompNStC<2 )
   InvalidOutput(   NStC2_Fyi) = ( p%CompNStC<2 )
   InvalidOutput(   NStC2_Fzi) = ( p%CompNStC<2 )
   InvalidOutput(   NStC2_Mxi) = ( p%CompNStC<2 )
   InvalidOutput(   NStC2_Myi) = ( p%CompNStC<2 )
   InvalidOutput(   NStC2_Mzi) = ( p%CompNStC<2 )
   InvalidOutput(   NStC2_Fxn) = ( p%CompNStC<2 )
   InvalidOutput(   NStC2_Fyn) = ( p%CompNStC<2 )
   InvalidOutput(   NStC2_Fzn) = ( p%CompNStC<2 )
   InvalidOutput(   NStC2_Mxn) = ( p%CompNStC<2 )
   InvalidOutput(   NStC2_Myn) = ( p%CompNStC<2 )
   InvalidOutput(   NStC2_Mzn) = ( p%CompNStC<2 )
   InvalidOutput(    NStC3_XQ) = ( p%CompNStC<3 )
   InvalidOutput(   NStC3_XQD) = ( p%CompNStC<3 )
   InvalidOutput(    NStC3_YQ) = ( p%CompNStC<3 )
   InvalidOutput(   NStC3_YQD) = ( p%CompNStC<3 )
   InvalidOutput(    NStC3_ZQ) = ( p%CompNStC<3 )
   InvalidOutput(   NStC3_ZQD) = ( p%CompNStC<3 )
   InvalidOutput(   NStC3_Fxi) = ( p%CompNStC<3 )
   InvalidOutput(   NStC3_Fyi) = ( p%CompNStC<3 )
   InvalidOutput(   NStC3_Fzi) = ( p%CompNStC<3 )
   InvalidOutput(   NStC3_Mxi) = ( p%CompNStC<3 )
   InvalidOutput(   NStC3_Myi) = ( p%CompNStC<3 )
   InvalidOutput(   NStC3_Mzi) = ( p%CompNStC<3 )
   InvalidOutput(   NStC3_Fxn) = ( p%CompNStC<3 )
   InvalidOutput(   NStC3_Fyn) = ( p%CompNStC<3 )
   InvalidOutput(   NStC3_Fzn) = ( p%CompNStC<3 )
   InvalidOutput(   NStC3_Mxn) = ( p%CompNStC<3 )
   InvalidOutput(   NStC3_Myn) = ( p%CompNStC<3 )
   InvalidOutput(   NStC3_Mzn) = ( p%CompNStC<3 )
   InvalidOutput(    NStC4_XQ) = ( p%CompNStC<4 )
   InvalidOutput(   NStC4_XQD) = ( p%CompNStC<4 )
   InvalidOutput(    NStC4_YQ) = ( p%CompNStC<4 )
   InvalidOutput(   NStC4_YQD) = ( p%CompNStC<4 )
   InvalidOutput(    NStC4_ZQ) = ( p%CompNStC<4 )
   InvalidOutput(   NStC4_ZQD) = ( p%CompNStC<4 )
   InvalidOutput(   NStC4_Fxi) = ( p%CompNStC<4 )
   InvalidOutput(   NStC4_Fyi) = ( p%CompNStC<4 )
   InvalidOutput(   NStC4_Fzi) = ( p%CompNStC<4 )
   InvalidOutput(   NStC4_Mxi) = ( p%CompNStC<4 )
   InvalidOutput(   NStC4_Myi) = ( p%CompNStC<4 )
   InvalidOutput(   NStC4_Mzi) = ( p%CompNStC<4 )
   InvalidOutput(   NStC4_Fxn) = ( p%CompNStC<4 )
   InvalidOutput(   NStC4_Fyn) = ( p%CompNStC<4 )
   InvalidOutput(   NStC4_Fzn) = ( p%CompNStC<4 )
   InvalidOutput(   NStC4_Mxn) = ( p%CompNStC<4 )
   InvalidOutput(   NStC4_Myn) = ( p%CompNStC<4 )
   InvalidOutput(   NStC4_Mzn) = ( p%CompNStC<4 )
   InvalidOutput(    TStC1_XQ) = ( p%CompTStC<1 )
   InvalidOutput(   TStC1_XQD) = ( p%CompTStC<1 )
   InvalidOutput(    TStC1_YQ) = ( p%CompTStC<1 )
   InvalidOutput(   TStC1_YQD) = ( p%CompTStC<1 )
   InvalidOutput(    TStC1_ZQ) = ( p%CompTStC<1 )
   InvalidOutput(   TStC1_ZQD) = ( p%CompTStC<1 )
   InvalidOutput(   TStC1_Fxi) = ( p%CompTStC<1 )
   InvalidOutput(   TStC1_Fyi) = ( p%CompTStC<1 )
   InvalidOutput(   TStC1_Fzi) = ( p%CompTStC<1 )
   InvalidOutput(   TStC1_Mxi) = ( p%CompTStC<1 )
   InvalidOutput(   TStC1_Myi) = ( p%CompTStC<1 )
   InvalidOutput(   TStC1_Mzi) = ( p%CompTStC<1 )
   InvalidOutput(   TStC1_Fxn) = ( p%CompTStC<1 )
   InvalidOutput(   TStC1_Fyn) = ( p%CompTStC<1 )
   InvalidOutput(   TStC1_Fzn) = ( p%CompTStC<1 )
   InvalidOutput(   TStC1_Mxn) = ( p%CompTStC<1 )
   InvalidOutput(   TStC1_Myn) = ( p%CompTStC<1 )
   InvalidOutput(   TStC1_Mzn) = ( p%CompTStC<1 )
   InvalidOutput(    TStC2_XQ) = ( p%CompTStC<2 )
   InvalidOutput(   TStC2_XQD) = ( p%CompTStC<2 )
   InvalidOutput(    TStC2_YQ) = ( p%CompTStC<2 )
   InvalidOutput(   TStC2_YQD) = ( p%CompTStC<2 )
   InvalidOutput(    TStC2_ZQ) = ( p%CompTStC<2 )
   InvalidOutput(   TStC2_ZQD) = ( p%CompTStC<2 )
   InvalidOutput(   TStC2_Fxi) = ( p%CompTStC<2 )
   InvalidOutput(   TStC2_Fyi) = ( p%CompTStC<2 )
   InvalidOutput(   TStC2_Fzi) = ( p%CompTStC<2 )
   InvalidOutput(   TStC2_Mxi) = ( p%CompTStC<2 )
   InvalidOutput(   TStC2_Myi) = ( p%CompTStC<2 )
   InvalidOutput(   TStC2_Mzi) = ( p%CompTStC<2 )
   InvalidOutput(   TStC2_Fxn) = ( p%CompTStC<2 )
   InvalidOutput(   TStC2_Fyn) = ( p%CompTStC<2 )
   InvalidOutput(   TStC2_Fzn) = ( p%CompTStC<2 )
   InvalidOutput(   TStC2_Mxn) = ( p%CompTStC<2 )
   InvalidOutput(   TStC2_Myn) = ( p%CompTStC<2 )
   InvalidOutput(   TStC2_Mzn) = ( p%CompTStC<2 )
   InvalidOutput(    TStC3_XQ) = ( p%CompTStC<3 )
   InvalidOutput(   TStC3_XQD) = ( p%CompTStC<3 )
   InvalidOutput(    TStC3_YQ) = ( p%CompTStC<3 )
   InvalidOutput(   TStC3_YQD) = ( p%CompTStC<3 )
   InvalidOutput(    TStC3_ZQ) = ( p%CompTStC<3 )
   InvalidOutput(   TStC3_ZQD) = ( p%CompTStC<3 )
   InvalidOutput(   TStC3_Fxi) = ( p%CompTStC<3 )
   InvalidOutput(   TStC3_Fyi) = ( p%CompTStC<3 )
   InvalidOutput(   TStC3_Fzi) = ( p%CompTStC<3 )
   InvalidOutput(   TStC3_Mxi) = ( p%CompTStC<3 )
   InvalidOutput(   TStC3_Myi) = ( p%CompTStC<3 )
   InvalidOutput(   TStC3_Mzi) = ( p%CompTStC<3 )
   InvalidOutput(   TStC3_Fxn) = ( p%CompTStC<3 )
   InvalidOutput(   TStC3_Fyn) = ( p%CompTStC<3 )
   InvalidOutput(   TStC3_Fzn) = ( p%CompTStC<3 )
   InvalidOutput(   TStC3_Mxn) = ( p%CompTStC<3 )
   InvalidOutput(   TStC3_Myn) = ( p%CompTStC<3 )
   InvalidOutput(   TStC3_Mzn) = ( p%CompTStC<3 )
   InvalidOutput(    TStC4_XQ) = ( p%CompTStC<4 )
   InvalidOutput(   TStC4_XQD) = ( p%CompTStC<4 )
   InvalidOutput(    TStC4_YQ) = ( p%CompTStC<4 )
   InvalidOutput(   TStC4_YQD) = ( p%CompTStC<4 )
   InvalidOutput(    TStC4_ZQ) = ( p%CompTStC<4 )
   InvalidOutput(   TStC4_ZQD) = ( p%CompTStC<4 )
   InvalidOutput(   TStC4_Fxi) = ( p%CompTStC<4 )
   InvalidOutput(   TStC4_Fyi) = ( p%CompTStC<4 )
   InvalidOutput(   TStC4_Fzi) = ( p%CompTStC<4 )
   InvalidOutput(   TStC4_Mxi) = ( p%CompTStC<4 )
   InvalidOutput(   TStC4_Myi) = ( p%CompTStC<4 )
   InvalidOutput(   TStC4_Mzi) = ( p%CompTStC<4 )
   InvalidOutput(   TStC4_Fxn) = ( p%CompTStC<4 )
   InvalidOutput(   TStC4_Fyn) = ( p%CompTStC<4 )
   InvalidOutput(   TStC4_Fzn) = ( p%CompTStC<4 )
   InvalidOutput(   TStC4_Mxn) = ( p%CompTStC<4 )
   InvalidOutput(   TStC4_Myn) = ( p%CompTStC<4 )
   InvalidOutput(   TStC4_Mzn) = ( p%CompTStC<4 )
   InvalidOutput( BStC1_B1_XQ) = ( p%CompBStC<1 .or. p%NumBl<1 )
   InvalidOutput(BStC1_B1_XQD) = ( p%CompBStC<1 .or. p%NumBl<1 )
   InvalidOutput( BStC1_B1_YQ) = ( p%CompBStC<1 .or. p%NumBl<1 )
   InvalidOutput(BStC1_B1_YQD) = ( p%CompBStC<1 .or. p%NumBl<1 )
   InvalidOutput( BStC1_B1_ZQ) = ( p%CompBStC<1 .or. p%NumBl<1 )
   InvalidOutput(BStC1_B1_ZQD) = ( p%CompBStC<1 .or. p%NumBl<1 )
   InvalidOutput(BStC1_B1_Fxi) = ( p%CompBStC<1 .or. p%NumBl<1 )
   InvalidOutput(BStC1_B1_Fyi) = ( p%CompBStC<1 .or. p%NumBl<1 )
   InvalidOutput(BStC1_B1_Fzi) = ( p%CompBStC<1 .or. p%NumBl<1 )
   InvalidOutput(BStC1_B1_Mxi) = ( p%CompBStC<1 .or. p%NumBl<1 )
   InvalidOutput(BStC1_B1_Myi) = ( p%CompBStC<1 .or. p%NumBl<1 )
   InvalidOutput(BStC1_B1_Mzi) = ( p%CompBStC<1 .or. p%NumBl<1 )
   InvalidOutput(BStC1_B1_Fxn) = ( p%CompBStC<1 .or. p%NumBl<1 )
   InvalidOutput(BStC1_B1_Fyn) = ( p%CompBStC<1 .or. p%NumBl<1 )
   InvalidOutput(BStC1_B1_Fzn) = ( p%CompBStC<1 .or. p%NumBl<1 )
   InvalidOutput(BStC1_B1_Mxn) = ( p%CompBStC<1 .or. p%NumBl<1 )
   InvalidOutput(BStC1_B1_Myn) = ( p%CompBStC<1 .or. p%NumBl<1 )
   InvalidOutput(BStC1_B1_Mzn) = ( p%CompBStC<1 .or. p%NumBl<1 )
   InvalidOutput( BStC2_B1_XQ) = ( p%CompBStC<2 .or. p%NumBl<1 )
   InvalidOutput(BStC2_B1_XQD) = ( p%CompBStC<2 .or. p%NumBl<1 )
   InvalidOutput( BStC2_B1_YQ) = ( p%CompBStC<2 .or. p%NumBl<1 )
   InvalidOutput(BStC2_B1_YQD) = ( p%CompBStC<2 .or. p%NumBl<1 )
   InvalidOutput( BStC2_B1_ZQ) = ( p%CompBStC<2 .or. p%NumBl<1 )
   InvalidOutput(BStC2_B1_ZQD) = ( p%CompBStC<2 .or. p%NumBl<1 )
   InvalidOutput(BStC2_B1_Fxi) = ( p%CompBStC<2 .or. p%NumBl<1 )
   InvalidOutput(BStC2_B1_Fyi) = ( p%CompBStC<2 .or. p%NumBl<1 )
   InvalidOutput(BStC2_B1_Fzi) = ( p%CompBStC<2 .or. p%NumBl<1 )
   InvalidOutput(BStC2_B1_Mxi) = ( p%CompBStC<2 .or. p%NumBl<1 )
   InvalidOutput(BStC2_B1_Myi) = ( p%CompBStC<2 .or. p%NumBl<1 )
   InvalidOutput(BStC2_B1_Mzi) = ( p%CompBStC<2 .or. p%NumBl<1 )
   InvalidOutput(BStC2_B1_Fxn) = ( p%CompBStC<2 .or. p%NumBl<1 )
   InvalidOutput(BStC2_B1_Fyn) = ( p%CompBStC<2 .or. p%NumBl<1 )
   InvalidOutput(BStC2_B1_Fzn) = ( p%CompBStC<2 .or. p%NumBl<1 )
   InvalidOutput(BStC2_B1_Mxn) = ( p%CompBStC<2 .or. p%NumBl<1 )
   InvalidOutput(BStC2_B1_Myn) = ( p%CompBStC<2 .or. p%NumBl<1 )
   InvalidOutput(BStC2_B1_Mzn) = ( p%CompBStC<2 .or. p%NumBl<1 )
   InvalidOutput( BStC3_B1_XQ) = ( p%CompBStC<3 .or. p%NumBl<1 )
   InvalidOutput(BStC3_B1_XQD) = ( p%CompBStC<3 .or. p%NumBl<1 )
   InvalidOutput( BStC3_B1_YQ) = ( p%CompBStC<3 .or. p%NumBl<1 )
   InvalidOutput(BStC3_B1_YQD) = ( p%CompBStC<3 .or. p%NumBl<1 )
   InvalidOutput( BStC3_B1_ZQ) = ( p%CompBStC<3 .or. p%NumBl<1 )
   InvalidOutput(BStC3_B1_ZQD) = ( p%CompBStC<3 .or. p%NumBl<1 )
   InvalidOutput(BStC3_B1_Fxi) = ( p%CompBStC<3 .or. p%NumBl<1 )
   InvalidOutput(BStC3_B1_Fyi) = ( p%CompBStC<3 .or. p%NumBl<1 )
   InvalidOutput(BStC3_B1_Fzi) = ( p%CompBStC<3 .or. p%NumBl<1 )
   InvalidOutput(BStC3_B1_Mxi) = ( p%CompBStC<3 .or. p%NumBl<1 )
   InvalidOutput(BStC3_B1_Myi) = ( p%CompBStC<3 .or. p%NumBl<1 )
   InvalidOutput(BStC3_B1_Mzi) = ( p%CompBStC<3 .or. p%NumBl<1 )
   InvalidOutput(BStC3_B1_Fxn) = ( p%CompBStC<3 .or. p%NumBl<1 )
   InvalidOutput(BStC3_B1_Fyn) = ( p%CompBStC<3 .or. p%NumBl<1 )
   InvalidOutput(BStC3_B1_Fzn) = ( p%CompBStC<3 .or. p%NumBl<1 )
   InvalidOutput(BStC3_B1_Mxn) = ( p%CompBStC<3 .or. p%NumBl<1 )
   InvalidOutput(BStC3_B1_Myn) = ( p%CompBStC<3 .or. p%NumBl<1 )
   InvalidOutput(BStC3_B1_Mzn) = ( p%CompBStC<3 .or. p%NumBl<1 )
   InvalidOutput( BStC4_B1_XQ) = ( p%CompBStC<4 .or. p%NumBl<1 )
   InvalidOutput(BStC4_B1_XQD) = ( p%CompBStC<4 .or. p%NumBl<1 )
   InvalidOutput( BStC4_B1_YQ) = ( p%CompBStC<4 .or. p%NumBl<1 )
   InvalidOutput(BStC4_B1_YQD) = ( p%CompBStC<4 .or. p%NumBl<1 )
   InvalidOutput( BStC4_B1_ZQ) = ( p%CompBStC<4 .or. p%NumBl<1 )
   InvalidOutput(BStC4_B1_ZQD) = ( p%CompBStC<4 .or. p%NumBl<1 )
   InvalidOutput(BStC4_B1_Fxi) = ( p%CompBStC<4 .or. p%NumBl<1 )
   InvalidOutput(BStC4_B1_Fyi) = ( p%CompBStC<4 .or. p%NumBl<1 )
   InvalidOutput(BStC4_B1_Fzi) = ( p%CompBStC<4 .or. p%NumBl<1 )
   InvalidOutput(BStC4_B1_Mxi) = ( p%CompBStC<4 .or. p%NumBl<1 )
   InvalidOutput(BStC4_B1_Myi) = ( p%CompBStC<4 .or. p%NumBl<1 )
   InvalidOutput(BStC4_B1_Mzi) = ( p%CompBStC<4 .or. p%NumBl<1 )
   InvalidOutput(BStC4_B1_Fxn) = ( p%CompBStC<4 .or. p%NumBl<1 )
   InvalidOutput(BStC4_B1_Fyn) = ( p%CompBStC<4 .or. p%NumBl<1 )
   InvalidOutput(BStC4_B1_Fzn) = ( p%CompBStC<4 .or. p%NumBl<1 )
   InvalidOutput(BStC4_B1_Mxn) = ( p%CompBStC<4 .or. p%NumBl<1 )
   InvalidOutput(BStC4_B1_Myn) = ( p%CompBStC<4 .or. p%NumBl<1 )
   InvalidOutput(BStC4_B1_Mzn) = ( p%CompBStC<4 .or. p%NumBl<1 )
   InvalidOutput( BStC1_B2_XQ) = ( p%CompBStC<1 .or. p%NumBl<2 )
   InvalidOutput(BStC1_B2_XQD) = ( p%CompBStC<1 .or. p%NumBl<2 )
   InvalidOutput( BStC1_B2_YQ) = ( p%CompBStC<1 .or. p%NumBl<2 )
   InvalidOutput(BStC1_B2_YQD) = ( p%CompBStC<1 .or. p%NumBl<2 )
   InvalidOutput( BStC1_B2_ZQ) = ( p%CompBStC<1 .or. p%NumBl<2 )
   InvalidOutput(BStC1_B2_ZQD) = ( p%CompBStC<1 .or. p%NumBl<2 )
   InvalidOutput(BStC1_B2_Fxi) = ( p%CompBStC<1 .or. p%NumBl<2 )
   InvalidOutput(BStC1_B2_Fyi) = ( p%CompBStC<1 .or. p%NumBl<2 )
   InvalidOutput(BStC1_B2_Fzi) = ( p%CompBStC<1 .or. p%NumBl<2 )
   InvalidOutput(BStC1_B2_Mxi) = ( p%CompBStC<1 .or. p%NumBl<2 )
   InvalidOutput(BStC1_B2_Myi) = ( p%CompBStC<1 .or. p%NumBl<2 )
   InvalidOutput(BStC1_B2_Mzi) = ( p%CompBStC<1 .or. p%NumBl<2 )
   InvalidOutput(BStC1_B2_Fxn) = ( p%CompBStC<1 .or. p%NumBl<2 )
   InvalidOutput(BStC1_B2_Fyn) = ( p%CompBStC<1 .or. p%NumBl<2 )
   InvalidOutput(BStC1_B2_Fzn) = ( p%CompBStC<1 .or. p%NumBl<2 )
   InvalidOutput(BStC1_B2_Mxn) = ( p%CompBStC<1 .or. p%NumBl<2 )
   InvalidOutput(BStC1_B2_Myn) = ( p%CompBStC<1 .or. p%NumBl<2 )
   InvalidOutput(BStC1_B2_Mzn) = ( p%CompBStC<1 .or. p%NumBl<2 )
   InvalidOutput( BStC2_B2_XQ) = ( p%CompBStC<2 .or. p%NumBl<2 )
   InvalidOutput(BStC2_B2_XQD) = ( p%CompBStC<2 .or. p%NumBl<2 )
   InvalidOutput( BStC2_B2_YQ) = ( p%CompBStC<2 .or. p%NumBl<2 )
   InvalidOutput(BStC2_B2_YQD) = ( p%CompBStC<2 .or. p%NumBl<2 )
   InvalidOutput( BStC2_B2_ZQ) = ( p%CompBStC<2 .or. p%NumBl<2 )
   InvalidOutput(BStC2_B2_ZQD) = ( p%CompBStC<2 .or. p%NumBl<2 )
   InvalidOutput(BStC2_B2_Fxi) = ( p%CompBStC<2 .or. p%NumBl<2 )
   InvalidOutput(BStC2_B2_Fyi) = ( p%CompBStC<2 .or. p%NumBl<2 )
   InvalidOutput(BStC2_B2_Fzi) = ( p%CompBStC<2 .or. p%NumBl<2 )
   InvalidOutput(BStC2_B2_Mxi) = ( p%CompBStC<2 .or. p%NumBl<2 )
   InvalidOutput(BStC2_B2_Myi) = ( p%CompBStC<2 .or. p%NumBl<2 )
   InvalidOutput(BStC2_B2_Mzi) = ( p%CompBStC<2 .or. p%NumBl<2 )
   InvalidOutput(BStC2_B2_Fxn) = ( p%CompBStC<2 .or. p%NumBl<2 )
   InvalidOutput(BStC2_B2_Fyn) = ( p%CompBStC<2 .or. p%NumBl<2 )
   InvalidOutput(BStC2_B2_Fzn) = ( p%CompBStC<2 .or. p%NumBl<2 )
   InvalidOutput(BStC2_B2_Mxn) = ( p%CompBStC<2 .or. p%NumBl<2 )
   InvalidOutput(BStC2_B2_Myn) = ( p%CompBStC<2 .or. p%NumBl<2 )
   InvalidOutput(BStC2_B2_Mzn) = ( p%CompBStC<2 .or. p%NumBl<2 )
   InvalidOutput( BStC3_B2_XQ) = ( p%CompBStC<3 .or. p%NumBl<2 )
   InvalidOutput(BStC3_B2_XQD) = ( p%CompBStC<3 .or. p%NumBl<2 )
   InvalidOutput( BStC3_B2_YQ) = ( p%CompBStC<3 .or. p%NumBl<2 )
   InvalidOutput(BStC3_B2_YQD) = ( p%CompBStC<3 .or. p%NumBl<2 )
   InvalidOutput( BStC3_B2_ZQ) = ( p%CompBStC<3 .or. p%NumBl<2 )
   InvalidOutput(BStC3_B2_ZQD) = ( p%CompBStC<3 .or. p%NumBl<2 )
   InvalidOutput(BStC3_B2_Fxi) = ( p%CompBStC<3 .or. p%NumBl<2 )
   InvalidOutput(BStC3_B2_Fyi) = ( p%CompBStC<3 .or. p%NumBl<2 )
   InvalidOutput(BStC3_B2_Fzi) = ( p%CompBStC<3 .or. p%NumBl<2 )
   InvalidOutput(BStC3_B2_Mxi) = ( p%CompBStC<3 .or. p%NumBl<2 )
   InvalidOutput(BStC3_B2_Myi) = ( p%CompBStC<3 .or. p%NumBl<2 )
   InvalidOutput(BStC3_B2_Mzi) = ( p%CompBStC<3 .or. p%NumBl<2 )
   InvalidOutput(BStC3_B2_Fxn) = ( p%CompBStC<3 .or. p%NumBl<2 )
   InvalidOutput(BStC3_B2_Fyn) = ( p%CompBStC<3 .or. p%NumBl<2 )
   InvalidOutput(BStC3_B2_Fzn) = ( p%CompBStC<3 .or. p%NumBl<2 )
   InvalidOutput(BStC3_B2_Mxn) = ( p%CompBStC<3 .or. p%NumBl<2 )
   InvalidOutput(BStC3_B2_Myn) = ( p%CompBStC<3 .or. p%NumBl<2 )
   InvalidOutput(BStC3_B2_Mzn) = ( p%CompBStC<3 .or. p%NumBl<2 )
   InvalidOutput( BStC4_B2_XQ) = ( p%CompBStC<4 .or. p%NumBl<2 )
   InvalidOutput(BStC4_B2_XQD) = ( p%CompBStC<4 .or. p%NumBl<2 )
   InvalidOutput( BStC4_B2_YQ) = ( p%CompBStC<4 .or. p%NumBl<2 )
   InvalidOutput(BStC4_B2_YQD) = ( p%CompBStC<4 .or. p%NumBl<2 )
   InvalidOutput( BStC4_B2_ZQ) = ( p%CompBStC<4 .or. p%NumBl<2 )
   InvalidOutput(BStC4_B2_ZQD) = ( p%CompBStC<4 .or. p%NumBl<2 )
   InvalidOutput(BStC4_B2_Fxi) = ( p%CompBStC<4 .or. p%NumBl<2 )
   InvalidOutput(BStC4_B2_Fyi) = ( p%CompBStC<4 .or. p%NumBl<2 )
   InvalidOutput(BStC4_B2_Fzi) = ( p%CompBStC<4 .or. p%NumBl<2 )
   InvalidOutput(BStC4_B2_Mxi) = ( p%CompBStC<4 .or. p%NumBl<2 )
   InvalidOutput(BStC4_B2_Myi) = ( p%CompBStC<4 .or. p%NumBl<2 )
   InvalidOutput(BStC4_B2_Mzi) = ( p%CompBStC<4 .or. p%NumBl<2 )
   InvalidOutput(BStC4_B2_Fxn) = ( p%CompBStC<4 .or. p%NumBl<2 )
   InvalidOutput(BStC4_B2_Fyn) = ( p%CompBStC<4 .or. p%NumBl<2 )
   InvalidOutput(BStC4_B2_Fzn) = ( p%CompBStC<4 .or. p%NumBl<2 )
   InvalidOutput(BStC4_B2_Mxn) = ( p%CompBStC<4 .or. p%NumBl<2 )
   InvalidOutput(BStC4_B2_Myn) = ( p%CompBStC<4 .or. p%NumBl<2 )
   InvalidOutput(BStC4_B2_Mzn) = ( p%CompBStC<4 .or. p%NumBl<2 )
   InvalidOutput( BStC1_B3_XQ) = ( p%CompBStC<1 .or. p%NumBl<3 )
   InvalidOutput(BStC1_B3_XQD) = ( p%CompBStC<1 .or. p%NumBl<3 )
   InvalidOutput( BStC1_B3_YQ) = ( p%CompBStC<1 .or. p%NumBl<3 )
   InvalidOutput(BStC1_B3_YQD) = ( p%CompBStC<1 .or. p%NumBl<3 )
   InvalidOutput( BStC1_B3_ZQ) = ( p%CompBStC<1 .or. p%NumBl<3 )
   InvalidOutput(BStC1_B3_ZQD) = ( p%CompBStC<1 .or. p%NumBl<3 )
   InvalidOutput(BStC1_B3_Fxi) = ( p%CompBStC<1 .or. p%NumBl<3 )
   InvalidOutput(BStC1_B3_Fyi) = ( p%CompBStC<1 .or. p%NumBl<3 )
   InvalidOutput(BStC1_B3_Fzi) = ( p%CompBStC<1 .or. p%NumBl<3 )
   InvalidOutput(BStC1_B3_Mxi) = ( p%CompBStC<1 .or. p%NumBl<3 )
   InvalidOutput(BStC1_B3_Myi) = ( p%CompBStC<1 .or. p%NumBl<3 )
   InvalidOutput(BStC1_B3_Mzi) = ( p%CompBStC<1 .or. p%NumBl<3 )
   InvalidOutput(BStC1_B3_Fxn) = ( p%CompBStC<1 .or. p%NumBl<3 )
   InvalidOutput(BStC1_B3_Fyn) = ( p%CompBStC<1 .or. p%NumBl<3 )
   InvalidOutput(BStC1_B3_Fzn) = ( p%CompBStC<1 .or. p%NumBl<3 )
   InvalidOutput(BStC1_B3_Mxn) = ( p%CompBStC<1 .or. p%NumBl<3 )
   InvalidOutput(BStC1_B3_Myn) = ( p%CompBStC<1 .or. p%NumBl<3 )
   InvalidOutput(BStC1_B3_Mzn) = ( p%CompBStC<1 .or. p%NumBl<3 )
   InvalidOutput( BStC2_B3_XQ) = ( p%CompBStC<2 .or. p%NumBl<3 )
   InvalidOutput(BStC2_B3_XQD) = ( p%CompBStC<2 .or. p%NumBl<3 )
   InvalidOutput( BStC2_B3_YQ) = ( p%CompBStC<2 .or. p%NumBl<3 )
   InvalidOutput(BStC2_B3_YQD) = ( p%CompBStC<2 .or. p%NumBl<3 )
   InvalidOutput( BStC2_B3_ZQ) = ( p%CompBStC<2 .or. p%NumBl<3 )
   InvalidOutput(BStC2_B3_ZQD) = ( p%CompBStC<2 .or. p%NumBl<3 )
   InvalidOutput(BStC2_B3_Fxi) = ( p%CompBStC<2 .or. p%NumBl<3 )
   InvalidOutput(BStC2_B3_Fyi) = ( p%CompBStC<2 .or. p%NumBl<3 )
   InvalidOutput(BStC2_B3_Fzi) = ( p%CompBStC<2 .or. p%NumBl<3 )
   InvalidOutput(BStC2_B3_Mxi) = ( p%CompBStC<2 .or. p%NumBl<3 )
   InvalidOutput(BStC2_B3_Myi) = ( p%CompBStC<2 .or. p%NumBl<3 )
   InvalidOutput(BStC2_B3_Mzi) = ( p%CompBStC<2 .or. p%NumBl<3 )
   InvalidOutput(BStC2_B3_Fxn) = ( p%CompBStC<2 .or. p%NumBl<3 )
   InvalidOutput(BStC2_B3_Fyn) = ( p%CompBStC<2 .or. p%NumBl<3 )
   InvalidOutput(BStC2_B3_Fzn) = ( p%CompBStC<2 .or. p%NumBl<3 )
   InvalidOutput(BStC2_B3_Mxn) = ( p%CompBStC<2 .or. p%NumBl<3 )
   InvalidOutput(BStC2_B3_Myn) = ( p%CompBStC<2 .or. p%NumBl<3 )
   InvalidOutput(BStC2_B3_Mzn) = ( p%CompBStC<2 .or. p%NumBl<3 )
   InvalidOutput( BStC3_B3_XQ) = ( p%CompBStC<3 .or. p%NumBl<3 )
   InvalidOutput(BStC3_B3_XQD) = ( p%CompBStC<3 .or. p%NumBl<3 )
   InvalidOutput( BStC3_B3_YQ) = ( p%CompBStC<3 .or. p%NumBl<3 )
   InvalidOutput(BStC3_B3_YQD) = ( p%CompBStC<3 .or. p%NumBl<3 )
   InvalidOutput( BStC3_B3_ZQ) = ( p%CompBStC<3 .or. p%NumBl<3 )
   InvalidOutput(BStC3_B3_ZQD) = ( p%CompBStC<3 .or. p%NumBl<3 )
   InvalidOutput(BStC3_B3_Fxi) = ( p%CompBStC<3 .or. p%NumBl<3 )
   InvalidOutput(BStC3_B3_Fyi) = ( p%CompBStC<3 .or. p%NumBl<3 )
   InvalidOutput(BStC3_B3_Fzi) = ( p%CompBStC<3 .or. p%NumBl<3 )
   InvalidOutput(BStC3_B3_Mxi) = ( p%CompBStC<3 .or. p%NumBl<3 )
   InvalidOutput(BStC3_B3_Myi) = ( p%CompBStC<3 .or. p%NumBl<3 )
   InvalidOutput(BStC3_B3_Mzi) = ( p%CompBStC<3 .or. p%NumBl<3 )
   InvalidOutput(BStC3_B3_Fxn) = ( p%CompBStC<3 .or. p%NumBl<3 )
   InvalidOutput(BStC3_B3_Fyn) = ( p%CompBStC<3 .or. p%NumBl<3 )
   InvalidOutput(BStC3_B3_Fzn) = ( p%CompBStC<3 .or. p%NumBl<3 )
   InvalidOutput(BStC3_B3_Mxn) = ( p%CompBStC<3 .or. p%NumBl<3 )
   InvalidOutput(BStC3_B3_Myn) = ( p%CompBStC<3 .or. p%NumBl<3 )
   InvalidOutput(BStC3_B3_Mzn) = ( p%CompBStC<3 .or. p%NumBl<3 )
   InvalidOutput( BStC4_B3_XQ) = ( p%CompBStC<4 .or. p%NumBl<3 )
   InvalidOutput(BStC4_B3_XQD) = ( p%CompBStC<4 .or. p%NumBl<3 )
   InvalidOutput( BStC4_B3_YQ) = ( p%CompBStC<4 .or. p%NumBl<3 )
   InvalidOutput(BStC4_B3_YQD) = ( p%CompBStC<4 .or. p%NumBl<3 )
   InvalidOutput( BStC4_B3_ZQ) = ( p%CompBStC<4 .or. p%NumBl<3 )
   InvalidOutput(BStC4_B3_ZQD) = ( p%CompBStC<4 .or. p%NumBl<3 )
   InvalidOutput(BStC4_B3_Fxi) = ( p%CompBStC<4 .or. p%NumBl<3 )
   InvalidOutput(BStC4_B3_Fyi) = ( p%CompBStC<4 .or. p%NumBl<3 )
   InvalidOutput(BStC4_B3_Fzi) = ( p%CompBStC<4 .or. p%NumBl<3 )
   InvalidOutput(BStC4_B3_Mxi) = ( p%CompBStC<4 .or. p%NumBl<3 )
   InvalidOutput(BStC4_B3_Myi) = ( p%CompBStC<4 .or. p%NumBl<3 )
   InvalidOutput(BStC4_B3_Mzi) = ( p%CompBStC<4 .or. p%NumBl<3 )
   InvalidOutput(BStC4_B3_Fxn) = ( p%CompBStC<4 .or. p%NumBl<3 )
   InvalidOutput(BStC4_B3_Fyn) = ( p%CompBStC<4 .or. p%NumBl<3 )
   InvalidOutput(BStC4_B3_Fzn) = ( p%CompBStC<4 .or. p%NumBl<3 )
   InvalidOutput(BStC4_B3_Mxn) = ( p%CompBStC<4 .or. p%NumBl<3 )
   InvalidOutput(BStC4_B3_Myn) = ( p%CompBStC<4 .or. p%NumBl<3 )
   InvalidOutput(BStC4_B3_Mzn) = ( p%CompBStC<4 .or. p%NumBl<3 )
   InvalidOutput( BStC1_B4_XQ) = ( p%CompBStC<1 .or. p%NumBl<4 )
   InvalidOutput(BStC1_B4_XQD) = ( p%CompBStC<1 .or. p%NumBl<4 )
   InvalidOutput( BStC1_B4_YQ) = ( p%CompBStC<1 .or. p%NumBl<4 )
   InvalidOutput(BStC1_B4_YQD) = ( p%CompBStC<1 .or. p%NumBl<4 )
   InvalidOutput( BStC1_B4_ZQ) = ( p%CompBStC<1 .or. p%NumBl<4 )
   InvalidOutput(BStC1_B4_ZQD) = ( p%CompBStC<1 .or. p%NumBl<4 )
   InvalidOutput(BStC1_B4_Fxi) = ( p%CompBStC<1 .or. p%NumBl<4 )
   InvalidOutput(BStC1_B4_Fyi) = ( p%CompBStC<1 .or. p%NumBl<4 )
   InvalidOutput(BStC1_B4_Fzi) = ( p%CompBStC<1 .or. p%NumBl<4 )
   InvalidOutput(BStC1_B4_Mxi) = ( p%CompBStC<1 .or. p%NumBl<4 )
   InvalidOutput(BStC1_B4_Myi) = ( p%CompBStC<1 .or. p%NumBl<4 )
   InvalidOutput(BStC1_B4_Mzi) = ( p%CompBStC<1 .or. p%NumBl<4 )
   InvalidOutput(BStC1_B4_Fxn) = ( p%CompBStC<1 .or. p%NumBl<4 )
   InvalidOutput(BStC1_B4_Fyn) = ( p%CompBStC<1 .or. p%NumBl<4 )
   InvalidOutput(BStC1_B4_Fzn) = ( p%CompBStC<1 .or. p%NumBl<4 )
   InvalidOutput(BStC1_B4_Mxn) = ( p%CompBStC<1 .or. p%NumBl<4 )
   InvalidOutput(BStC1_B4_Myn) = ( p%CompBStC<1 .or. p%NumBl<4 )
   InvalidOutput(BStC1_B4_Mzn) = ( p%CompBStC<1 .or. p%NumBl<4 )
   InvalidOutput( BStC2_B4_XQ) = ( p%CompBStC<2 .or. p%NumBl<4 )
   InvalidOutput(BStC2_B4_XQD) = ( p%CompBStC<2 .or. p%NumBl<4 )
   InvalidOutput( BStC2_B4_YQ) = ( p%CompBStC<2 .or. p%NumBl<4 )
   InvalidOutput(BStC2_B4_YQD) = ( p%CompBStC<2 .or. p%NumBl<4 )
   InvalidOutput( BStC2_B4_ZQ) = ( p%CompBStC<2 .or. p%NumBl<4 )
   InvalidOutput(BStC2_B4_ZQD) = ( p%CompBStC<2 .or. p%NumBl<4 )
   InvalidOutput(BStC2_B4_Fxi) = ( p%CompBStC<2 .or. p%NumBl<4 )
   InvalidOutput(BStC2_B4_Fyi) = ( p%CompBStC<2 .or. p%NumBl<4 )
   InvalidOutput(BStC2_B4_Fzi) = ( p%CompBStC<2 .or. p%NumBl<4 )
   InvalidOutput(BStC2_B4_Mxi) = ( p%CompBStC<2 .or. p%NumBl<4 )
   InvalidOutput(BStC2_B4_Myi) = ( p%CompBStC<2 .or. p%NumBl<4 )
   InvalidOutput(BStC2_B4_Mzi) = ( p%CompBStC<2 .or. p%NumBl<4 )
   InvalidOutput(BStC2_B4_Fxn) = ( p%CompBStC<2 .or. p%NumBl<4 )
   InvalidOutput(BStC2_B4_Fyn) = ( p%CompBStC<2 .or. p%NumBl<4 )
   InvalidOutput(BStC2_B4_Fzn) = ( p%CompBStC<2 .or. p%NumBl<4 )
   InvalidOutput(BStC2_B4_Mxn) = ( p%CompBStC<2 .or. p%NumBl<4 )
   InvalidOutput(BStC2_B4_Myn) = ( p%CompBStC<2 .or. p%NumBl<4 )
   InvalidOutput(BStC2_B4_Mzn) = ( p%CompBStC<2 .or. p%NumBl<4 )
   InvalidOutput( BStC3_B4_XQ) = ( p%CompBStC<3 .or. p%NumBl<4 )
   InvalidOutput(BStC3_B4_XQD) = ( p%CompBStC<3 .or. p%NumBl<4 )
   InvalidOutput( BStC3_B4_YQ) = ( p%CompBStC<3 .or. p%NumBl<4 )
   InvalidOutput(BStC3_B4_YQD) = ( p%CompBStC<3 .or. p%NumBl<4 )
   InvalidOutput( BStC3_B4_ZQ) = ( p%CompBStC<3 .or. p%NumBl<4 )
   InvalidOutput(BStC3_B4_ZQD) = ( p%CompBStC<3 .or. p%NumBl<4 )
   InvalidOutput(BStC3_B4_Fxi) = ( p%CompBStC<3 .or. p%NumBl<4 )
   InvalidOutput(BStC3_B4_Fyi) = ( p%CompBStC<3 .or. p%NumBl<4 )
   InvalidOutput(BStC3_B4_Fzi) = ( p%CompBStC<3 .or. p%NumBl<4 )
   InvalidOutput(BStC3_B4_Mxi) = ( p%CompBStC<3 .or. p%NumBl<4 )
   InvalidOutput(BStC3_B4_Myi) = ( p%CompBStC<3 .or. p%NumBl<4 )
   InvalidOutput(BStC3_B4_Mzi) = ( p%CompBStC<3 .or. p%NumBl<4 )
   InvalidOutput(BStC3_B4_Fxn) = ( p%CompBStC<3 .or. p%NumBl<4 )
   InvalidOutput(BStC3_B4_Fyn) = ( p%CompBStC<3 .or. p%NumBl<4 )
   InvalidOutput(BStC3_B4_Fzn) = ( p%CompBStC<3 .or. p%NumBl<4 )
   InvalidOutput(BStC3_B4_Mxn) = ( p%CompBStC<3 .or. p%NumBl<4 )
   InvalidOutput(BStC3_B4_Myn) = ( p%CompBStC<3 .or. p%NumBl<4 )
   InvalidOutput(BStC3_B4_Mzn) = ( p%CompBStC<3 .or. p%NumBl<4 )
   InvalidOutput( BStC4_B4_XQ) = ( p%CompBStC<4 .or. p%NumBl<4 )
   InvalidOutput(BStC4_B4_XQD) = ( p%CompBStC<4 .or. p%NumBl<4 )
   InvalidOutput( BStC4_B4_YQ) = ( p%CompBStC<4 .or. p%NumBl<4 )
   InvalidOutput(BStC4_B4_YQD) = ( p%CompBStC<4 .or. p%NumBl<4 )
   InvalidOutput( BStC4_B4_ZQ) = ( p%CompBStC<4 .or. p%NumBl<4 )
   InvalidOutput(BStC4_B4_ZQD) = ( p%CompBStC<4 .or. p%NumBl<4 )
   InvalidOutput(BStC4_B4_Fxi) = ( p%CompBStC<4 .or. p%NumBl<4 )
   InvalidOutput(BStC4_B4_Fyi) = ( p%CompBStC<4 .or. p%NumBl<4 )
   InvalidOutput(BStC4_B4_Fzi) = ( p%CompBStC<4 .or. p%NumBl<4 )
   InvalidOutput(BStC4_B4_Mxi) = ( p%CompBStC<4 .or. p%NumBl<4 )
   InvalidOutput(BStC4_B4_Myi) = ( p%CompBStC<4 .or. p%NumBl<4 )
   InvalidOutput(BStC4_B4_Mzi) = ( p%CompBStC<4 .or. p%NumBl<4 )
   InvalidOutput(BStC4_B4_Fxn) = ( p%CompBStC<4 .or. p%NumBl<4 )
   InvalidOutput(BStC4_B4_Fyn) = ( p%CompBStC<4 .or. p%NumBl<4 )
   InvalidOutput(BStC4_B4_Fzn) = ( p%CompBStC<4 .or. p%NumBl<4 )
   InvalidOutput(BStC4_B4_Mxn) = ( p%CompBStC<4 .or. p%NumBl<4 )
   InvalidOutput(BStC4_B4_Myn) = ( p%CompBStC<4 .or. p%NumBl<4 )
   InvalidOutput(BStC4_B4_Mzn) = ( p%CompBStC<4 .or. p%NumBl<4 )
   InvalidOutput( PtfmStC1_XQ) = ( p%CompPtfmStC<1 )
   InvalidOutput(PtfmStC1_XQD) = ( p%CompPtfmStC<1 )
   InvalidOutput( PtfmStC1_YQ) = ( p%CompPtfmStC<1 )
   InvalidOutput(PtfmStC1_YQD) = ( p%CompPtfmStC<1 )
   InvalidOutput( PtfmStC1_ZQ) = ( p%CompPtfmStC<1 )
   InvalidOutput(PtfmStC1_ZQD) = ( p%CompPtfmStC<1 )
   InvalidOutput(PtfmStC1_Fxi) = ( p%CompPtfmStC<1 )
   InvalidOutput(PtfmStC1_Fyi) = ( p%CompPtfmStC<1 )
   InvalidOutput(PtfmStC1_Fzi) = ( p%CompPtfmStC<1 )
   InvalidOutput(PtfmStC1_Mxi) = ( p%CompPtfmStC<1 )
   InvalidOutput(PtfmStC1_Myi) = ( p%CompPtfmStC<1 )
   InvalidOutput(PtfmStC1_Mzi) = ( p%CompPtfmStC<1 )
   InvalidOutput(PtfmStC1_Fxn) = ( p%CompPtfmStC<1 )
   InvalidOutput(PtfmStC1_Fyn) = ( p%CompPtfmStC<1 )
   InvalidOutput(PtfmStC1_Fzn) = ( p%CompPtfmStC<1 )
   InvalidOutput(PtfmStC1_Mxn) = ( p%CompPtfmStC<1 )
   InvalidOutput(PtfmStC1_Myn) = ( p%CompPtfmStC<1 )
   InvalidOutput(PtfmStC1_Mzn) = ( p%CompPtfmStC<1 )
   InvalidOutput( PtfmStC2_XQ) = ( p%CompPtfmStC<2 )
   InvalidOutput(PtfmStC2_XQD) = ( p%CompPtfmStC<2 )
   InvalidOutput( PtfmStC2_YQ) = ( p%CompPtfmStC<2 )
   InvalidOutput(PtfmStC2_YQD) = ( p%CompPtfmStC<2 )
   InvalidOutput( PtfmStC2_ZQ) = ( p%CompPtfmStC<2 )
   InvalidOutput(PtfmStC2_ZQD) = ( p%CompPtfmStC<2 )
   InvalidOutput(PtfmStC2_Fxi) = ( p%CompPtfmStC<2 )
   InvalidOutput(PtfmStC2_Fyi) = ( p%CompPtfmStC<2 )
   InvalidOutput(PtfmStC2_Fzi) = ( p%CompPtfmStC<2 )
   InvalidOutput(PtfmStC2_Mxi) = ( p%CompPtfmStC<2 )
   InvalidOutput(PtfmStC2_Myi) = ( p%CompPtfmStC<2 )
   InvalidOutput(PtfmStC2_Mzi) = ( p%CompPtfmStC<2 )
   InvalidOutput(PtfmStC2_Fxn) = ( p%CompPtfmStC<2 )
   InvalidOutput(PtfmStC2_Fyn) = ( p%CompPtfmStC<2 )
   InvalidOutput(PtfmStC2_Fzn) = ( p%CompPtfmStC<2 )
   InvalidOutput(PtfmStC2_Mxn) = ( p%CompPtfmStC<2 )
   InvalidOutput(PtfmStC2_Myn) = ( p%CompPtfmStC<2 )
   InvalidOutput(PtfmStC2_Mzn) = ( p%CompPtfmStC<2 )
   InvalidOutput( PtfmStC3_XQ) = ( p%CompPtfmStC<3 )
   InvalidOutput(PtfmStC3_XQD) = ( p%CompPtfmStC<3 )
   InvalidOutput( PtfmStC3_YQ) = ( p%CompPtfmStC<3 )
   InvalidOutput(PtfmStC3_YQD) = ( p%CompPtfmStC<3 )
   InvalidOutput( PtfmStC3_ZQ) = ( p%CompPtfmStC<3 )
   InvalidOutput(PtfmStC3_ZQD) = ( p%CompPtfmStC<3 )
   InvalidOutput(PtfmStC3_Fxi) = ( p%CompPtfmStC<3 )
   InvalidOutput(PtfmStC3_Fyi) = ( p%CompPtfmStC<3 )
   InvalidOutput(PtfmStC3_Fzi) = ( p%CompPtfmStC<3 )
   InvalidOutput(PtfmStC3_Mxi) = ( p%CompPtfmStC<3 )
   InvalidOutput(PtfmStC3_Myi) = ( p%CompPtfmStC<3 )
   InvalidOutput(PtfmStC3_Mzi) = ( p%CompPtfmStC<3 )
   InvalidOutput(PtfmStC3_Fxn) = ( p%CompPtfmStC<3 )
   InvalidOutput(PtfmStC3_Fyn) = ( p%CompPtfmStC<3 )
   InvalidOutput(PtfmStC3_Fzn) = ( p%CompPtfmStC<3 )
   InvalidOutput(PtfmStC3_Mxn) = ( p%CompPtfmStC<3 )
   InvalidOutput(PtfmStC3_Myn) = ( p%CompPtfmStC<3 )
   InvalidOutput(PtfmStC3_Mzn) = ( p%CompPtfmStC<3 )
   InvalidOutput( PtfmStC4_XQ) = ( p%CompPtfmStC<4 )
   InvalidOutput(PtfmStC4_XQD) = ( p%CompPtfmStC<4 )
   InvalidOutput( PtfmStC4_YQ) = ( p%CompPtfmStC<4 )
   InvalidOutput(PtfmStC4_YQD) = ( p%CompPtfmStC<4 )
   InvalidOutput( PtfmStC4_ZQ) = ( p%CompPtfmStC<4 )
   InvalidOutput(PtfmStC4_ZQD) = ( p%CompPtfmStC<4 )
   InvalidOutput(PtfmStC4_Fxi) = ( p%CompPtfmStC<4 )
   InvalidOutput(PtfmStC4_Fyi) = ( p%CompPtfmStC<4 )
   InvalidOutput(PtfmStC4_Fzi) = ( p%CompPtfmStC<4 )
   InvalidOutput(PtfmStC4_Mxi) = ( p%CompPtfmStC<4 )
   InvalidOutput(PtfmStC4_Myi) = ( p%CompPtfmStC<4 )
   InvalidOutput(PtfmStC4_Mzi) = ( p%CompPtfmStC<4 )
   InvalidOutput(PtfmStC4_Fxn) = ( p%CompPtfmStC<4 )
   InvalidOutput(PtfmStC4_Fyn) = ( p%CompPtfmStC<4 )
   InvalidOutput(PtfmStC4_Fzn) = ( p%CompPtfmStC<4 )
   InvalidOutput(PtfmStC4_Mxn) = ( p%CompPtfmStC<4 )
   InvalidOutput(PtfmStC4_Myn) = ( p%CompPtfmStC<4 )
   InvalidOutput(PtfmStC4_Mzn) = ( p%CompPtfmStC<4 )


   !-------------------------------------------------------------------------------------------------
   ! Allocate and set index, name, and units for the output channels
   ! If a selected output channel is not available in this module, set error flag.
   !-------------------------------------------------------------------------------------------------

   ALLOCATE ( p%OutParam(0:p%NumOuts) , STAT=ErrStat2 )
   IF ( ErrStat2 /= 0_IntKi )  THEN
      CALL SetErrStat( ErrID_Fatal,"Error allocating memory for the ServoDyn OutParam array.", ErrStat, ErrMsg, RoutineName )
      RETURN
   ENDIF

      ! Set index, name, and units for the time output channel:

   p%OutParam(0)%Indx  = Time
   p%OutParam(0)%Name  = "Time"    ! OutParam(0) is the time channel by default.
   p%OutParam(0)%Units = "(s)"
   p%OutParam(0)%SignM = 1


      ! Set index, name, and units for all of the output channels.
      ! If a selected output channel is not available by this module set ErrStat = ErrID_Warn.

   DO I = 1,p%NumOuts

      p%OutParam(I)%Name  = OutList(I)
      OutListTmp          = OutList(I)

      ! Reverse the sign (+/-) of the output channel if the user prefixed the
      !   channel name with a "-", "_", "m", or "M" character indicating "minus".


      CheckOutListAgain = .FALSE.

      IF      ( INDEX( "-_", OutListTmp(1:1) ) > 0 ) THEN
         p%OutParam(I)%SignM = -1                         ! ex, "-TipDxc1" causes the sign of TipDxc1 to be switched.
         OutListTmp          = OutListTmp(2:)
      ELSE IF ( INDEX( "mM", OutListTmp(1:1) ) > 0 ) THEN ! We'll assume this is a variable name for now, (if not, we will check later if OutListTmp(2:) is also a variable name)
         CheckOutListAgain   = .TRUE.
         p%OutParam(I)%SignM = 1
      ELSE
         p%OutParam(I)%SignM = 1
      END IF

      CALL Conv2UC( OutListTmp )    ! Convert OutListTmp to upper case


      Indx = IndexCharAry( OutListTmp(1:OutStrLenM1), ValidParamAry )


         ! If it started with an "M" (CheckOutListAgain) we didn't find the value in our list (Indx < 1)

      IF ( CheckOutListAgain .AND. Indx < 1 ) THEN    ! Let's assume that "M" really meant "minus" and then test again
         p%OutParam(I)%SignM = -1                     ! ex, "MTipDxc1" causes the sign of TipDxc1 to be switched.
         OutListTmp          = OutListTmp(2:)

         Indx = IndexCharAry( OutListTmp(1:OutStrLenM1), ValidParamAry )
      END IF


      IF ( Indx > 0 ) THEN ! we found the channel name
         IF ( InvalidOutput( ParamIndxAry(Indx) ) ) THEN  ! but, it isn't valid for these settings
            p%OutParam(I)%Indx  = 0                 ! pick any valid channel (I just picked "Time=0" here because it's universal)
            p%OutParam(I)%Units = "INVALID"
            p%OutParam(I)%SignM = 0
         ELSE
            p%OutParam(I)%Indx  = ParamIndxAry(Indx)
            p%OutParam(I)%Units = ParamUnitsAry(Indx) ! it's a valid output
         END IF
      ELSE ! this channel isn't valid
         p%OutParam(I)%Indx  = 0                    ! pick any valid channel (I just picked "Time=0" here because it's universal)
         p%OutParam(I)%Units = "INVALID"
         p%OutParam(I)%SignM = 0                    ! multiply all results by zero

         CALL SetErrStat(ErrID_Fatal, TRIM(p%OutParam(I)%Name)//" is not an available output channel.",ErrStat,ErrMsg,RoutineName)
      END IF

   END DO

   RETURN
END SUBROUTINE SetOutParam
!----------------------------------------------------------------------------------------------------------------------------------
!End of code generated by Matlab script
!**********************************************************************************************************************************
END MODULE ServoDyn_IO
!**********************************************************************************************************************************
